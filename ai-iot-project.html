<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<header class="fixed top-0 left-0 w-full bg-black/20 backdrop-blur-sm
               border-b border-white/10 z-50">
    <div class="container mx-auto px-6 py-4">
        <div class="flex items-center justify-between">
            <a href="index.html" class="flex items-center space-x-4 hover:opacity-80 transition">
                <div class="w-10 h-10 bg-gradient-to-r from-blue-400 to-purple-400 rounded-full flex items-center justify-center">
                    <span class="text-lg font-bold">E</span>
                </div>
                <div>
                    <h1 class="text-lg font-bold text-white">ECAM Engineering</h1>
                    <p class="text-blue-200 text-xs">KTP Demo</p>
                </div>
            </a>
            <nav class="hidden md:flex space-x-6">
                <a href="index.html"                class="nav-link">Home</a>
                <a href="ai-iot-project.html"       class="nav-link">AI Project</a>
                <a href="marketing-project.html"    class="nav-link">Marketing Project</a>
            </nav>
        </div>
    </div>
</header>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECAM Engineering: AI-Driven MES-IoT Platform - Further KTP Project Proposal</title>
    <!-- Fix Tailwind CDN Warning -->
    <script>
      if (typeof window !== 'undefined') {
        window.process = { env: { NODE_ENV: 'development' } };
      }
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script>
      gsap.registerPlugin(ScrollTrigger);
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <!-- Print-specific meta tags -->
    <meta name="print-title" content="ECAM Engineering - AI-Driven MES-IoT Platform Proposal">
    <meta name="print-author" content="ECAM Engineering Limited">
    <meta name="print-description" content="36-Month Knowledge Transfer Partnership Proposal">

    <!-- Print optimization -->
    <style id="print-optimization">
    /* Ensure charts render properly in PDF */
    .chart-container canvas {
        max-width: 100% !important;
        height: auto !important;
    }

    /* Professional table styling for PDF */
    @media print {
        .table-responsive {
            overflow: visible !important;
        }
        
        .gantt-chart-container {
            page-break-inside: avoid;
            background: white !important;
            padding: 20px !important;
            border: 2px solid #1e40af !important;
        }
        
        /* Ensure text is readable */
        .text-blue-200, .text-blue-300 {
            color: #1e40af !important;
        }
        
        .bg-blue-50, .bg-green-50, .bg-purple-50, .bg-orange-50 {
            background: #f8f9fa !important;
            border: 1px solid #dee2e6 !important;
        }
    }
    </style>
    
    <style>
        body { font-family: 'Inter', sans-serif; overflow-x: hidden; }
        .hero-gradient { background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 25%, #1e40af 50%, #1d4ed8 75%, #2563eb 100%); }
        .professional-gradient { background: linear-gradient(135deg, #1e40af 0%, #3730a3 100%); }
        .success-gradient { background: linear-gradient(135deg, #059669 0%, #10b981 100%); }
        .innovation-gradient { background: linear-gradient(135deg, #7c3aed 0%, #8b5cf6 100%); }
        .chart-container { position: relative; width: 100%; height: 400px; }
        .floating-card { animation: float 6s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
        .professional-glow { box-shadow: 0 4px 20px rgba(30, 64, 175, 0.15); }
        .typewriter { overflow: hidden; border-right: .15em solid #3730a3; white-space: nowrap; animation: typing 3.5s steps(40, end), blink-caret .75s step-end infinite; }
        @keyframes typing { from { width: 0 } to { width: 100% } }
        @keyframes blink-caret { from, to { border-color: transparent } 50% { border-color: #3730a3; } }
        .glass-effect { backdrop-filter: blur(20px); background: rgba(255, 255, 255, 0.95); border: 1px solid rgba(30, 64, 175, 0.1); }
        .professional-text { color: #1e40af; }
        .ai-particle { position: absolute; width: 4px; height: 4px; background: #3730a3; border-radius: 50%; animation: particle-float 3s infinite ease-in-out; }
        @keyframes particle-float { 0%, 100% { transform: translateY(0) rotate(0deg); opacity: 1; } 50% { transform: translateY(-30px) rotate(180deg); opacity: 0.5; } }
        .metric-counter { font-size: 3rem; font-weight: 900; background: linear-gradient(45deg, #1e40af, #3730a3, #7c3aed); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; }
        .interactive-demo { transition: all 0.3s ease; cursor: pointer; }
        .interactive-demo:hover { transform: scale(1.02) rotateY(2deg); }
        .status-indicator { display: inline-block; width: 12px; height: 12px; border-radius: 50%; margin-right: 8px; animation: status-blink 2s infinite; }
        .status-completed { background-color: #10b981; }
        .status-inprogress { background-color: #f59e0b; }
        .status-pending { background-color: #6b7280; }
        @keyframes status-blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        .professional-card { background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .professional-button { background: linear-gradient(135deg, #1e40af 0%, #3730a3 100%); color: white; border: none; border-radius: 8px; padding: 12px 24px; font-weight: 600; transition: all 0.3s ease; }
        .professional-button:hover { transform: translateY(-2px); box-shadow: 0 8px 15px rgba(30, 64, 175, 0.3); }
        .api-config-section { background: #f8fafc; border: 2px solid #e2e8f0; border-radius: 12px; padding: 24px; margin: 20px 0; }
        .hidden { display: none; }
        .loading-bar { width: 100%; height: 4px; background: #e5e7eb; border-radius: 2px; overflow: hidden; }
        .loading-progress { height: 100%; background: linear-gradient(90deg, #1e40af, #3730a3, #7c3aed); animation: loading 2s infinite; }
        @keyframes loading { 0% { width: 0%; } 100% { width: 100%; } }
        .modal-backdrop { backdrop-filter: blur(10px); background: rgba(0, 0, 0, 0.5); }
        /* Print styles for PDF generation */
        /* Hide all interactive and notification elements */
@media print {
    /* Completely hide interactive elements */
    header,
    nav,
    .nav-link,
    #api-config,
    .professional-button,
    .tab-button,
    .generate-email-btn,
    #download-proposal-btn,
    #download-pdf-btn,
    .download-section,
    .notification,
    .api-config-section,
    .hidden,
    #particles-js,
    button,
    input,
    textarea,
    select,
    .interactive-demo,
    #email-modal,
    .modal-backdrop,
    .floating-card,
    .status-indicator,
    [id*="loader"],
    [class*="loading"],
    [onclick],
    .cursor-pointer {
        display: none !important;
        visibility: hidden !important;
    }

    /* Page setup */
    @page {
        size: A4;
        margin: 20mm 15mm;
        @top-center {
            content: "ECAM Engineering - AI-Driven MES-IoT Platform";
            font-size: 10pt;
            color: #666;
        }
        @bottom-center {
            content: "Page " counter(page) " of " counter(pages);
            font-size: 10pt;
            color: #666;
        }
    }

    /* Reset body and containers */
    * {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
    }

    body {
        font-family: 'Arial', 'Helvetica', sans-serif !important;
        font-size: 11pt !important;
        line-height: 1.4 !important;
        margin: 0 !important;
        padding: 0 !important;
        background: white !important;
        color: #333 !important;
        overflow: visible !important;
    }

    .container {
        margin: 0 !important;
        padding: 0 !important;
        max-width: none !important;
        width: 100% !important;
    }

    /* Section formatting */
    section {
        page-break-inside: avoid;
        margin-bottom: 15mm !important;
        padding: 10mm 0 !important;
        background: white !important;
        break-inside: avoid;
    }

    /* Headings optimization */
    h1, h2, h3, h4, h5, h6 {
        page-break-after: avoid;
        color: #1e40af !important;
        font-weight: bold !important;
        margin-top: 5mm !important;
        margin-bottom: 3mm !important;
    }

    h1 { font-size: 18pt !important; }
    h2 { font-size: 16pt !important; }
    h3 { font-size: 14pt !important; }
    h4 { font-size: 12pt !important; }

    /* Professional card styling for print */
    .professional-card {
        background: white !important;
        border: 1px solid #1e40af !important;
        border-radius: 5px !important;
        padding: 10px !important;
        margin: 5mm 0 !important;
        box-shadow: none !important;
        page-break-inside: avoid;
    }

    /* Image optimization */
    img {
        max-width: 100% !important;
        height: auto !important;
        page-break-inside: avoid;
        display: block !important;
        margin: 5mm auto !important;
        border: 1px solid #ddd !important;
    }

    /* Chart containers */
    .chart-container,
    .chart-image-container {
        background: white !important;
        border: 1px solid #1e40af !important;
        padding: 10px !important;
        page-break-inside: avoid;
        text-align: center !important;
    }

    /* Table styling */
    table {
        width: 100% !important;
        border-collapse: collapse !important;
        margin: 5mm 0 !important;
        page-break-inside: avoid;
        font-size: 10pt !important;
    }

    th, td {
        border: 1px solid #333 !important;
        padding: 5px !important;
        text-align: left !important;
        background: white !important;
        color: #333 !important;
    }

    th {
        background: #f0f0f0 !important;
        font-weight: bold !important;
    }

    /* Grid layouts for print */
    .grid {
        display: block !important;
    }

    .grid > div {
        display: block !important;
        margin-bottom: 5mm !important;
        width: 100% !important;
    }

    /* Color corrections for gradients */
    .hero-gradient,
    .professional-gradient,
    .success-gradient,
    .innovation-gradient {
        background: #1e40af !important;
        color: white !important;
        padding: 10px !important;
        border-radius: 5px !important;
    }

    /* Text color fixes */
    .text-white {
        color: white !important;
    }

    .professional-text {
        color: #1e40af !important;
    }

    /* Metric counters */
    .metric-counter {
        font-size: 24pt !important;
        font-weight: bold !important;
        color: #1e40af !important;
        text-align: center !important;
    }

    /* Timeline elements */
    .timeline-item {
        border: 1px solid #1e40af !important;
        padding: 10px !important;
        margin: 5px 0 !important;
        background: white !important;
    }

    .timeline-dot {
        display: inline-block !important;
        width: 30px !important;
        height: 30px !important;
        background: #1e40af !important;
        color: white !important;
        border-radius: 50% !important;
        text-align: center !important;
        line-height: 30px !important;
        margin-right: 10px !important;
    }

    /* Special elements */
    .typewriter {
        animation: none !important;
        border: none !important;
        white-space: normal !important;
    }

    /* Page breaks */
    .page-break-before {
        page-break-before: always !important;
    }

    .page-break-after {
        page-break-after: always !important;
    }

    /* Footer styling */
    .print-footer {
        position: fixed;
        bottom: 0;
        width: 100%;
        text-align: center;
        font-size: 10pt;
        color: #666;
    }
}
        .api-status-indicator { display: inline-block; width: 12px; height: 12px; border-radius: 50%; margin-left: 8px; }
        .api-configured { background-color: #10b981; }
        .api-not-configured { background-color: #f87171; }
        .professional-glow { box-shadow: 0 4px 20px rgba(30, 64, 175, 0.15); }
        .particles-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; z-index: -1; }
        .ai-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #1e40af;
            border-radius: 50%;
            animation: particle-float 3s infinite ease-in-out;
        }
        @keyframes particle-float {
            0%, 100% { transform: translateY(0) rotate(0deg); opacity: 1; }
            50% { transform: translateY(-30px) rotate(180deg); opacity: 0.5; }
        }
        .loading-bar {
            width: 100%;
            height: 4px;
            background: #e5e7eb;
            border-radius: 2px;
            overflow: hidden;
        }
        .loading-progress {
            height: 100%;
            background: linear-gradient(90deg, #1e40af, #3730a3, #7c3aed);
            animation: loading 2s infinite;
        }
        @keyframes loading {
            0% { width: 0%; }
            100% { width: 100%; }
        }
        .modal-backdrop {
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.5);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
        }
        .api-config-section {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 24px;
            margin: 20px 0;
        }
        .hidden { display: none; }
        .professional-card {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        .professional-button {
            background: linear-gradient(135deg, #1e40af 0%, #3730a3 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .professional-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(30, 64, 175, 0.3);  
        }

        /* Enhanced Interactive Elements */
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }

        .animate-float-delay {
            animation: float 6s ease-in-out infinite;
            animation-delay: 3s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        /* Slider Styling */
        input[type="range"] {
            appearance: none;
            -webkit-appearance: none;
            background: transparent;
            cursor: pointer;
        }

        input[type="range"]::-webkit-slider-track {
            background: #ddd;
            height: 8px;
            border-radius: 4px;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            background: #4CAF50;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            background: #4CAF50;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        /* Process Flow Animation */
        .flow-step {
            transition: all 0.3s ease;
            min-width: 140px;
        }

        .flow-step:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .flow-arrow {
            animation: pulse 2s infinite;
        }

        /* Dashboard Elements */
        .dashboard-preview .bg-gray-800 {
            transition: all 0.3s ease;
        }

        .dashboard-preview .bg-gray-800:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.2);
        }

        body { font-family: 'Inter', sans-serif; }
        .professional-card { 
            background: #ffffff; 
            border: 1px solid #e5e7eb; 
            border-radius: 12px; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        
        /* Modal Dialog Styles for ROI Calculator */
        .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(4px);
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.3s ease;
        }

        .modal-overlay.show {
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 1;
        }

        .modal-container {
        background: white;
        border-radius: 12px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 900px;
        max-height: 90vh;
        width: 90%;
        display: flex;
        flex-direction: column;
        transform: scale(0.9);
        transition: transform 0.3s ease;
        }

        .modal-overlay.show .modal-container {
        transform: scale(1);
        }

        .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 24px 32px;
        border-bottom: 1px solid #e5e7eb;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 12px 12px 0 0;
        }

        .modal-title {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 12px;
        }

        .modal-icon {
        font-size: 1.8rem;
        }

        .modal-close {
        background: none;
        border: none;
        color: white;
        font-size: 2rem;
        cursor: pointer;
        padding: 4px 8px;
        border-radius: 4px;
        transition: background-color 0.2s;
        }

        .modal-close:hover {
        background: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
        padding: 0;
        overflow-y: auto;
        flex: 1;
        max-height: calc(90vh - 160px);
        }

        .modal-tabs {
        display: flex;
        border-bottom: 1px solid #e5e7eb;
        background: #f9fafb;
        }

        .tab-button {
            background: none;
            border: none;
            padding: 16px 24px;
            cursor: pointer;
            font-weight: 600;
            color: #6b7280;
            border-bottom: 4px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-button:hover {
            color: #1e40af;
            border-bottom-color: #93c5fd;
        }

        .tab-button.active {
            color: #1e40af;
            border-bottom-color: #1e40af;
            background: rgba(30, 64, 175, 0.05);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Status indicators for the content */
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            display: inline-block;
        }

        .status-completed {
            background-color: #10b981;
        }

        .status-inprogress {
            background-color: #f59e0b;
        }

        .status-pending {
            background-color: #ef4444;
        }

        .professional-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .success-gradient {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .innovation-gradient {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .feature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 24px;
        }

        .feature-item {
        padding: 20px;
        background: #f8fafc;
        border-radius: 8px;
        border-left: 4px solid #667eea;
        }

        .feature-item h4 {
        margin-top: 0;
        color: #1f2937;
        font-size: 1rem;
        }

        .formula-section {
        margin-bottom: 32px;
        padding-bottom: 24px;
        border-bottom: 1px solid #e5e7eb;
        }

        .formula-box {
        background: #1f2937;
        color: #f9fafb;
        padding: 16px;
        border-radius: 6px;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        margin: 12px 0;
        overflow-x: auto;
        }

        .formula-box code {
        display: block;
        margin: 4px 0;
        font-size: 0.9rem;
        }

        .definition-list {
        space-y: 20px;
        }

        .definition-item {
        padding: 20px;
        background: #f8fafc;
        border-radius: 8px;
        margin-bottom: 16px;
        border-left: 4px solid #10b981;
        }

        .definition-item h4 {
        margin-top: 0;
        color: #1f2937;
        }

        .reference-section {
        margin-bottom: 32px;
        }

        .reference-section ul {
        padding-left: 20px;
        }

        .reference-section li {
        margin-bottom: 8px;
        color: #4b5563;
        }

        .modal-footer {
        display: flex;
        justify-content: flex-end;
        gap: 12px;
        padding: 24px 32px;
        border-top: 1px solid #e5e7eb;
        background: #f9fafb;
        border-radius: 0 0 12px 12px;
        }

        .btn-secondary, .btn-primary {
        padding: 12px 24px;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
        border: none;
        display: flex;
        align-items: center;
        gap: 8px;
        }

        .btn-secondary {
        background: #6b7280;
        color: white;
        }

        .btn-secondary:hover {
        background: #4b5563;
        }

        .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        }

        .btn-primary:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-icon {
        font-size: 1rem;
        }

        /* Popover Styles */
        .popover {
        position: absolute;
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        padding: 16px;
        max-width: 300px;
        z-index: 1001;
        opacity: 0;
        visibility: hidden;
        transition: all 0.2s ease;
        }

        .popover.show {
        opacity: 1;
        visibility: visible;
        }

        .popover-arrow {
        position: absolute;
        width: 0;
        height: 0;
        border-left: 8px solid transparent;
        border-right: 8px solid transparent;
        border-bottom: 8px solid white;
        top: -8px;
        left: 50%;
        transform: translateX(-50%);
        }

        .popover-content h4 {
        margin: 0 0 8px 0;
        color: #1f2937;
        font-size: 1rem;
        }

        .popover-content p {
        margin: 0;
        color: #6b7280;
        font-size: 0.9rem;
        line-height: 1.4;
        }

        /* Trigger Button Styles */
        .about-trigger {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        margin: 20px 10px;
        }

        .about-trigger:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .help-trigger {
        background: none;
        border: 1px solid #d1d5db;
        color: #6b7280;
        padding: 8px 12px;
        border-radius: 4px;
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.2s;
        margin: 20px 10px;
        }

        .help-trigger:hover {
        border-color: #667eea;
        color: #667eea;
        }

        /* Professional Card Styling */
        .professional-card {
        background: white;
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
        .modal-container {
            width: 95%;
            max-height: 95vh;
        }
        
        .modal-header {
            padding: 20px;
        }
        
        .modal-title {
            font-size: 1.3rem;
        }
        
        .tab-content {
            padding: 20px;
        }
        
        .feature-grid {
            grid-template-columns: 1fr;
        }
        
        .modal-footer {
            padding: 20px;
            flex-direction: column;
        }
        
        .btn-secondary, .btn-primary {
            width: 100%;
            justify-content: center;
        }
        .modal-tabs {
            display: flex;
            border-bottom: 1px solid #e5e7eb;
            background: #f9fafb;
        }

        .tab-button {
            flex: 1;
            padding: 16px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: #6b7280;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
        }

        .tab-button:hover {
            background: #f3f4f6;
            color: #374151;
        }

        .tab-button.active {
            color: #1e40af;
            border-bottom-color: #1e40af;
            background: white;
        }

        .tab-content {
            display: none;
            padding: 32px;
            line-height: 1.6;
        }

        .tab-content.active {
            display: block;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 24px;
        }

        .feature-item {
            padding: 20px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid #1e40af;
        }

        .formula-section {
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 1px solid #e5e7eb;
        }

        .reference-section {
            margin-bottom: 32px;
        }

        .reference-section ul {
            padding-left: 20px;
        }

        .reference-section li {
            margin-bottom: 8px;
            color: #4b5563;
        }
    }
    </style>
</head>
<body class="bg-gray-50">
    <main class="pt-24"></main>
    <!-- Particles Background -->
    <div id="particles-js" class="fixed inset-0 z-0"></div>

    <!-- Enhanced Navigation -->
    <header class="hero-gradient text-white fixed top-0 w-full z-50 shadow-xl">
        <nav class="container mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 bg-white rounded-lg flex items-center justify-center">
                        <span class="text-2xl font-bold text-blue-700">E</span>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold">ECAM Engineering</h1>
                        <p class="text-sm text-blue-200">AI-Powered Manufacturing Solutions</p>
                    </div>
                </div>
                <div class="hidden lg:flex space-x-8">
                    <!-- Home Button -->
                    /* <a href="{{ url_for('main.presentation_page') }}" class="nav__link home-btn"> */
                    /* <i class="fas fa-home"></i> Home</a> */
                    <a href="#hero" class="nav-link hover:text-blue-200 transition-all duration-300">Overview</a>
                    <a href="#ai-power" class="nav-link hover:text-blue-200 transition-all duration-300">AI Platform</a>
                    <a href="#capabilities" class="nav-link hover:text-blue-200 transition-all duration-300">Capabilities</a>
                    <a href="#financial" class="nav-link hover:text-blue-200 transition-all duration-300">Financial Impact</a>
                    <a href="#customer-success" class="nav-link hover:text-blue-200 transition-all duration-300">Success Stories</a>
                    <a href="#implementation" class="nav-link hover:text-blue-200 transition-all duration-300">Implementation</a>
                    <a href="#roi-calculator-section" class="nav-link hover:text-blue-200 transition-all duration-300">ROI Calculator</a>

                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="toggleApiConfig()" class="text-sm bg-white/20 px-4 py-2 rounded-lg hover:bg-white/30 transition">
                        🔧 AI Config
                    </button>
                </div>
            </div>
        </nav>
    </header>

    <main class="relative z-10">
        <!-- Professional Hero Section -->
        <section id="hero" class="hero-gradient text-white min-h-screen flex items-center relative overflow-hidden">
            <div class="particles-container">
                <div class="ai-particle" style="top: 20%; left: 10%; animation-delay: 0s;"></div>
                <div class="ai-particle" style="top: 60%; left: 80%; animation-delay: 1s;"></div>
                <div class="ai-particle" style="top: 40%; left: 60%; animation-delay: 2s;"></div>
                <div class="ai-particle" style="top: 80%; left: 30%; animation-delay: 1.5s;"></div>
            </div>
            
            <div class="container mx-auto px-6 relative z-10">
                <div class="text-center mb-16">
                    <h2 class="text-6xl md:text-7xl font-black mb-8 text-white">
                        MANUFACTURING EXCELLENCE
                    </h2>
                    <div class="typewriter text-2xl md:text-3xl text-blue-200 mb-8">
                        AI-Driven Digital Transformation Project Proposal
                    </div>
                    <p class="text-xl md:text-2xl text-blue-100 max-w-4xl mx-auto mb-12">
                        Proposal Plan for transforming ECAM Engineering into a precision manufacturing leader through advanced AI, 
                        IoT integration, and predictive technologies that enhance operational efficiency, reduce costs, and drive revenue growth.
                    </p>
                    
                    <!-- Professional Metrics -->
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-8 max-w-6xl mx-auto mb-16">
                        <div class="floating-card glass-effect p-8 rounded-2xl professional-glow">
                            <div class="metric-counter">£10M</div>
                            <p class="text-blue-200 font-semibold">Revenue Target</p>
                            <div class="text-green-300 text-sm">5-Year Projection</div>
                        </div>
                        <div class="floating-card glass-effect p-8 rounded-2xl professional-glow" style="animation-delay: 0.5s;">
                            <div class="metric-counter">90%</div>
                            <p class="text-blue-200 font-semibold">Efficiency Gain</p>
                            <div class="text-green-300 text-sm">In Quotation Generation</div>
                        </div>
                        <div class="floating-card glass-effect p-8 rounded-2xl professional-glow" style="animation-delay: 1s;">
                            <div class="metric-counter">350%</div>
                            <p class="text-blue-200 font-semibold">ROI</p>
                            <div class="text-green-300 text-sm">3-Year Return Expected</div>
                        </div>
                        <div class="floating-card glass-effect p-8 rounded-2xl professional-glow" style="animation-delay: 1.5s;">
                            <div class="metric-counter">£200K</div>
                            <p class="text-blue-200 font-semibold">Annual Savings</p>
                            <div class="text-green-300 text-sm">Maintenance & Efficiency</div>
                        </div>
                    </div>

                    <!-- Investment Information -->
                    <div class="space-y-6">
                        <div class="inline-flex items-center bg-white/10 text-white px-8 py-4 rounded-full font-bold text-xl">
                            💼 ECAM Investment: £135,010 over 3 Years
                        </div>
                        <div class="text-lg text-blue-200">
                            Strategic investment in digital transformation and competitive advantage
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- AI Configuration Section -->
        <div class="api-config-section hidden container mx-auto px-6" id="api-config">
            <h3 class="text-2xl font-bold mb-6 professional-text">🔧 AI Platform Configuration</h3>
            <div class="grid lg:grid-cols-2 gap-8">
                <div class="space-y-4">
                    <h4 class="text-lg font-semibold professional-text">API Keys Setup</h4>
                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                ChatGPT API Key
                                <span class="api-status-indicator api-not-configured" id="chatgpt-indicator"></span>
                            </label>
                            <input type="password" id="chatgpt-api-key" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="sk-...">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                Gemini API Key (Primary)
                                <span class="api-status-indicator api-configured" id="gemini-indicator"></span>
                            </label>
                            <input type="password" id="gemini-api-key" value="AIzaSyAFVK_PcT4wEaew-PEbSuDtvD9FMNJwU-Y" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="AIza...">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                Perplexity API Key (Fallback)
                                <span class="api-status-indicator api-configured" id="perplexity-indicator"></span>
                            </label>
                            <input type="password" id="perplexity-api-key" value="AIzaSyAFVK_PcT4wEaew-PEbSuDtvD9FMNJwU-Y" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="pplx-...">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                Copilot API Key
                                <span class="api-status-indicator api-not-configured" id="copilot-indicator"></span>
                            </label>
                            <input type="password" id="copilot-api-key" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="github_...">
                        </div>
                    </div>
                </div>
                <div class="professional-card p-6">
                    <h4 class="text-lg font-semibold professional-text mb-4">AI Model Priority</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border-l-4 border-green-500">
                            <span class="font-semibold">1. Gemini (Primary)</span>
                            <span id="gemini-status" class="text-green-600 text-sm font-bold">✓ Configured</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-blue-50 rounded-lg border-l-4 border-blue-500">
                            <span class="font-semibold">2. Perplexity (Fallback)</span>
                            <span id="perplexity-status" class="text-green-600 text-sm font-bold">✓ Configured</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg border-l-4 border-gray-300">
                            <span class="font-semibold">3. ChatGPT</span>
                            <span id="chatgpt-status" class="text-gray-500 text-sm">Not configured</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg border-l-4 border-gray-300">
                            <span class="font-semibold">4. Copilot</span>
                            <span id="copilot-status" class="text-gray-500 text-sm">Not configured</span>
                        </div>
                    </div>
                    <div class="mt-4 p-3 bg-blue-50 rounded-lg">
                        <p class="text-sm text-blue-700">
                            <strong>Auto-Fallback:</strong> System will automatically try the next available model if the primary fails.
                        </p>
                    </div>
                    <button onclick="saveApiConfig()" class="professional-button w-full mt-4">
                        💾 Save Configuration
                    </button>
                </div>
            </div>
        </div>

        <!-- Enhanced IoT Implementation Strategy Section -->
        <section class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-5xl md:text-6xl font-black text-gray-900 mb-8">
                        🌐 IoT ARCHITECTURE & SENSOR STRATEGY
                    </h2>
                    <p class="text-2xl text-gray-600 max-w-4xl mx-auto">
                        Comprehensive IoT retrofit and integration strategy for ECAM's 18-machine manufacturing facility, 
                        extending the proprietary `Datamile` system with real-time data collection and process tracking capabilities
                    </p>
                </div>

                <!-- Expected Project Benefits Chart -->
                <div class="mb-16">
                    <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">📊 Expected Project Benefits</h3>
                    <div class="professional-card p-8">
                        <div class="chart-image-container mb-6">
                            <img src="./assets/images/benefits_chart.png">
                                 alt="Expected Project Benefits Chart"
                                 class="w-full h-auto rounded-lg shadow-md"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div class="hidden text-center p-8 bg-gray-100 rounded-lg">
                                <div class="text-4xl mb-2">📊</div>
                                <p class="text-gray-600">Expected Project Benefits</p>
                                <p class="text-sm text-gray-500">Cost Savings | Efficiency | Productivity | Revenue Growth</p>
                            </div>
                        </div>
                        
                        <div class="grid md:grid-cols-4 gap-6 text-center">
                            <div class="bg-teal-50 p-4 rounded-lg">
                                <h4 class="font-bold text-teal-800 mb-2">Cost Savings</h4>
                                <p class="text-sm text-teal-600">Operational & maintenance cost reduction through predictive analytics</p>
                            </div>
                            <div class="bg-orange-50 p-4 rounded-lg">
                                <h4 class="font-bold text-orange-800 mb-2">Efficiency</h4>
                                <p class="text-sm text-orange-600">90% quotation time reduction with automated processes</p>
                            </div>
                            <div class="bg-green-50 p-4 rounded-lg">
                                <h4 class="font-bold text-green-800 mb-2">Productivity</h4>
                                <p class="text-sm text-green-600">20% production efficiency increase</p>
                            </div>
                            <div class="bg-red-50 p-4 rounded-lg">
                                <h4 class="font-bold text-red-800 mb-2">Waittimes Reduction</h4>
                                <p class="text-sm text-red-600">30% production wastage reduction</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Machine Distribution Analysis -->
                <div class="mb-16">
                    <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">📊 ECAM Machine Analysis</h3>
                    <div class="grid lg:grid-cols-2 gap-12">
                        <!-- Existing Machine Type Distribution -->
                        <div class="professional-card p-8">
                            <h4 class="text-2xl font-bold mb-6 text-center professional-text">🔧 Machine Type Distribution</h4>
                            <div class="chart-image-container">
                                <img src="./assets/images/machine_distribution.png">
                                     alt="ECAM Machine Type Distribution"
                                     class="w-full h-auto rounded-lg shadow-md"
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                <div class="hidden text-center p-8 bg-gray-100 rounded-lg">
                                    <div class="text-4xl mb-2">📊</div>
                                    <p class="text-gray-600">Machine Type Distribution</p>
                                    <p class="text-sm text-gray-500">CNC: 17.6% | Other: 64.9% | Press Brake: 5.8% | Cutting: 11.7%</p>
                                </div>
                            </div>
                        </div>

                        <!-- Existing Legacy vs Modern Split -->
                        <div class="professional-card p-8">
                            <h4 class="text-2xl font-bold mb-6 text-center professional-text">🔄 Old Machines vs New Machines</h4>
                            <div class="chart-image-container">
                                <img src="./assets/images/machine_distribution_grouped.png">
                                     alt="ECAM Old vs New Machines"
                                     class="w-full h-auto rounded-lg shadow-md"
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                <div class="hidden text-center p-8 bg-gray-100 rounded-lg">
                                    <div class="text-4xl mb-2">📊</div>
                                    <p class="text-gray-600">Old vs New Machines</p>
                                    <p class="text-sm text-gray-500">10 Old (No Sensors) | 8 New (Sensors)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- IoT Architecture Overview -->
                <div class="mb-16">
                    <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">🏗️ Datamile System Extension</h3>
                    <div class="professional-card p-8">
                        <div class="chart-image-container mb-6">
                            <img src="./assets/images/generated_image.png">
                                 alt="IoT Architecture for Manufacturing"
                                 class="w-full h-auto rounded-lg shadow-md"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div class="hidden text-center p-8 bg-gray-100 rounded-lg">
                                <div class="text-4xl mb-2">🏗️</div>
                                <p class="text-gray-600">IoT Architecture Diagram</p>
                                <p class="text-sm text-gray-500">Old Machines with Microcontroller + Built-in connectivity (New Machines) → Datamile</p>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 p-6 rounded-xl">
                            <h4 class="text-xl font-bold text-blue-800 mb-3">🔗 Datamile Integration Strategy</h4>
                            <p class="text-blue-700 mb-4">
                                Extending ECAM's proprietary Datamile system to incorporate real-time IoT data collection 
                                and process tracking capabilities.
                            </p>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div class="bg-white p-4 rounded-lg">
                                    <h5 class="font-bold text-blue-800 mb-2">Current System</h5>
                                    <p class="text-sm text-blue-600">Datamile handles production schedules displaying & report generations</p>
                                </div>
                                <div class="bg-white p-4 rounded-lg">
                                    <h5 class="font-bold text-green-800 mb-2">Enhanced System</h5>
                                    <p class="text-sm text-green-600">Real-time IoT data + process tracking + predictive analytics + AI enabled automated scheduling</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Live Manufacturing Dashboard -->
                <div class="mb-16">
                    <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">📱 Real-time Manufacturing Intelligence Dashboard</h3>
                    <div class="professional-card p-8">
                        <h4 class="text-2xl font-bold mb-6 text-center professional-text">🎯 Live Production Dashboard Interface</h4>
                        <div class="chart-image-container mb-6">
                            <img src="./assets/images/generated_image_1.png">
                                 alt="Manufacturing Monitoring Dashboard"
                                 class="w-full h-auto rounded-lg shadow-md"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div class="hidden text-center p-8 bg-gray-100 rounded-lg">
                                <div class="text-4xl mb-2">📱</div>
                                <p class="text-gray-600">Manufacturing Dashboard</p>
                                <p class="text-sm text-gray-500">Real-time machine status, production KPIs, and sensor data</p>
                            </div>
                        </div>
                        
                        <div class="grid md:grid-cols-4 gap-6">
                            <div class="bg-green-50 p-4 rounded-lg text-center">
                                <h5 class="font-bold text-green-800 mb-2">🟢 Machine Status</h5>
                                <p class="text-sm text-green-700">Real-time operational status monitoring with color-coded indicators</p>
                            </div>
                            <div class="bg-blue-50 p-4 rounded-lg text-center">
                                <h5 class="font-bold text-blue-800 mb-2">📊 Production KPIs</h5>
                                <p class="text-sm text-blue-700">Live production counts, efficiency metrics, and target tracking</p>
                            </div>
                            <div class="bg-purple-50 p-4 rounded-lg text-center">
                                <h5 class="font-bold text-purple-800 mb-2">🌡️ Sensor Data</h5>
                                <p class="text-sm text-purple-700">Temperature and vibration data with trend analysis</p>
                            </div>
                            <div class="bg-orange-50 p-4 rounded-lg text-center">
                                <h5 class="font-bold text-orange-800 mb-2">⚙️ Process Tracking</h5>
                                <p class="text-sm text-orange-700">Integrated with Datamile for comprehensive monitoring</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- IoT Cost Analysis -->
                <div class="mb-16">
                    <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">💰 Comprehensive IoT Investment Breakdown</h3>
                    <div class="grid lg:grid-cols-2 gap-12">
                        <div class="professional-card p-8">
                            <h4 class="text-2xl font-bold mb-6 text-center professional-text">📊 IoT Cost Breakdown</h4>
                            <div class="chart-image-container">
                                <img src="./assets/images/iot_cost_breakdown.png">
                                     alt="ECAM Engineering IoT Cost Breakdown"
                                     class="w-full h-auto rounded-lg shadow-md"
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                <div class="hidden text-center p-8 bg-gray-100 rounded-lg">
                                    <div class="text-4xl mb-2">💰</div>
                                    <p class="text-gray-600">IoT Cost Breakdown</p>
                                    <p class="text-sm text-gray-500">Installation & Configuration: 5.0k | Database Migration: 3.9k | Other components</p>
                                </div>
                            </div>
                            <p class="text-sm text-gray-600 mt-3 text-center">Detailed cost analysis showing installation as the primary investment component</p>
                        </div>
                        
                        <div class="space-y-6">
                            <div class="bg-blue-50 p-6 rounded-xl">
                                <h4 class="text-xl font-bold text-blue-800 mb-4">💎 Investment Summary</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-blue-700">Total IoT Investment:</span>
                                        <span class="font-bold text-blue-800">£12,550</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-blue-700">Datafile Database Migration:</span>
                                        <span class="font-bold text-blue-800">£3,950</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-blue-700">On a Average Cost per Machine:</span>
                                        <span class="font-bold text-blue-800">£586</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-blue-700">Expecting Payback Period:</span>
                                        <span class="font-bold text-green-600">14 months (expected)</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-green-50 p-6 rounded-xl">
                                <h4 class="text-xl font-bold text-green-800 mb-4">🎯 Key Components</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>Installation & Configuration:</span>
                                        <span class="font-bold text-green-700">£5,000 (39.85%)</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Datafile Database Migration:</span>
                                        <span class="font-bold text-green-700">£3,950 (31.57%)</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Expected Sensors:</span>
                                        <span class="font-bold text-green-700">£1,700 (13.64%)</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Micro Controllers:</span>
                                        <span class="font-bold text-green-700">£1,200 (9.66%)</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Connectivity Requirements:</span>
                                        <span class="font-bold text-green-700">£650 (5.28%)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Corrected Case Studies (Removed ECAM Prototype) -->
                <div class="mb-16">
                    <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">📈 Industry Validation: Proven Success Stories</h3>
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div class="professional-card p-6">
                            <h4 class="text-xl font-bold text-blue-600 mb-4">🏭 Tinsley Bridge (Sheffield, UK)</h4>
                            <div class="space-y-3">
                                <div class="bg-red-50 p-3 rounded-lg">
                                    <div class="font-semibold text-red-800">Challenge</div>
                                    <div class="text-sm text-red-600">35% unplanned downtime on legacy forging presses</div>
                                </div>
                                <div class="bg-blue-50 p-3 rounded-lg">
                                    <div class="font-semibold text-blue-800">Solution</div>
                                    <div class="text-sm text-blue-600">ESP32 + Banner QM30VT2 sensors retrofit</div>
                                </div>
                                <div class="bg-green-50 p-3 rounded-lg">
                                    <div class="font-semibold text-green-800">Results</div>
                                    <div class="text-sm text-green-600">28% downtime reduction<br>£142,000 annual savings</div>
                                </div>
                            </div>
                        </div>

                        <div class="professional-card p-6">
                            <h4 class="text-xl font-bold text-purple-600 mb-4">⚙️ Vishay Intertechnology</h4>
                            <div class="space-y-3">
                                <div class="bg-purple-50 p-3 rounded-lg">
                                    <div class="font-semibold text-purple-800">Implementation</div>
                                    <div class="text-sm text-purple-600">MTConnect adapters on 23 CNC machines</div>
                                </div>
                                <div class="bg-green-50 p-3 rounded-lg">
                                    <div class="font-semibold text-green-800">Outcomes</div>
                                    <div class="text-sm text-green-600">19% OEE improvement<br>63% faster work order reconciliation</div>
                                </div>
                                <div class="bg-blue-50 p-3 rounded-lg">
                                    <div class="font-semibold text-blue-800">Relevance to ECAM</div>
                                    <div class="text-sm text-blue-600">Similar machine profile and integration approach</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Technology Stack Visualization -->
                <section class="py-20 bg-white">
                    <div class="container mx-auto px-6">
                        <div class="professional-card p-8 bg-gradient-to-br from-blue-50 to-purple-50">
                            <h3 class="text-3xl font-bold text-center mb-8">⚙️ Advanced Technology Stack</h3>
                            <div class="tech-stack relative max-w-4xl mx-auto">
                                <div class="tech-layer animate-float bg-gradient-to-r from-purple-500 to-purple-600 text-white p-6 rounded-xl mb-4 shadow-lg">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="text-xl font-bold">Customer Portal & Analytics</h4>
                                            <p class="text-purple-200 text-sm">Web-based interface, reporting, AI insights</p>
                                        </div>
                                        <div class="text-3xl">🌐</div>
                                    </div>
                                </div>
                                <div class="tech-layer animate-float bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6 rounded-xl mb-4 shadow-lg" style="animation-delay: 0.5s;">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="text-xl font-bold">FlaskDatamile Core System</h4>
                                            <p class="text-blue-200 text-sm">Production tracking, order management, integration layer</p>
                                        </div>
                                        <div class="text-3xl">🏗️</div>
                                    </div>
                                </div>
                                <div class="tech-layer bg-gradient-to-r from-green-500 to-green-600 text-white p-6 rounded-xl mb-4 shadow-lg">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="text-xl font-bold">AI/ML Engine & Predictive Analytics</h4>
                                            <p class="text-green-200 text-sm">Machine learning models, predictive maintenance, optimization</p>
                                        </div>
                                        <div class="text-3xl">🤖</div>
                                    </div>
                                </div>
                                <div class="tech-layer animate-float bg-gradient-to-r from-orange-500 to-orange-600 text-white p-6 rounded-xl mb-4 shadow-lg" style="animation-delay: 1s;">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="text-xl font-bold">Edge Computing & Data Processing</h4>
                                            <p class="text-orange-200 text-sm">Real-time data processing, MQTT brokers, protocol translation</p>
                                        </div>
                                        <div class="text-3xl">⚡</div>
                                    </div>
                                </div>
                                <div class="tech-layer animate-float bg-gradient-to-r from-teal-500 to-teal-600 text-white p-6 rounded-xl shadow-lg" style="animation-delay: 1.5s;">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="text-xl font-bold">IoT Sensors & Machine Connectivity</h4>
                                            <p class="text-teal-200 text-sm">ESP32 controllers, vibration sensors, OPC UA, MTConnect</p>
                                        </div>
                                        <div class="text-3xl">📡</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="grid md:grid-cols-3 gap-6 mt-12">
                                <div class="text-center p-6 bg-white rounded-xl shadow-md">
                                    <div class="text-3xl mb-3">🔒</div>
                                    <h4 class="font-bold text-gray-800 mb-2">Enterprise Security</h4>
                                    <p class="text-sm text-gray-600">End-to-end encryption, secure protocols, access control</p>
                                </div>
                                <div class="text-center p-6 bg-white rounded-xl shadow-md">
                                    <div class="text-3xl mb-3">📈</div>
                                    <h4 class="font-bold text-gray-800 mb-2">Scalable Architecture</h4>
                                    <p class="text-sm text-gray-600">Microservices design, cloud-ready, future expansion</p>
                                </div>
                                <div class="text-center p-6 bg-white rounded-xl shadow-md">
                                    <div class="text-3xl mb-3">🔧</div>
                                    <h4 class="font-bold text-gray-800 mb-2">Seamless Integration</h4>
                                    <p class="text-sm text-gray-600">API-first design, standard protocols, minimal disruption</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>


                <!-- Datamile System Integration Details -->
                <div class="mb-16">
                    <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">🔗 Datamile System Integration</h3>
                    <div class="professional-card p-8 bg-gradient-to-br from-blue-50 to-green-50">
                        <div class="grid lg:grid-cols-2 gap-12">
                            <div>
                                <h4 class="text-2xl font-bold text-blue-600 mb-6">🏗️ System Architecture</h4>
                                <div class="space-y-4">
                                    <div class="bg-white p-4 rounded-lg shadow-sm">
                                        <h5 class="font-bold text-blue-800 mb-2">Current Datamile System</h5>
                                        <p class="text-sm text-blue-600">Production tracking and basic data management</p>
                                    </div>
                                    <div class="bg-white p-4 rounded-lg shadow-sm">
                                        <h5 class="font-bold text-green-800 mb-2">IoT Data Integration Layer</h5>
                                        <p class="text-sm text-green-600">MQTT broker + ESP32 controllers + OPC UA gateway</p>
                                    </div>
                                    <div class="bg-white p-4 rounded-lg shadow-sm">
                                        <h5 class="font-bold text-purple-800 mb-2">Enhanced Process Tracking</h5>
                                        <p class="text-sm text-purple-600">Real-time machine data + predictive analytics integration</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-2xl font-bold text-green-600 mb-6">📊 Enhanced Capabilities</h4>
                                <div class="space-y-4">
                                    <div class="p-4 bg-white rounded-lg shadow-sm">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-semibold">Real-time Data Collection</span>
                                            <span class="font-bold text-green-600">100%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-green-500 h-2 rounded-full" style="width: 100%"></div>
                                        </div>
                                    </div>
                                    <div class="p-4 bg-white rounded-lg shadow-sm">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-semibold">Process Tracking Automation</span>
                                            <span class="font-bold text-blue-600">95%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-500 h-2 rounded-full" style="width: 95%"></div>
                                        </div>
                                    </div>
                                    <div class="p-4 bg-white rounded-lg shadow-sm">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-semibold">Predictive Maintenance</span>
                                            <span class="font-bold text-purple-600">90%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-purple-500 h-2 rounded-full" style="width: 90%"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mt-6 p-4 bg-gradient-to-r from-green-100 to-blue-100 rounded-lg">
                                    <h5 class="font-bold text-gray-800 mb-2">🎯 Integration Benefits</h5>
                                    <ul class="text-sm text-gray-700 space-y-1">
                                        <li>• Seamless integration with existing Datamile workflows</li>
                                        <li>• No disruption to current production processes</li>
                                        <li>• Enhanced data visualization and reporting capabilities</li>
                                        <li>• Automated alerts and maintenance scheduling</li>
                                        <li>• Scalable architecture for future expansion</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- AI Platform Demonstration -->
        <section id="ai-power" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-5xl md:text-6xl font-black text-gray-900 mb-8">
                        🚀 AI PLATFORM CAPABILITIES
                    </h2>
                    <p class="text-2xl text-gray-600 max-w-4xl mx-auto">
                        Experience advanced AI integration that transforms manufacturing operations through 
                        intelligent automation and predictive analytics
                    </p>
                </div>

                <!-- Enhanced Text-to-CAD Demo -->
                <div class="mb-16">
                    <h3 class="text-4xl font-bold text-center mb-8 professional-text">🎨 Advanced Text-to-CAD Generation</h3>
                    <div class="grid lg:grid-cols-2 gap-12">
                        <div class="professional-card p-8">
                            <h4 class="text-2xl font-bold mb-6 professional-text">💭 Component Description</h4>
                            <textarea id="text-to-cad-input" class="w-full p-4 border-2 border-gray-300 rounded-lg h-32 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="🚀 Example: Design a titanium aerospace bracket with 6 bolt holes, 300mm x 200mm x 15mm, with integrated cooling channels and stress-relief cutouts for high-performance applications..."></textarea>
                            
                            <button id="generate-cad-btn" class="professional-button w-full mt-6 text-xl">
                                ✨ Generate Engineering Specifications
                            </button>
                            
                            <div id="cad-model-status" class="mt-4 text-center text-blue-600 font-semibold min-h-[24px]"></div>
                        </div>
                        
                        <div class="professional-card p-8">
                            <h4 class="text-2xl font-bold mb-6 professional-text">🎯 Generated Output</h4>
                            <div id="cad-output-loader" class="hidden justify-center items-center h-64">
                                <div class="loading-bar w-32">
                                    <div class="loading-progress"></div>
                                </div>
                            </div>
                            <div id="cad-output-container" class="space-y-6">
                                <div id="cad-specifications" class="bg-gray-50 p-6 rounded-lg border-2 border-blue-200">
                                    <h5 class="font-bold text-blue-700 mb-3">📋 Technical Specifications</h5>
                                    <pre id="cad-specs-output" class="text-gray-700 text-sm whitespace-pre-wrap">🎯 AI-generated specifications will appear here...</pre>
                                </div>
                                <div id="cad-image-container" class="bg-gray-50 p-6 rounded-lg border-2 border-green-200">
                                    <h5 class="font-bold text-green-700 mb-3">🖼️ Engineering Drawing Preview</h5>
                                    <div id="cad-image-output" class="flex justify-center items-center h-48 border-2 border-dashed border-gray-400 rounded-lg">
                                        <div class="text-center text-gray-500">
                                            <div class="text-4xl mb-2">📐</div>
                                            <span>AI-generated drawing will appear here</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Enhanced Capabilities Section -->
        <section id="capabilities" class="py-20 bg-gray-50">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-5xl md:text-6xl font-black text-gray-900 mb-8">
                        🎯 COMPREHENSIVE CAPABILITIES
                    </h2>
                    <p class="text-2xl text-gray-600 max-w-4xl mx-auto">
                        Seven integrated capabilities that transform ECAM into a manufacturing excellence leader
                    </p>
                </div>

                <!-- Capability Tabs -->
                <div class="mb-12 flex flex-wrap justify-center border-b-2 border-gray-200">
                    <button data-tab="predictive" class="tab-button py-4 px-8 text-gray-600 font-bold border-b-4 border-transparent hover:text-blue-600 hover:border-blue-600 transition-all active">🔮 Predictive Analytics</button>
                    <button data-tab="monitoring" class="tab-button py-4 px-8 text-gray-600 font-bold border-b-4 border-transparent hover:text-blue-600 hover:border-blue-600 transition-all">📊 Live Monitoring</button>
                    <button data-tab="planning" class="tab-button py-4 px-8 text-gray-600 font-bold border-b-4 border-transparent hover:text-blue-600 hover:border-blue-600 transition-all">📅 Smart Planning</button>
                    <button data-tab="email" class="tab-button py-4 px-8 text-gray-600 font-bold border-b-4 border-transparent hover:text-blue-600 hover:border-blue-600 transition-all">📧 AI Communication</button>
                    <button data-tab="quotation" class="tab-button py-4 px-8 text-gray-600 font-bold border-b-4 border-transparent hover:text-blue-600 hover:border-blue-600 transition-all">💰 Instant Quotes</button>
                    <button data-tab="retention" class="tab-button py-4 px-8 text-gray-600 font-bold border-b-4 border-transparent hover:text-blue-600 hover:border-blue-600 transition-all">❤️ Customer Success</button>
                    <button data-tab="innovation" class="tab-button py-4 px-8 text-gray-600 font-bold border-b-4 border-transparent hover:text-blue-600 hover:border-blue-600 transition-all">🧪 Innovation</button>
                </div>

                <!-- Tab Contents -->
                <div class="tab-contents">
                    <!-- Predictive Maintenance -->
                    <div id="predictive" class="tab-content active">
                        <div class="grid lg:grid-cols-2 gap-12 items-center">
                            <div class="fade-in-up">
                                <h3 class="text-4xl font-bold mb-6 professional-text">🔮 Predictive Maintenance Excellence</h3>
                                <p class="text-xl text-gray-700 mb-8">
                                    Advanced AI algorithms predict equipment failures up to 30 days in advance, eliminating 90% of unplanned downtime 
                                    and delivering £200,000 in annual maintenance cost savings.
                                </p>
                                <div class="space-y-6">
                                    <div class="professional-gradient p-6 rounded-xl text-white">
                                        <h4 class="font-bold text-xl mb-3">⚡ Real-time Health Monitoring</h4>
                                        <p>Advanced sensors track vibration, temperature, pressure, and performance metrics across all equipment</p>
                                    </div>
                                    <div class="success-gradient p-6 rounded-xl text-white">
                                        <h4 class="font-bold text-xl mb-3">🎯 ML-Powered Predictions</h4>
                                        <p>Machine learning algorithms analyze patterns to predict failures with 95% accuracy</p>
                                    </div>
                                    <div class="innovation-gradient p-6 rounded-xl text-white">
                                        <h4 class="font-bold text-xl mb-3">📱 Automated Alerts</h4>
                                        <p>Instant notifications to maintenance teams with detailed repair recommendations</p>
                                    </div>
                                </div>
                            </div>
                            <div class="scale-in">
                                <div class="professional-card p-8">
                                    <h4 class="text-2xl font-bold mb-6 professional-text">🎯 Predictive Analytics Dashboard</h4>
                                    <div class="space-y-4">
                                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-completed"></div>
                                                <span>CNC Lathe #3</span>
                                            </div>
                                            <span class="text-green-600 font-bold">Healthy (28 days)</span>
                                        </div>
                                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-inprogress"></div>
                                                <span>Plasma Cutter #1</span>
                                            </div>
                                            <span class="text-yellow-600 font-bold">Attention (7 days)</span>
                                        </div>
                                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-pending"></div>
                                                <span>Welding Robot #2</span>
                                            </div>
                                            <span class="text-red-600 font-bold">Critical (2 days)</span>
                                        </div>
                                    </div>
                                    <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                                        <h5 class="font-bold text-blue-700">💡 AI Recommendation</h5>
                                        <p class="text-sm text-blue-600">Schedule bearing replacement for Welding Robot #2 during next planned maintenance window</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Live Monitoring -->
                    <div id="monitoring" class="tab-content">
                        <div class="grid lg:grid-cols-2 gap-12 items-center mb-16">
                            <div class="fade-in-up">
                                <h3 class="text-4xl font-bold text-green-600 mb-6">📊 Real-time Production Intelligence</h3>
                                <p class="text-xl text-gray-700 mb-8">
                                    Monitor every machine, every process, every second with our advanced IoT and MTConnect integration 
                                    providing unprecedented visibility into your operations across all three ECAM sites.
                                </p>
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="bg-blue-100 p-4 rounded-lg text-center">
                                        <div class="text-3xl font-bold text-blue-600">25+</div>
                                        <div class="text-sm text-blue-800">Connected Machines</div>
                                    </div>
                                    <div class="bg-green-100 p-4 rounded-lg text-center">
                                        <div class="text-3xl font-bold text-green-600">24/7</div>
                                        <div class="text-sm text-green-800">Live Monitoring</div>
                                    </div>
                                    <div class="bg-purple-100 p-4 rounded-lg text-center">
                                        <div class="text-3xl font-bold text-purple-600">150GB</div>
                                        <div class="text-sm text-purple-800">Daily Data</div>
                                    </div>
                                    <div class="bg-orange-100 p-4 rounded-lg text-center">
                                        <div class="text-3xl font-bold text-orange-600">99.9%</div>
                                        <div class="text-sm text-orange-800">Uptime</div>
                                    </div>
                                </div>
                            </div>
                            <div class="scale-in">
                                <div class="professional-card p-8">
                                    <h4 class="text-2xl font-bold mb-6 text-center">🎯 Live Production Dashboard</h4>
                                    <div class="chart-container">
                                        <canvas id="liveMonitoringChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Real-time Work Center Status -->
                        <div class="mb-16">
                            <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">🏭 Live Work Center Status</h3>
                            <div class="grid lg:grid-cols-3 gap-6">
                                <!-- Cutting Operations -->
                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-blue-600 mb-4">⚡ Cutting Operations</h4>
                                    <div class="space-y-3">
                                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border-l-4 border-green-500">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-completed"></div>
                                                <span class="font-medium">WC00001 - LASER</span>
                                            </div>
                                            <span class="text-green-600 font-bold">Running (92%)</span>
                                        </div>
                                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border-l-4 border-green-500">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-completed"></div>
                                                <span class="font-medium">WC00005 - H.D PLASMA</span>
                                            </div>
                                            <span class="text-green-600 font-bold">Running (88%)</span>
                                        </div>
                                        <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg border-l-4 border-yellow-500">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-inprogress"></div>
                                                <span class="font-medium">WC00010 - PROFILE CUTTER</span>
                                            </div>
                                            <span class="text-yellow-600 font-bold">Setup (15%)</span>
                                        </div>
                                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border-l-4 border-green-500">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-completed"></div>
                                                <span class="font-medium">WC00020 - SAW</span>
                                            </div>
                                            <span class="text-green-600 font-bold">Running (95%)</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Machining Operations -->
                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-purple-600 mb-4">🔧 Machining Operations</h4>
                                    <div class="space-y-3">
                                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border-l-4 border-green-500">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-completed"></div>
                                                <span class="font-medium">WC00060 - WARD 7</span>
                                            </div>
                                            <span class="text-green-600 font-bold">Running (89%)</span>
                                        </div>
                                        <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg border-l-4 border-yellow-500">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-inprogress"></div>
                                                <span class="font-medium">WC00068 - HI TECH LATHE</span>
                                            </div>
                                            <span class="text-yellow-600 font-bold">Milling (78%)</span>
                                        </div>
                                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border-l-4 border-green-500">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-completed"></div>
                                                <span class="font-medium">WC00041 - SINGLE SPINDLE DRILL</span>
                                            </div>
                                            <span class="text-green-600 font-bold">Running (92%)</span>
                                        </div>
                                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border-l-4 border-green-500">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-completed"></div>
                                                <span class="font-medium">WC00070 - PRESS BRAKE</span>
                                            </div>
                                            <span class="text-green-600 font-bold">Running (85%)</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Finishing Operations -->
                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-orange-600 mb-4">🎨 Finishing Operations</h4>
                                    <div class="space-y-3">
                                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border-l-4 border-green-500">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-completed"></div>
                                                <span class="font-medium">WC00080 - WELD</span>
                                            </div>
                                            <span class="text-green-600 font-bold">Running (94%)</span>
                                        </div>
                                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border-l-4 border-green-500">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-completed"></div>
                                                <span class="font-medium">WC00094 - SHOTBLAST</span>
                                            </div>
                                            <span class="text-green-600 font-bold">Running (87%)</span>
                                        </div>
                                        <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg border-l-4 border-yellow-500">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-inprogress"></div>
                                                <span class="font-medium">WC00091 - PRIME PAINT</span>
                                            </div>
                                            <span class="text-yellow-600 font-bold">Batch Change (65%)</span>
                                        </div>
                                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border-l-4 border-green-500">
                                            <div class="flex items-center">
                                                <div class="status-indicator status-completed"></div>
                                                <span class="font-medium">WC00092 - GLOSS PAINT</span>
                                            </div>
                                            <span class="text-green-600 font-bold">Running (91%)</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Live Order Tracking -->
                        <div class="mb-16">
                            <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">📦 Live Order Progress Tracking</h3>
                            <div class="grid lg:grid-cols-2 gap-8">
                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-blue-600 mb-4">Order BAM003-476/66504 - CLAMPING PLATE</h4>
                                    <div class="space-y-4">
                                        <div class="flex justify-between items-center">
                                            <span>Customer: Caterpillar Manufacturing</span>
                                            <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-bold">Priority</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-blue-600 h-3 rounded-full" style="width: 75%"></div>
                                        </div>
                                        <div class="grid grid-cols-2 gap-4 text-sm">
                                            <div>✅ WC00081 - TACK WELD (Completed)</div>
                                            <div>✅ WC00080 - WELD (Completed)</div>
                                            <div>🔄 WC00091 - PRIME PAINT (In Progress)</div>
                                            <div>⏳ WC00092 - GLOSS PAINT (Pending)</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-green-600 mb-4">Order BAM002-331/14549 - WA SHOVEL LEVER</h4>
                                    <div class="space-y-4">
                                        <div class="flex justify-between items-center">
                                            <span>Customer: JCB Manufacturing</span>
                                            <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-bold">On Track</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-green-600 h-3 rounded-full" style="width: 45%"></div>
                                        </div>
                                        <div class="grid grid-cols-2 gap-4 text-sm">
                                            <div>✅ WC00080 - WELD (Completed)</div>
                                            <div>🔄 WC00031 - LINISH (In Progress)</div>
                                            <div>⏳ WC00066 - DAH-LIH (Pending)</div>
                                            <div>⏳ Quality Control (Pending)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Material Flow Tracking -->
                        <div>
                            <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">📋 Live Material Flow</h3>
                            <div class="professional-card p-8">
                                <div class="grid lg:grid-cols-4 gap-6">
                                    <div class="text-center">
                                        <div class="w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                            <span class="text-white font-bold text-xl">📦</span>
                                        </div>
                                        <h4 class="font-bold text-gray-800 mb-2">Material Stock</h4>
                                        <div class="text-2xl font-bold text-blue-600">2,847</div>
                                        <div class="text-sm text-gray-600">Items in stock</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="w-16 h-16 bg-orange-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                            <span class="text-white font-bold text-xl">🔄</span>
                                        </div>
                                        <h4 class="font-bold text-gray-800 mb-2">WIP Tracking</h4>
                                        <div class="text-2xl font-bold text-orange-600">147</div>
                                        <div class="text-sm text-gray-600">Jobs in progress</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                            <span class="text-white font-bold text-xl">✅</span>
                                        </div>
                                        <h4 class="font-bold text-gray-800 mb-2">Completed</h4>
                                        <div class="text-2xl font-bold text-green-600">89</div>
                                        <div class="text-sm text-gray-600">Jobs completed today</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="w-16 h-16 bg-purple-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                            <span class="text-white font-bold text-xl">📊</span>
                                        </div>
                                        <h4 class="font-bold text-gray-800 mb-2">Efficiency</h4>
                                        <div class="text-2xl font-bold text-purple-600">94.2%</div>
                                        <div class="text-sm text-gray-600">Overall OEE</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Add other tab contents with similar structure but hidden by default -->
                    <div id="planning" class="tab-content">
                        <div class="grid lg:grid-cols-2 gap-12 items-center mb-16">
                            <div class="fade-in-up">
                                <h3 class="text-4xl font-bold text-purple-600 mb-6">📅 AI-Powered Production Planning</h3>
                                <p class="text-xl text-gray-700 mb-8">
                                    Revolutionary intelligent scheduling system that optimizes production sequences based on 
                                    material availability, machine capacity, operator skills, and delivery requirements using 
                                    advanced constraint programming and machine learning.
                                </p>
                                <div class="space-y-4">
                                    <div class="bg-purple-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-purple-800">🎯 Optimized Scheduling</h4>
                                        <p class="text-purple-600">AI algorithms consider setup times, material flow, and resource constraints</p>
                                    </div>
                                    <div class="bg-blue-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-blue-800">⚡ Dynamic Replanning</h4>
                                        <p class="text-blue-600">Automatic schedule adjustment for rush orders and equipment changes</p>
                                    </div>
                                    <div class="bg-green-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-green-800">📊 Capacity Optimization</h4>
                                        <p class="text-green-600">Maximize throughput while minimizing changeover times and waste</p>
                                    </div>
                                </div>
                            </div>
                            <div class="scale-in">
                                <div class="professional-card p-8">
                                    <h4 class="text-2xl font-bold mb-6 text-center text-purple-600">🗓️ Smart Schedule Optimizer</h4>
                                    <div class="space-y-4">
                                        <!-- Real schedule example based on BOM data -->
                                        <div class="bg-purple-50 p-4 rounded-lg">
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="font-bold text-purple-800">WC00001 - LASER</span>
                                                <span class="text-sm text-purple-600">92% Utilization</span>
                                            </div>
                                            <div class="space-y-2 text-sm">
                                                <div class="flex justify-between">
                                                    <span>SAFETY STRUT (274/42600/1)</span>
                                                    <span class="text-green-600">09:00-11:30</span>
                                                </div>
                                                <div class="flex justify-between">
                                                    <span>INNER PLATE (331/14256)</span>
                                                    <span class="text-blue-600">11:45-14:15</span>
                                                </div>
                                                <div class="flex justify-between">
                                                    <span>SIDE SUPPORT PLATE (335/F8817)</span>
                                                    <span class="text-orange-600">14:30-16:00</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-blue-50 p-4 rounded-lg">
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="font-bold text-blue-800">WC00080 - WELD</span>
                                                <span class="text-sm text-blue-600">89% Utilization</span>
                                            </div>
                                            <div class="space-y-2 text-sm">
                                                <div class="flex justify-between">
                                                    <span>CLAMPING PLATE (476/66504)</span>
                                                    <span class="text-green-600">08:30-12:00</span>
                                                </div>
                                                <div class="flex justify-between">
                                                    <span>WA QUICKHITCH (335/06624)</span>
                                                    <span class="text-blue-600">13:00-17:00</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-green-50 p-4 rounded-lg">
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="font-bold text-green-800">WC00091 - PRIME PAINT</span>
                                                <span class="text-sm text-green-600">78% Utilization</span>
                                            </div>
                                            <div class="text-sm">
                                                <div class="flex justify-between">
                                                    <span>Batch Paint Job (Multiple Items)</span>
                                                    <span class="text-green-600">10:00-15:00</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mt-6 p-4 bg-gradient-to-r from-purple-100 to-blue-100 rounded-lg">
                                        <h5 class="font-bold text-gray-800 mb-2">🤖 AI Optimization Results</h5>
                                        <div class="grid grid-cols-2 gap-4 text-sm">
                                            <div>
                                                <span class="font-semibold">Setup Time:</span>
                                                <span class="text-green-600 ml-2">-35%</span>
                                            </div>
                                            <div>
                                                <span class="font-semibold">Throughput:</span>
                                                <span class="text-green-600 ml-2">+22%</span>
                                            </div>
                                            <div>
                                                <span class="font-semibold">Delivery:</span>
                                                <span class="text-green-600 ml-2">99.2%</span>
                                            </div>
                                            <div>
                                                <span class="font-semibold">Efficiency:</span>
                                                <span class="text-green-600 ml-2">94.7%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Material Planning Intelligence -->
                        <div class="mb-16">
                            <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">📦 Intelligent Material Planning</h3>
                            <div class="grid lg:grid-cols-3 gap-8">
                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-blue-600 mb-4">📋 Material Requirements</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center p-3 bg-blue-50 rounded-lg">
                                            <div>
                                                <div class="font-semibold">PL01280 - 15mm S275 PLATE</div>
                                                <div class="text-sm text-gray-600">Required: 8.75% of plate</div>
                                            </div>
                                            <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">In Stock</span>
                                        </div>
                                        <div class="flex justify-between items-center p-3 bg-yellow-50 rounded-lg">
                                            <div>
                                                <div class="font-semibold">MT10067 - 70 O/D HFS</div>
                                                <div class="text-sm text-gray-600">Required: 0.5 meters</div>
                                            </div>
                                            <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm">Low Stock</span>
                                        </div>
                                        <div class="flex justify-between items-center p-3 bg-red-50 rounded-lg">
                                            <div>
                                                <div class="font-semibold">P4200/0300 - PINK ZINC PRIMER</div>
                                                <div class="text-sm text-gray-600">Required: 0.8 liters</div>
                                            </div>
                                            <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm">Order Now</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-green-600 mb-4">🎯 Resource Optimization</h4>
                                    <div class="space-y-4">
                                        <div>
                                            <div class="flex justify-between mb-2">
                                                <span>Material Utilization</span>
                                                <span class="font-bold">87.4%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-green-500 h-2 rounded-full" style="width: 87.4%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between mb-2">
                                                <span>Waste Reduction</span>
                                                <span class="font-bold">23.7%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-blue-500 h-2 rounded-full" style="width: 76.3%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between mb-2">
                                                <span>Cost Optimization</span>
                                                <span class="font-bold">18.9%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-purple-500 h-2 rounded-full" style="width: 81.1%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-purple-600 mb-4">⚡ Dynamic Scheduling</h4>
                                    <div class="space-y-3">
                                        <div class="p-3 bg-purple-50 rounded-lg">
                                            <div class="font-semibold text-purple-800">Rush Order Integration</div>
                                            <div class="text-sm text-purple-600">Automatic slot finding and resequencing</div>
                                        </div>
                                        <div class="p-3 bg-blue-50 rounded-lg">
                                            <div class="font-semibold text-blue-800">Machine Breakdown Recovery</div>
                                            <div class="text-sm text-blue-600">Alternative routing and load balancing</div>
                                        </div>
                                        <div class="p-3 bg-green-50 rounded-lg">
                                            <div class="font-semibold text-green-800">Capacity Planning</div>
                                            <div class="text-sm text-green-600">Forward and backward scheduling optimization</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="email" class="tab-content">
                        <div class="grid lg:grid-cols-2 gap-12 items-center mb-16">
                            <div class="fade-in-up">
                                <h3 class="text-4xl font-bold text-red-600 mb-6">📧 Intelligent Communication Hub</h3>
                                <p class="text-xl text-gray-700 mb-8">
                                    Revolutionary AI-powered communication system that automatically generates personalized customer updates, 
                                    technical reports, and stakeholder communications based on real-time production data and project status.
                                </p>
                                <div class="space-y-4">
                                    <div class="bg-red-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-red-800">🤖 Smart Content Generation</h4>
                                        <p class="text-red-600">AI analyzes production data to create technical and non-technical communications</p>
                                    </div>
                                    <div class="bg-blue-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-blue-800">📊 Real-time Data Integration</h4>
                                        <p class="text-blue-600">Automatically pulls live production, quality, and delivery information</p>
                                    </div>
                                    <div class="bg-green-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-green-800">🎯 Personalized Messaging</h4>
                                        <p class="text-green-600">Adapts tone, technical detail, and content based on recipient profile</p>
                                    </div>
                                </div>
                            </div>
                            <div class="scale-in">
                                <div class="professional-card p-8">
                                    <h4 class="text-2xl font-bold mb-6 text-center text-red-600">🎯 Communication Analytics</h4>
                                    <div class="space-y-4">
                                        <div class="grid grid-cols-2 gap-4">
                                            <div class="text-center p-4 bg-red-50 rounded-lg">
                                                <div class="text-2xl font-bold text-red-600">2,847</div>
                                                <div class="text-sm text-red-800">Auto-generated emails</div>
                                            </div>
                                            <div class="text-center p-4 bg-blue-50 rounded-lg">
                                                <div class="text-2xl font-bold text-blue-600">98.4%</div>
                                                <div class="text-sm text-blue-800">Customer satisfaction</div>
                                            </div>
                                            <div class="text-center p-4 bg-green-50 rounded-lg">
                                                <div class="text-2xl font-bold text-green-600">78%</div>
                                                <div class="text-sm text-green-800">Time savings</div>
                                            </div>
                                            <div class="text-center p-4 bg-purple-50 rounded-lg">
                                                <div class="text-2xl font-bold text-purple-600">24/7</div>
                                                <div class="text-sm text-purple-800">Availability</div>
                                            </div>
                                        </div>
                                        
                                        <div class="space-y-3">
                                            <h5 class="font-bold text-gray-800">📈 Communication Types</h5>
                                            <div class="space-y-2">
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm">Order Progress Updates</span>
                                                    <div class="flex items-center">
                                                        <div class="w-24 bg-gray-200 rounded-full h-2 mr-2">
                                                            <div class="bg-red-500 h-2 rounded-full" style="width: 85%"></div>
                                                        </div>
                                                        <span class="text-sm font-bold">85%</span>
                                                    </div>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm">Quality Reports</span>
                                                    <div class="flex items-center">
                                                        <div class="w-24 bg-gray-200 rounded-full h-2 mr-2">
                                                            <div class="bg-blue-500 h-2 rounded-full" style="width: 67%"></div>
                                                        </div>
                                                        <span class="text-sm font-bold">67%</span>
                                                    </div>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm">Delivery Notifications</span>
                                                    <div class="flex items-center">
                                                        <div class="w-24 bg-gray-200 rounded-full h-2 mr-2">
                                                            <div class="bg-green-500 h-2 rounded-full" style="width: 92%"></div>
                                                        </div>
                                                        <span class="text-sm font-bold">92%</span>
                                                    </div>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm">Technical Updates</span>
                                                    <div class="flex items-center">
                                                        <div class="w-24 bg-gray-200 rounded-full h-2 mr-2">
                                                            <div class="bg-purple-500 h-2 rounded-full" style="width: 74%"></div>
                                                        </div>
                                                        <span class="text-sm font-bold">74%</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- AI Communication Examples -->
                        <div class="mb-16">
                            <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">💬 Smart Communication Examples</h3>
                            <div class="grid lg:grid-cols-2 gap-8">
                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-blue-600 mb-4">📋 Technical Progress Report</h4>
                                    <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-blue-500">
                                        <div class="font-bold text-sm mb-2">To: JCB Manufacturing - Technical Team</div>
                                        <div class="font-bold text-sm mb-3">Re: WA SHOVEL LEVER 456HT - Order 331/14549</div>
                                        <div class="text-sm space-y-2">
                                            <p><strong>Production Update:</strong></p>
                                            <p>✅ WC00080 WELD operations completed with 100% quality pass rate</p>
                                            <p>🔄 WC00031 LINISH currently in progress - 67% complete</p>
                                            <p>📊 Material consumption: PL01371 S275 plate usage optimized to 6.67%</p>
                                            <p><strong>Quality Metrics:</strong> All dimensional tolerances within spec</p>
                                            <p><strong>Expected Completion:</strong> Tomorrow 14:30</p>
                                        </div>
                                    </div>
                                    <div class="mt-3 text-xs text-gray-500">🤖 Auto-generated from live production data</div>
                                </div>

                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-green-600 mb-4">📧 Customer-Friendly Update</h4>
                                    <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-green-500">
                                        <div class="font-bold text-sm mb-2">To: Caterpillar Manufacturing - Project Manager</div>
                                        <div class="font-bold text-sm mb-3">Re: Your CLAMPING PLATE Order - Excellent Progress!</div>
                                        <div class="text-sm space-y-2">
                                            <p>Dear Project Manager,</p>
                                            <p>Great news! Your clamping plate order is progressing beautifully and is currently 75% complete.</p>
                                            <p><strong>What's been completed:</strong> Precision welding with our latest robotic systems</p>
                                            <p><strong>Currently happening:</strong> Premium black primer application</p>
                                            <p><strong>Next step:</strong> Final gloss coating for maximum durability</p>
                                            <p><strong>Your delivery date:</strong> Still on track for Thursday as promised!</p>
                                            <p>As always, feel free to visit our facility anytime.</p>
                                        </div>
                                    </div>
                                    <div class="mt-3 text-xs text-gray-500">🤖 Auto-adapted for non-technical audience</div>
                                </div>
                            </div>
                        </div>

                        <!-- Advanced Features -->
                        <div>
                            <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">🚀 Advanced Communication Features</h3>
                            <div class="grid lg:grid-cols-4 gap-6">
                                <div class="professional-card p-6 text-center">
                                    <div class="w-16 h-16 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <span class="text-white font-bold text-xl">🎯</span>
                                    </div>
                                    <h4 class="font-bold text-gray-800 mb-2">Smart Routing</h4>
                                    <p class="text-sm text-gray-600">Automatically sends to right stakeholders based on urgency and content type</p>
                                </div>
                                <div class="professional-card p-6 text-center">
                                    <div class="w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <span class="text-white font-bold text-xl">🌍</span>
                                    </div>
                                    <h4 class="font-bold text-gray-800 mb-2">Multi-Language</h4>
                                    <p class="text-sm text-gray-600">Automatic translation for international customers with technical accuracy</p>
                                </div>
                                <div class="professional-card p-6 text-center">
                                    <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <span class="text-white font-bold text-xl">⏰</span>
                                    </div>
                                    <h4 class="font-bold text-gray-800 mb-2">Predictive Alerts</h4>
                                    <p class="text-sm text-gray-600">Proactive notifications for potential delays or quality concerns</p>
                                </div>
                                <div class="professional-card p-6 text-center">
                                    <div class="w-16 h-16 bg-purple-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <span class="text-white font-bold text-xl">📊</span>
                                    </div>
                                    <h4 class="font-bold text-gray-800 mb-2">Rich Media</h4>
                                    <p class="text-sm text-gray-600">Automatic inclusion of progress photos, charts, and technical drawings</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="quotation" class="tab-content">
                        <div class="grid lg:grid-cols-2 gap-12 items-center mb-16">
                            <div class="fade-in-up">
                                <h3 class="text-4xl font-bold text-green-600 mb-6">💰 Revolutionary Instant Quotation Engine</h3>
                                <p class="text-xl text-gray-700 mb-8">
                                    Transform quotation generation from days to minutes with our AI-powered system that analyzes 
                                    drawings, calculates material requirements, determines processing routes, and delivers 
                                    accurate pricing with delivery schedules in real-time.
                                </p>
                                <div class="space-y-4">
                                    <div class="bg-green-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-green-800">🎯 90% Time Reduction</h4>
                                        <p class="text-green-600">From 3-5 days to 2-5 minutes for complex assemblies</p>
                                    </div>
                                    <div class="bg-blue-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-blue-800">📐 AI Drawing Analysis</h4>
                                        <p class="text-blue-600">Computer vision extracts dimensions, materials, and features automatically</p>
                                    </div>
                                    <div class="bg-purple-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-purple-800">💡 Smart Cost Modeling</h4>
                                        <p class="text-purple-600">ML algorithms learn from historical data to improve accuracy continuously</p>
                                    </div>
                                </div>
                            </div>
                            <div class="scale-in">
                                <div class="professional-card p-8">
                                    <h4 class="text-2xl font-bold mb-6 text-center text-green-600">⚡ Live Quotation Demo</h4>
                                    
                                    <!-- Interactive Quote Example -->
                                    <div class="space-y-4">
                                        <div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-500">
                                            <div class="font-bold text-green-800 mb-2">Example: SAFETY STRUT WA</div>
                                            <div class="grid grid-cols-2 gap-4 text-sm">
                                                <div>
                                                    <span class="font-semibold">Material:</span>
                                                    <span class="ml-1">2500x1250x6mm RQT701</span>
                                                </div>
                                                <div>
                                                    <span class="font-semibold">Usage:</span>
                                                    <span class="ml-1">3.33% of plate</span>
                                                </div>
                                                <div>
                                                    <span class="font-semibold">Operations:</span>
                                                    <span class="ml-1">Laser → Press Brake → Drill</span>
                                                </div>
                                                <div>
                                                    <span class="font-semibold">Finish:</span>
                                                    <span class="ml-1">Prime + Gloss Paint</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-blue-50 p-4 rounded-lg">
                                            <div class="font-bold text-blue-800 mb-3">💰 Instant Cost Breakdown</div>
                                            <div class="space-y-2 text-sm">
                                                <div class="flex justify-between">
                                                    <span>Material Cost:</span>
                                                    <span class="font-bold">£127.50</span>
                                                </div>
                                                <div class="flex justify-between">
                                                    <span>Processing (WC00001, WC00070, WC00041):</span>
                                                    <span class="font-bold">£89.20</span>
                                                </div>
                                                <div class="flex justify-between">
                                                    <span>Painting (Prime + Gloss):</span>
                                                    <span class="font-bold">£45.80</span>
                                                </div>
                                                <div class="flex justify-between">
                                                    <span>Setup & Programming:</span>
                                                    <span class="font-bold">£62.30</span>
                                                </div>
                                                <hr class="my-2">
                                                <div class="flex justify-between font-bold text-lg">
                                                    <span>Total Price:</span>
                                                    <span class="text-green-600">£324.80</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-purple-50 p-4 rounded-lg">
                                            <div class="font-bold text-purple-800 mb-3">📅 Delivery Schedule</div>
                                            <div class="text-sm space-y-1">
                                                <div>🚀 <strong>Express:</strong> 3 days (+15%)</div>
                                                <div>⚡ <strong>Standard:</strong> 5-7 days</div>
                                                <div>📋 <strong>Economy:</strong> 10-14 days (-8%)</div>
                                            </div>
                                        </div>
                                        
                                        <div class="text-center text-xs text-gray-500">
                                            🤖 Generated in 2.3 seconds using AI analysis
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Quote Complexity Handling -->
                        <div class="mb-16">
                            <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">🎯 Multi-Complexity Quote Handling</h3>
                            <div class="grid lg:grid-cols-3 gap-8">
                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-green-600 mb-4">🔧 Simple Components</h4>
                                    <div class="space-y-3">
                                        <div class="bg-green-50 p-3 rounded-lg">
                                            <div class="font-semibold">STUD (DM12031)</div>
                                            <div class="text-sm text-gray-600">M10 HT STUDDING - 0.0227 meters</div>
                                            <div class="font-bold text-green-600">£12.50 - 30 seconds</div>
                                        </div>
                                        <div class="bg-green-50 p-3 rounded-lg">
                                            <div class="font-semibold">WELD NUT (826/10603)</div>
                                            <div class="text-sm text-gray-600">M8 Self-locating - Quantity 4</div>
                                            <div class="font-bold text-green-600">£18.90 - 25 seconds</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-blue-600 mb-4">⚙️ Complex Assemblies</h4>
                                    <div class="space-y-3">
                                        <div class="bg-blue-50 p-3 rounded-lg">
                                            <div class="font-semibold">WA QUICKHITCH (335/06624)</div>
                                            <div class="text-sm text-gray-600">Multi-operation welded assembly</div>
                                            <div class="font-bold text-blue-600">£2,847.50 - 3.2 minutes</div>
                                        </div>
                                        <div class="bg-blue-50 p-3 rounded-lg">
                                            <div class="font-semibold">OUTER LEG WA (335/F7649)</div>
                                            <div class="text-sm text-gray-600">Complex machined weldment</div>
                                            <div class="font-bold text-blue-600">£1,956.80 - 4.1 minutes</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-purple-600 mb-4">🎨 Custom Projects</h4>
                                    <div class="space-y-3">
                                        <div class="bg-purple-50 p-3 rounded-lg">
                                            <div class="font-semibold">Bespoke Aerospace Bracket</div>
                                            <div class="text-sm text-gray-600">Inconel 718 with special tolerances</div>
                                            <div class="font-bold text-purple-600">£4,250.00 - 5.8 minutes</div>
                                        </div>
                                        <div class="bg-purple-50 p-3 rounded-lg">
                                            <div class="font-semibold">Prototype Assembly</div>
                                            <div class="text-sm text-gray-600">One-off design with testing</div>
                                            <div class="font-bold text-purple-600">£3,890.50 - 7.2 minutes</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Customer Portal Integration -->
                        <div>
                            <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">🌐 Customer Self-Service Portal</h3>
                            <div class="professional-card p-8">
                                <div class="grid lg:grid-cols-2 gap-12">
                                    <div>
                                        <h4 class="text-2xl font-bold text-green-600 mb-6">🎯 Portal Features</h4>
                                        <div class="space-y-4">
                                            <div class="flex items-start space-x-3">
                                                <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mt-1">
                                                    <span class="text-white text-sm">📁</span>
                                                </div>
                                                <div>
                                                    <div class="font-semibold">Drawing Upload & Analysis</div>
                                                    <div class="text-sm text-gray-600">Drag & drop CAD files, PDFs, or images for instant analysis</div>
                                                </div>
                                            </div>
                                            <div class="flex items-start space-x-3">
                                                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center mt-1">
                                                    <span class="text-white text-sm">🎛️</span>
                                                </div>
                                                <div>
                                                    <div class="font-semibold">Interactive Configuration</div>
                                                    <div class="text-sm text-gray-600">Adjust materials, finishes, and delivery options in real-time</div>
                                                </div>
                                            </div>
                                            <div class="flex items-start space-x-3">
                                                <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center mt-1">
                                                    <span class="text-white text-sm">💰</span>
                                                </div>
                                                <div>
                                                    <div class="font-semibold">Live Pricing Updates</div>
                                                    <div class="text-sm text-gray-600">See cost changes instantly as you modify specifications</div>
                                                </div>
                                            </div>
                                            <div class="flex items-start space-x-3">
                                                <div class="w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center mt-1">
                                                    <span class="text-white text-sm">📋</span>
                                                </div>
                                                <div>
                                                    <div class="font-semibold">One-Click Ordering</div>
                                                    <div class="text-sm text-gray-600">Convert quotes to purchase orders with digital approval workflow</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 class="text-2xl font-bold text-blue-600 mb-6">📊 Business Impact</h4>
                                        <div class="space-y-6">
                                            <div>
                                                <div class="flex justify-between mb-2">
                                                    <span>Quote Volume Increase</span>
                                                    <span class="font-bold text-green-600">+127%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-3">
                                                    <div class="bg-green-500 h-3 rounded-full" style="width: 100%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between mb-2">
                                                    <span>Conversion Rate</span>
                                                    <span class="font-bold text-blue-600">89.3%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-3">
                                                    <div class="bg-blue-500 h-3 rounded-full" style="width: 89%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between mb-2">
                                                    <span>Customer Satisfaction</span>
                                                    <span class="font-bold text-purple-600">96.7%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-3">
                                                    <div class="bg-purple-500 h-3 rounded-full" style="width: 97%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between mb-2">
                                                    <span>Administrative Savings</span>
                                                    <span class="font-bold text-orange-600">78%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-3">
                                                    <div class="bg-orange-500 h-3 rounded-full" style="width: 78%"></div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="mt-6 p-4 bg-gradient-to-r from-green-100 to-blue-100 rounded-lg">
                                            <div class="font-bold text-gray-800 mb-2">💡 Key Success Metric</div>
                                            <div class="text-2xl font-bold text-green-600">£2.3M</div>
                                            <div class="text-sm text-gray-600">Additional annual revenue from increased quote volume</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="retention" class="tab-content">
                        <div class="grid lg:grid-cols-2 gap-12 items-center mb-16">
                            <div class="fade-in-up">
                                <h3 class="text-4xl font-bold text-pink-600 mb-6">❤️ Enhanced Customer Engagement</h3>
                                <p class="text-xl text-gray-700 mb-8">
                                    Improved customer service through real-time production tracking, automated communications, 
                                    and enhanced engagement capabilities that build stronger business relationships and improve 
                                    customer satisfaction through transparency and proactive communication.
                                </p>
                                <div class="space-y-4">
                                    <div class="bg-pink-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-pink-800">📧 Automated Communication</h4>
                                        <p class="text-pink-600">AI-generated progress updates and status reports for key customers</p>
                                    </div>
                                    <div class="bg-blue-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-blue-800">👁️ Real-time Visibility</h4>
                                        <p class="text-blue-600">Production tracking system providing customers with live order status</p>
                                    </div>
                                    <div class="bg-green-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-green-800">⚡ Faster Response</h4>
                                        <p class="text-green-600">Instant quotation system reducing response times from days to minutes</p>
                                    </div>
                                </div>
                            </div>
                            <div class="scale-in">
                                <div class="professional-card p-8">
                                    <h4 class="text-2xl font-bold mb-6 text-center text-pink-600">📊 Customer Service Improvements</h4>
                                    <div class="space-y-4">
                                        <!-- Realistic improvement metrics -->
                                        <div class="grid grid-cols-2 gap-4">
                                            <div class="text-center p-4 bg-green-50 rounded-lg">
                                                <div class="text-2xl font-bold text-green-600">90%</div>
                                                <div class="text-sm text-green-800">Quote time reduction</div>
                                            </div>
                                            <div class="text-center p-4 bg-blue-50 rounded-lg">
                                                <div class="text-2xl font-bold text-blue-600">Real-time</div>
                                                <div class="text-sm text-blue-800">Order tracking</div>
                                            </div>
                                            <div class="text-center p-4 bg-purple-50 rounded-lg">
                                                <div class="text-2xl font-bold text-purple-600">24/7</div>
                                                <div class="text-sm text-purple-800">Portal access</div>
                                            </div>
                                            <div class="text-center p-4 bg-orange-50 rounded-lg">
                                                <div class="text-2xl font-bold text-orange-600">Improved</div>
                                                <div class="text-sm text-orange-800">Satisfaction</div>
                                            </div>
                                        </div>
                                        
                                        <!-- Customer Portal Features -->
                                        <div class="space-y-3">
                                            <h5 class="font-bold text-gray-800">🌐 Customer Portal Features</h5>
                                            <div class="space-y-2">
                                                <div class="flex items-center p-3 bg-blue-50 rounded-lg">
                                                    <div class="w-3 h-3 bg-blue-500 rounded-full mr-3"></div>
                                                    <span class="text-sm">Drawing upload and analysis</span>
                                                </div>
                                                <div class="flex items-center p-3 bg-green-50 rounded-lg">
                                                    <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                                    <span class="text-sm">Instant quotation generation</span>
                                                </div>
                                                <div class="flex items-center p-3 bg-purple-50 rounded-lg">
                                                    <div class="w-3 h-3 bg-purple-500 rounded-full mr-3"></div>
                                                    <span class="text-sm">Live production tracking</span>
                                                </div>
                                                <div class="flex items-center p-3 bg-orange-50 rounded-lg">
                                                    <div class="w-3 h-3 bg-orange-500 rounded-full mr-3"></div>
                                                    <span class="text-sm">Automated status updates</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Customer Example Based on BOM Data -->
                        <div class="mb-16">
                            <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">📋 Customer Communication Example</h3>
                            <div class="professional-card p-8">
                                <div class="grid lg:grid-cols-2 gap-8">
                                    <div>
                                        <h4 class="text-xl font-bold text-blue-600 mb-4">📧 Automated Progress Email</h4>
                                        <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-blue-500">
                                            <div class="font-bold text-sm mb-2">To: JCB Manufacturing</div>
                                            <div class="font-bold text-sm mb-3">Re: WA SHOVEL LEVER 456HT - Order 331/14549</div>
                                            <div class="text-sm space-y-2">
                                                <p><strong>Current Progress:</strong></p>
                                                <p>✅ WC00080 WELD - Completed successfully</p>
                                                <p>🔄 WC00031 LINISH - Currently in progress (estimated completion: tomorrow)</p>
                                                <p>📅 WC00066 DAH-LIH - Scheduled to begin Thursday</p>
                                                <p><strong>Material Status:</strong> S275 plate material optimally utilized</p>
                                                <p><strong>Quality:</strong> All work centers passing quality checks</p>
                                                <p><strong>Expected Delivery:</strong> On schedule for Friday</p>
                                            </div>
                                        </div>
                                        <div class="mt-3 text-xs text-gray-500">🤖 Generated automatically from live production data</div>
                                    </div>

                                    <div>
                                        <h4 class="text-xl font-bold text-green-600 mb-4">📊 Customer Benefits</h4>
                                        <div class="space-y-4">
                                            <div class="bg-green-50 p-4 rounded-lg">
                                                <div class="font-semibold text-green-800">Proactive Communication</div>
                                                <div class="text-sm text-green-600">Customers receive updates before they need to ask</div>
                                            </div>
                                            <div class="bg-blue-50 p-4 rounded-lg">
                                                <div class="font-semibold text-blue-800">Technical Transparency</div>
                                                <div class="text-sm text-blue-600">Clear visibility into production processes and quality</div>
                                            </div>
                                            <div class="bg-purple-50 p-4 rounded-lg">
                                                <div class="font-semibold text-purple-800">Reduced Admin</div>
                                                <div class="text-sm text-purple-600">Less time spent on status calls and email exchanges</div>
                                            </div>
                                        </div>
                                        
                                        <div class="mt-6 p-4 bg-gradient-to-r from-green-100 to-blue-100 rounded-lg">
                                            <div class="font-bold text-gray-800 mb-2">📈 Expected Outcome</div>
                                            <div class="text-sm text-gray-600">Enhanced customer relationships through improved transparency and communication</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="innovation" class="tab-content">
                        <div class="grid lg:grid-cols-2 gap-12 items-center mb-16">
                            <div class="fade-in-up">
                                <h3 class="text-4xl font-bold text-indigo-600 mb-6">🧪 Technology Innovation & Development</h3>
                                <p class="text-xl text-gray-700 mb-8">
                                    Strategic innovation through the KTP partnership, focusing on AI integration, 
                                    digital transformation, and advanced manufacturing technologies that position 
                                    ECAM as a technology leader in precision engineering.
                                </p>
                                <div class="space-y-4">
                                    <div class="bg-indigo-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-indigo-800">🤖 AI Integration</h4>
                                        <p class="text-indigo-600">Text-to-CAD conversion and machine learning for quotation generation</p>
                                    </div>
                                    <div class="bg-purple-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-purple-800">🔗 IoT Connectivity</h4>
                                        <p class="text-purple-600">MTConnect integration and real-time production monitoring</p>
                                    </div>
                                    <div class="bg-blue-100 p-4 rounded-lg">
                                        <h4 class="font-bold text-blue-800">💡 Digital Platform</h4>
                                        <p class="text-blue-600">Comprehensive MES-IoT platform development for competitive advantage</p>
                                    </div>
                                </div>
                            </div>
                            <div class="scale-in">
                                <div class="professional-card p-8">
                                    <h4 class="text-2xl font-bold mb-6 text-center text-indigo-600">🎯 KTP Innovation Outcomes</h4>
                                    <div class="space-y-4">
                                        <!-- KTP Project Deliverables -->
                                        <div class="space-y-3">
                                            <div class="flex items-center p-3 bg-indigo-50 rounded-lg border-l-4 border-indigo-500">
                                                <div class="w-3 h-3 bg-indigo-500 rounded-full mr-3"></div>
                                                <div class="flex-1">
                                                    <div class="font-semibold text-indigo-800">AI-Powered Quotation Engine</div>
                                                    <div class="text-sm text-indigo-600">Machine learning for instant cost estimation</div>
                                                </div>
                                            </div>
                                            
                                            <div class="flex items-center p-3 bg-blue-50 rounded-lg border-l-4 border-blue-500">
                                                <div class="w-3 h-3 bg-blue-500 rounded-full mr-3"></div>
                                                <div class="flex-1">
                                                    <div class="font-semibold text-blue-800">Text-to-CAD Technology</div>
                                                    <div class="text-sm text-blue-600">Generative AI for drawing interpretation</div>
                                                </div>
                                            </div>
                                            
                                            <div class="flex items-center p-3 bg-green-50 rounded-lg border-l-4 border-green-500">
                                                <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                                <div class="flex-1">
                                                    <div class="font-semibold text-green-800">Predictive Maintenance</div>
                                                    <div class="text-sm text-green-600">Equipment health monitoring and alerts</div>
                                                </div>
                                            </div>
                                            
                                            <div class="flex items-center p-3 bg-purple-50 rounded-lg border-l-4 border-purple-500">
                                                <div class="w-3 h-3 bg-purple-500 rounded-full mr-3"></div>
                                                <div class="flex-1">
                                                    <div class="font-semibold text-purple-800">Customer Portal Platform</div>
                                                    <div class="text-sm text-purple-600">Interactive web-based customer interface</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- KTP Timeline -->
                                        <div class="mt-6 grid grid-cols-3 gap-4 text-center">
                                            <div class="p-3 bg-blue-50 rounded-lg">
                                                <div class="text-lg font-bold text-blue-600">36</div>
                                                <div class="text-xs text-blue-800">Month Project</div>
                                            </div>
                                            <div class="p-3 bg-green-50 rounded-lg">
                                                <div class="text-lg font-bold text-green-600">BCU</div>
                                                <div class="text-xs text-green-800">Partnership</div>
                                            </div>
                                            <div class="p-3 bg-purple-50 rounded-lg">
                                                <div class="text-lg font-bold text-purple-600">£80K</div>
                                                <div class="text-xs text-purple-800">Investment</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- KTP Innovation Framework -->
                        <div class="mb-16">
                            <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">🔬 Knowledge Transfer Innovation</h3>
                            <div class="grid lg:grid-cols-3 gap-8">
                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-blue-600 mb-4">🎓 Academic Expertise</h4>
                                    <div class="space-y-3">
                                        <div class="bg-blue-50 p-3 rounded-lg">
                                            <div class="font-semibold text-blue-800">Birmingham City University</div>
                                            <div class="text-sm text-blue-600">AI, Machine Learning, and Digital Manufacturing expertise</div>
                                        </div>
                                        <div class="bg-indigo-50 p-3 rounded-lg">
                                            <div class="font-semibold text-indigo-800">Research & Development</div>
                                            <div class="text-sm text-indigo-600">Latest academic thinking in Industry 4.0 technologies</div>
                                        </div>
                                        <div class="bg-purple-50 p-3 rounded-lg">
                                            <div class="font-semibold text-purple-800">Knowledge Transfer Associate</div>
                                            <div class="text-sm text-purple-600">Highly qualified graduate embedding innovation</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-green-600 mb-4">🏭 Manufacturing Application</h4>
                                    <div class="space-y-3">
                                        <div class="bg-green-50 p-3 rounded-lg">
                                            <div class="font-semibold text-green-800">Real Production Environment</div>
                                            <div class="text-sm text-green-600">Implementation across ECAM's three-site operation</div>
                                        </div>
                                        <div class="bg-teal-50 p-3 rounded-lg">
                                            <div class="font-semibold text-teal-800">Industry Validation</div>
                                            <div class="text-sm text-teal-600">Testing with major customers like JCB and Caterpillar</div>
                                        </div>
                                        <div class="bg-cyan-50 p-3 rounded-lg">
                                            <div class="font-semibold text-cyan-800">Scalable Solutions</div>
                                            <div class="text-sm text-cyan-600">Technologies applicable across precision engineering sector</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="professional-card p-6">
                                    <h4 class="text-xl font-bold text-purple-600 mb-4">🚀 Innovation Outcomes</h4>
                                    <div class="space-y-3">
                                        <div class="bg-purple-50 p-3 rounded-lg">
                                            <div class="font-semibold text-purple-800">Competitive Advantage</div>
                                            <div class="text-sm text-purple-600">Industry-leading quotation and delivery capabilities</div>
                                        </div>
                                        <div class="bg-pink-50 p-3 rounded-lg">
                                            <div class="font-semibold text-pink-800">Growth Enablement</div>
                                            <div class="text-sm text-pink-600">Platform to support £4.4M to £10M revenue growth</div>
                                        </div>
                                        <div class="bg-orange-50 p-3 rounded-lg">
                                            <div class="font-semibold text-orange-800">Knowledge Embedding</div>
                                            <div class="text-sm text-orange-600">Permanent capability enhancement beyond project completion</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Technology Development Areas -->
                        <div>
                            <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">⚙️ Core Technology Development</h3>
                            <div class="professional-card p-8">
                                <div class="grid lg:grid-cols-2 gap-8">
                                    <div>
                                        <h4 class="text-2xl font-bold text-indigo-600 mb-6">🛠️ Technical Implementation</h4>
                                        <div class="space-y-4">
                                            <div class="flex items-start space-x-3">
                                                <div class="w-8 h-8 bg-indigo-500 rounded-full flex items-center justify-center mt-1">
                                                    <span class="text-white text-sm">1</span>
                                                </div>
                                                <div>
                                                    <div class="font-semibold">MES Integration</div>
                                                    <div class="text-sm text-gray-600">Connect all production equipment with centralized monitoring</div>
                                                </div>
                                            </div>
                                            <div class="flex items-start space-x-3">
                                                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center mt-1">
                                                    <span class="text-white text-sm">2</span>
                                                </div>
                                                <div>
                                                    <div class="font-semibold">AI Algorithm Development</div>
                                                    <div class="text-sm text-gray-600">Machine learning models trained on ECAM's historical data</div>
                                                </div>
                                            </div>
                                            <div class="flex items-start space-x-3">
                                                <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mt-1">
                                                    <span class="text-white text-sm">3</span>
                                                </div>
                                                <div>
                                                    <div class="font-semibold">Customer Interface Design</div>
                                                    <div class="text-sm text-gray-600">User-friendly portal for drawing upload and quotation</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 class="text-2xl font-bold text-green-600 mb-6">📊 Expected Innovation Impact</h4>
                                        <div class="space-y-4">
                                            <div>
                                                <div class="flex justify-between mb-2">
                                                    <span>Quotation Speed Improvement</span>
                                                    <span class="font-bold text-green-600">90%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-3">
                                                    <div class="bg-green-500 h-3 rounded-full" style="width: 90%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between mb-2">
                                                    <span>Process Automation</span>
                                                    <span class="font-bold text-blue-600">75%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-3">
                                                    <div class="bg-blue-500 h-3 rounded-full" style="width: 75%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between mb-2">
                                                    <span>Customer Self-Service</span>
                                                    <span class="font-bold text-purple-600">60%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-3">
                                                    <div class="bg-purple-500 h-3 rounded-full" style="width: 60%"></div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="mt-6 p-4 bg-gradient-to-r from-indigo-100 to-blue-100 rounded-lg">
                                            <div class="font-bold text-gray-800 mb-2">🏆 Innovation Goal</div>
                                            <div class="text-sm text-gray-600">Establish ECAM as a technology leader in AI-driven precision manufacturing</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Enhanced Financial Impact Section -->
        <section id="financial" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-5xl md:text-6xl font-black text-gray-900 mb-8">
                        💰 FINANCIAL IMPACT ANALYSIS
                    </h2>
                    <p class="text-2xl text-gray-600 max-w-4xl mx-auto">
                        Comprehensive financial modeling demonstrates exceptional return on investment with quantified 
                        benefits across operational efficiency and revenue growth
                    </p>
                </div>

                <!-- Investment Overview -->
                <div class="mb-16 professional-gradient rounded-3xl p-8 text-white">
                    <h3 class="text-4xl font-bold text-center mb-8">🎯 Investment Overview</h3>
                    <div class="grid md:grid-cols-4 gap-6">
                        <div class="text-center">
                            <div class="text-4xl font-bold">£80K</div>
                            <div class="text-sm opacity-90">ECAM Investment</div>
                            <div class="text-xs opacity-75">Over 3 Years</div>
                        </div>
                        <div class="text-center">
                            <div class="text-4xl font-bold">18-24</div>
                            <div class="text-sm opacity-90">Months Payback</div>
                            <div class="text-xs opacity-75">Rapid ROI</div>
                        </div>
                        <div class="text-center">
                            <div class="text-4xl font-bold">350%</div>
                            <div class="text-sm opacity-90">3-Year ROI</div>
                            <div class="text-xs opacity-75">Exceptional Returns</div>
                        </div>
                        <div class="text-center">
                            <div class="text-4xl font-bold">£10M</div>
                            <div class="text-sm opacity-90">Revenue Target</div>
                            <div class="text-xs opacity-75">5-Year Projection</div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Charts Section -->
                <div class="grid lg:grid-cols-3 gap-8 mb-16">
                    <div class="professional-card p-6">
                        <h4 class="text-xl font-bold text-center mb-4 professional-text">📊 Expected Benefits</h4>
                        <div class="chart-image-container">
                            <img src="./assets/images/benefits_chart.png">
                                 alt="Benefits Chart" 
                                 class="w-full h-auto rounded-lg shadow-md"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div class="hidden text-center p-8 bg-gray-100 rounded-lg">
                                <div class="text-4xl mb-2">📊</div>
                                <p class="text-gray-600">Benefits Chart</p>
                                <p class="text-sm text-gray-500">Operational improvements and cost savings</p>
                            </div>
                        </div>
                        <p class="text-sm text-gray-600 mt-3 text-center">Comprehensive overview of operational improvements and cost savings across key metrics</p>
                    </div>
                    
                    <div class="professional-card p-6">
                        <h4 class="text-xl font-bold text-center mb-4 professional-text">📈 Revenue Growth Projection</h4>
                        <div class="chart-image-container">
                            <img src="./assets/images/revenue_growth_projection.png">
                                 alt="Revenue Growth Chart" 
                                 class="w-full h-auto rounded-lg shadow-md"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div class="hidden text-center p-8 bg-gray-100 rounded-lg">
                                <div class="text-4xl mb-2">📈</div>
                                <p class="text-gray-600">Revenue Growth Chart</p>
                                <p class="text-sm text-gray-500">£4.4M to £10M trajectory</p>
                            </div>
                        </div>
                        <p class="text-sm text-gray-600 mt-3 text-center">Strategic growth trajectory from £4.4M current revenue to £10M target over 5 years</p>
                    </div>
                    
                    <div class="professional-card p-6">
                        <h4 class="text-xl font-bold text-center mb-4 professional-text">🛣️ Implementation Timeline</h4>
                        <div class="chart-image-container">
                            <img src="./assets/images/implementation_timeline.png">
                                 alt="Implementation Timeline" 
                                 class="w-full h-auto rounded-lg shadow-md"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div class="hidden text-center p-8 bg-gray-100 rounded-lg">
                                <div class="text-4xl mb-2">🛣️</div>
                                <p class="text-gray-600">Implementation Timeline</p>
                                <p class="text-sm text-gray-500">36-month delivery plan</p>
                            </div>
                        </div>
                        <p class="text-sm text-gray-600 mt-3 text-center">36-month structured delivery plan with defined milestones and deliverables</p>
                    </div>
                </div>

                <!-- Interactive Financial Charts -->
                <div class="grid lg:grid-cols-2 gap-12 mb-16">
                    <div class="professional-card p-8">
                        <h3 class="text-3xl font-bold text-center mb-6 professional-text">📈 Revenue Trajectory</h3>
                        <div class="chart-container">
                            <canvas id="revenueChart"></canvas>
                        </div>
                        <div class="mt-6 text-center">
                            <div class="text-lg text-gray-600">Targeting exponential growth through AI-driven efficiency</div>
                        </div>
                    </div>
                    <div class="professional-card p-8">
                        <h3 class="text-3xl font-bold text-center mb-6 professional-text">🎯 Cost Savings Impact</h3>
                        <div class="chart-container">
                            <canvas id="savingsChart"></canvas>
                        </div>
                        <div class="mt-6 text-center">
                            <div class="text-lg text-gray-600">Multiple value streams delivering exceptional returns</div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Financial Metrics -->
                <div class="professional-gradient rounded-xl p-8 text-white">
                    <h3 class="text-3xl font-bold text-center mb-8">💎 Key Financial Metrics</h3>
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="text-center">
                            <div class="text-4xl font-bold mb-2">15-20%</div>
                            <div class="text-lg">Operational Cost Reduction</div>
                        </div>
                        <div class="text-center">
                            <div class="text-4xl font-bold mb-2">90%</div>
                            <div class="text-lg">Quotation Time Reduction</div>
                        </div>
                        <div class="text-center">
                            <div class="text-4xl font-bold mb-2">20%</div>
                            <div class="text-lg">Production Throughput Increase</div>
                        </div>
                        <div class="text-center">
                            <div class="text-4xl font-bold mb-2">25%</div>
                            <div class="text-lg">Maintenance Cost Reduction</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Customer Success Section -->
        <section id="customer-success" class="py-20 bg-gray-50">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-5xl md:text-6xl font-black text-gray-900 mb-8">
                        🎯 CUSTOMER SUCCESS PLATFORM
                    </h2>
                    <p class="text-2xl text-gray-600 max-w-4xl mx-auto">
                        Advanced customer engagement through real-time production tracking and AI-powered communication systems
                    </p>
                </div>

                <!-- Live Customer Order Demo -->
                <div class="professional-card p-8 mb-16">
                    <h3 class="text-3xl font-bold mb-8 text-center professional-text">🚀 Live Production Tracking Example</h3>
                    
                    <!-- Order Header -->
                    <div class="grid md:grid-cols-3 gap-8 mb-12">
                        <div class="bg-blue-50 p-6 rounded-xl border border-blue-200">
                            <h4 class="font-bold text-blue-700 text-xl mb-4">📋 Order Details</h4>
                            <div class="space-y-2 text-blue-600">
                                <p><strong>Order #:</strong> ECM-2025-0847</p>
                                <p><strong>Customer:</strong> Rolls-Royce Manufacturing</p>
                                <p><strong>Component:</strong> Turbine Housing Assembly</p>
                                <p><strong>Priority:</strong> High-Value Contract</p>
                            </div>
                        </div>
                        <div class="bg-green-50 p-6 rounded-xl border border-green-200">
                            <h4 class="font-bold text-green-700 text-xl mb-4">📊 Progress Status</h4>
                            <div class="space-y-2 text-green-600">
                                <p><strong>Overall:</strong> 75% Complete</p>
                                <p><strong>Expected Delivery:</strong> 2 Days</p>
                                <p><strong>Quality Status:</strong> Exceeding Standards</p>
                                <p><strong>Customer Satisfaction:</strong> 98%</p>
                            </div>
                        </div>
                        <div class="bg-yellow-50 p-6 rounded-xl border border-yellow-200">
                            <h4 class="font-bold text-yellow-700 text-xl mb-4">💰 Production Value</h4>
                            <div class="space-y-2 text-yellow-600">
                                <p><strong>Contract Value:</strong> £24,750</p>
                                <p><strong>Materials Cost:</strong> £8,950</p>
                                <p><strong>Labour Hours:</strong> 156h</p>
                                <p><strong>Profit Margin:</strong> 42%</p>
                            </div>
                        </div>
                    </div>

                    <!-- Enhanced Bill of Materials -->
                    <div class="mb-12">
                        <h4 class="text-2xl font-bold mb-6 text-center professional-text">🔧 Bill of Materials & Live Production Status</h4>
                        <div class="overflow-x-auto">
                            <table class="w-full bg-white rounded-xl overflow-hidden shadow-lg">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="p-4 text-left text-gray-700">Part</th>
                                        <th class="p-4 text-left text-gray-700">Material</th>
                                        <th class="p-4 text-left text-gray-700">Dimensions</th>
                                        <th class="p-4 text-left text-gray-700">Processes</th>
                                        <th class="p-4 text-left text-gray-700">Status</th>
                                        <th class="p-4 text-left text-gray-700">Quality</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-gray-100">
                                        <td class="p-4 font-semibold">Housing Shell</td>
                                        <td class="p-4">Inconel 718</td>
                                        <td class="p-4">Ø450 x 280mm</td>
                                        <td class="p-4">Laser Cutting → CNC Machining → Bending</td>
                                        <td class="p-4">
                                            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">
                                                ✅ Completed
                                            </span>
                                        </td>
                                        <td class="p-4 text-green-600">100% ✨</td>
                                    </tr>
                                    <tr class="border-b border-gray-100">
                                        <td class="p-4 font-semibold">Mounting Flange</td>
                                        <td class="p-4">S355 Steel</td>
                                        <td class="p-4">500 x 500 x 25mm</td>
                                        <td class="p-4">HD Plasma Cutting → Drilling → CNC Machining → Grinding</td>
                                        <td class="p-4">
                                            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">
                                                ✅ Completed
                                            </span>
                                        </td>
                                        <td class="p-4 text-green-600">100% ✨</td>
                                    </tr>
                                    <tr class="border-b border-gray-100">
                                        <td class="p-4 font-semibold">Support Bracket</td>
                                        <td class="p-4">Stainless 316L</td>
                                        <td class="p-4">200 x 150 x 20mm</td>
                                        <td class="p-4">Gas Cutting → Lathe → Milling</td>
                                        <td class="p-4">
                                            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800">
                                                🔄 Milling in Progress
                                            </span>
                                        </td>
                                        <td class="p-4 text-yellow-600">85% 🎯</td>
                                    </tr>
                                    <tr>
                                        <td class="p-4 font-semibold">Final Assembly</td>
                                        <td class="p-4">-</td>
                                        <td class="p-4">-</td>
                                        <td class="p-4">Welding → Shot Blast → Paint → Packing</td>
                                        <td class="p-4">
                                            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-800">
                                                📅 Pending
                                            </span>
                                        </td>
                                        <td class="p-4 text-gray-500">0% ⏳</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Customer Email Generator -->
                    <div class="bg-gray-50 p-8 rounded-xl">
                        <h4 class="text-2xl font-bold mb-6 text-center professional-text">📧 AI-Powered Customer Communication</h4>
                        <div class="grid lg:grid-cols-2 gap-8">
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">👤 Customer Name</label>
                                    <input type="text" id="customer-name" value="Rolls-Royce Manufacturing" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">📋 Order Number</label>
                                    <input type="text" id="order-number" value="ECM-2025-0847" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">🔧 Component Name</label>
                                    <input type="text" id="component-name" value="Turbine Housing Assembly" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">📧 Email Type</label>
                                    <select id="email-type" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                        <option value="progress">📊 Progress Update</option>
                                        <option value="completion">✅ Production Complete</option>
                                        <option value="delay">⚠️ Delay Notification</option>
                                        <option value="quality">🎯 Quality Update</option>
                                        <option value="delivery">🚚 Delivery Confirmation</option>
                                    </select>
                                </div>
                            </div>
                            <div class="professional-card p-6">
                                <h5 class="text-xl font-bold text-gray-700 mb-4">📧 Email Preview</h5>
                                <div class="bg-white p-4 rounded-lg text-black text-sm max-h-64 overflow-y-auto border">
                                    <div class="font-bold mb-2">Subject: Turbine Housing Assembly - Production Update (75% Complete)</div>
                                    <div class="space-y-2">
                                        <p>Dear Rolls-Royce Manufacturing Team,</p>
                                        <p>Excellent progress on Order #ECM-2025-0847! Your Turbine Housing Assembly is 75% complete and on track for delivery in 2 days.</p>
                                        <p><strong>Current Status:</strong></p>
                                        <p>✅ Housing Shell: Completed (Inconel 718 processing)</p>
                                        <p>✅ Mounting Flange: Completed (Precision machining)</p>
                                        <p>🔄 Support Bracket: Milling in progress (85% complete)</p>
                                        <p>📅 Final Assembly: Scheduled for 19/06</p>
                                        <p>Quality checks passed at each stage. Ready for collection on 20/06/2025.</p>
                                        <p>Best regards,<br>ECAM Engineering Team</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <button id="generate-customer-email-btn" class="professional-button w-full mt-8 text-xl">
                            📧 Generate Professional Customer Email
                        </button>

                                <!-- Live Dashboard Preview -->
                        <div class="mb-16">
                            <div class="professional-card p-8 bg-gray-900 text-white">
                                <h3 class="text-3xl font-bold text-center mb-8">📈 Live Production Dashboard Preview</h3>
                                <div class="grid lg:grid-cols-3 gap-6 dashboard-preview">
                                    <div class="bg-gray-800 p-6 rounded-xl border border-gray-700">
                                        <div class="text-green-400 text-xl mb-4 flex items-center">
                                            <span class="mr-2">🟢</span> Machine Health Monitor
                                        </div>
                                        <div class="health-meter mb-4">
                                            <div class="flex justify-between text-sm mb-2">
                                                <span class="text-gray-300">Overall Equipment Health</span>
                                                <span class="text-green-400">94.7%</span>
                                            </div>
                                            <div class="w-full bg-gray-700 rounded-full h-3">
                                                <div class="bg-green-400 h-3 rounded-full animate-pulse" style="width: 94.7%"></div>
                                            </div>
                                        </div>
                                        <div class="space-y-2 text-sm">
                                            <div class="flex justify-between">
                                                <span class="text-gray-400">CNC Machines:</span>
                                                <span class="text-green-400">98.2%</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-400">Welding Systems:</span>
                                                <span class="text-green-400">96.1%</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-400">Cutting Equipment:</span>
                                                <span class="text-yellow-400">89.4%</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-800 p-6 rounded-xl border border-gray-700">
                                        <div class="text-blue-400 text-xl mb-4 flex items-center">
                                            <span class="mr-2">📦</span> Order Progress Tracking
                                        </div>
                                        <div class="progress-bars space-y-4">
                                            <div>
                                                <div class="flex justify-between text-sm mb-1">
                                                    <span class="text-gray-300">Order #ECM-2025-0847</span>
                                                    <span class="text-blue-400">75%</span>
                                                </div>
                                                <div class="w-full bg-gray-700 rounded-full h-2">
                                                    <div class="bg-blue-400 h-2 rounded-full animate-pulse" style="width: 75%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between text-sm mb-1">
                                                    <span class="text-gray-300">Order #ECM-2025-0848</span>
                                                    <span class="text-green-400">92%</span>
                                                </div>
                                                <div class="w-full bg-gray-700 rounded-full h-2">
                                                    <div class="bg-green-400 h-2 rounded-full" style="width: 92%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between text-sm mb-1">
                                                    <span class="text-gray-300">Order #ECM-2025-0849</span>
                                                    <span class="text-orange-400">45%</span>
                                                </div>
                                                <div class="w-full bg-gray-700 rounded-full h-2">
                                                    <div class="bg-orange-400 h-2 rounded-full" style="width: 45%"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mt-4 text-center">
                                            <div class="text-2xl font-bold text-blue-400">147</div>
                                            <div class="text-sm text-gray-400">Active Orders</div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-800 p-6 rounded-xl border border-gray-700">
                                        <div class="text-purple-400 text-xl mb-4 flex items-center">
                                            <span class="mr-2">🌡️</span> Sensor Network Status
                                        </div>
                                        <div class="sensor-grid grid grid-cols-3 gap-2 mb-4">
                                            <div class="w-8 h-8 bg-green-500 rounded-full animate-pulse"></div>
                                            <div class="w-8 h-8 bg-green-500 rounded-full animate-pulse" style="animation-delay: 0.2s;"></div>
                                            <div class="w-8 h-8 bg-green-500 rounded-full animate-pulse" style="animation-delay: 0.4s;"></div>
                                            <div class="w-8 h-8 bg-green-500 rounded-full animate-pulse" style="animation-delay: 0.6s;"></div>
                                            <div class="w-8 h-8 bg-yellow-500 rounded-full animate-pulse" style="animation-delay: 0.8s;"></div>
                                            <div class="w-8 h-8 bg-green-500 rounded-full animate-pulse" style="animation-delay: 1s;"></div>
                                        </div>
                                        <div class="space-y-2 text-sm">
                                            <div class="flex justify-between">
                                                <span class="text-gray-400">Active Sensors:</span>
                                                <span class="text-green-400">67/68</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-400">Data Points/Min:</span>
                                                <span class="text-purple-400">2,847</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-400">Network Health:</span>
                                                <span class="text-green-400">99.2%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Implementation Roadmap -->
        <section id="implementation" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-5xl md:text-6xl font-black text-gray-900 mb-8">
                        🛣️ IMPLEMENTATION ROADMAP
                    </h2>
                    <p class="text-2xl text-gray-600 max-w-4xl mx-auto">
                        Structured 36-month delivery plan with clearly defined phases, milestones, and deliverables 
                        ensuring minimal operational disruption while maximizing early benefits
                    </p>
                </div>

                <!-- Interactive Timeline -->
                <div class="mb-16">
                    <div class="relative">
                        <div class="absolute left-0 top-1/2 w-full h-2 bg-gradient-to-r from-blue-500 via-purple-500 to-green-500 -translate-y-1/2 rounded-full"></div>
                        <div class="flex justify-between relative">
                            <div class="timeline-item text-center cursor-pointer active" data-phase="phase1">
                                <div class="timeline-dot w-16 h-16 rounded-full bg-blue-500 border-4 border-white mx-auto transition-all duration-300 shadow-xl flex items-center justify-center text-white font-bold text-xl">1</div>
                                <p class="timeline-title mt-4 font-bold text-blue-600 text-xl">Foundation</p>
                                <p class="text-sm text-gray-500">Months 1-12</p>
                            </div>
                            <div class="timeline-item text-center cursor-pointer" data-phase="phase2">
                                <div class="timeline-dot w-16 h-16 rounded-full bg-purple-500 border-4 border-white mx-auto transition-all duration-300 shadow-xl flex items-center justify-center text-white font-bold text-xl">2</div>
                                <p class="timeline-title mt-4 font-bold text-purple-600 text-xl">Advanced</p>
                                <p class="text-sm text-gray-500">Months 13-24</p>
                            </div>
                            <div class="timeline-item text-center cursor-pointer" data-phase="phase3">
                                <div class="timeline-dot w-16 h-16 rounded-full bg-green-500 border-4 border-white mx-auto transition-all duration-300 shadow-xl flex items-center justify-center text-white font-bold text-xl">3</div>
                                <p class="timeline-title mt-4 font-bold text-green-600 text-xl">Innovation</p>
                                <p class="text-sm text-gray-500">Months 25-36</p>
                            </div>
                        </div>
                    </div>

                    <!-- Phase Details -->
                    <div id="timeline-details" class="mt-16 professional-card p-8">
                        <div id="phase1" class="phase-content">
                            <div class="grid lg:grid-cols-2 gap-12 items-center">
                                <div class="fade-in-up">
                                    <h3 class="text-4xl font-bold text-blue-600 mb-6">🏗️ Phase 1: Foundation Development</h3>
                                    <p class="text-xl text-gray-700 mb-8">
                                        Establish the core infrastructure that will power your digital transformation journey
                                    </p>
                                    <div class="space-y-6">
                                        <div class="bg-blue-50 p-6 rounded-xl border-l-4 border-blue-500">
                                            <h4 class="font-bold text-blue-800 mb-2">🎯 MES Core Implementation</h4>
                                            <p class="text-blue-600">Deploy central manufacturing execution system with real-time monitoring</p>
                                        </div>
                                        <div class="bg-purple-50 p-6 rounded-xl border-l-4 border-purple-500">
                                            <h4 class="font-bold text-purple-800 mb-2">🌐 IoT Infrastructure</h4>
                                            <p class="text-purple-600">Install sensors and MTConnect agents across primary equipment</p>
                                        </div>
                                        <div class="bg-green-50 p-6 rounded-xl border-l-4 border-green-500">
                                            <h4 class="font-bold text-green-800 mb-2">🧠 AI Framework</h4>
                                            <p class="text-green-600">Establish machine learning infrastructure and model training</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="professional-card p-8">
                                    <h4 class="text-2xl font-bold mb-6 text-center">📊 Phase 1 Deliverables</h4>
                                    <div class="space-y-4">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                            <span>Real-time production dashboard</span>
                                        </div>
                                        <div class="flex items-center space-x-3">
                                            <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                            <span>15+ machines connected</span>
                                        </div>
                                        <div class="flex items-center space-x-3">
                                            <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                            <span>Predictive maintenance alerts</span>
                                        </div>
                                        <div class="flex items-center space-x-3">
                                            <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                            <span>Data collection systems</span>
                                        </div>
                                        <div class="flex items-center space-x-3">
                                            <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                            <span>AI model prototypes</span>
                                        </div>
                                    </div>
                                    <button data-phase-details="Phase 1: Foundation Development. Core MES implementation, IoT infrastructure deployment, AI framework establishment, and Datamile server configuration." class="generate-email-btn professional-button w-full mt-6">
                                        ✨ Generate Stakeholder Update
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Phase 2 and 3 content (hidden by default) -->
                        <div id="phase2" class="phase-content hidden">
                            <div class="grid lg:grid-cols-2 gap-12 items-center">
                                <div class="fade-in-up">
                                    <h3 class="text-4xl font-bold text-purple-600 mb-6">🚀 Phase 2: Advanced Capabilities</h3>
                                    <p class="text-xl text-gray-700 mb-8">
                                        Deploy advanced AI-powered features and customer-facing capabilities that will revolutionize 
                                        customer engagement and establish ECAM as the technology leader in precision manufacturing.
                                    </p>
                                    <div class="space-y-6">
                                        <div class="bg-purple-50 p-6 rounded-xl border-l-4 border-purple-500">
                                            <h4 class="font-bold text-purple-800 mb-2">🌐 Customer Portal Development</h4>
                                            <p class="text-purple-600">Launch comprehensive web-based platform with drawing upload, material selection, and real-time quotation generation capabilities</p>
                                        </div>
                                        <div class="bg-blue-50 p-6 rounded-xl border-l-4 border-blue-500">
                                            <h4 class="font-bold text-blue-800 mb-2">🔮 Predictive Maintenance Implementation</h4>
                                            <p class="text-blue-600">Deploy advanced ML algorithms for equipment health monitoring with 30-day failure prediction accuracy</p>
                                        </div>
                                        <div class="bg-green-50 p-6 rounded-xl border-l-4 border-green-500">
                                            <h4 class="font-bold text-green-800 mb-2">📐 CAD Integration & Automation</h4>
                                            <p class="text-green-600">Implement automated drawing analysis, computer vision for specification extraction, and simplified CAD tools</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="scale-in">
                                    <div class="professional-card p-8">
                                        <h4 class="text-2xl font-bold mb-6 text-center text-purple-600">📊 Phase 2 Achievements</h4>
                                        <div class="space-y-4">
                                            <div class="flex items-center space-x-3">
                                                <div class="w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                                <span>Interactive customer portal with instant quotations</span>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <div class="w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                                <span>AI-powered drawing analysis and interpretation</span>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <div class="w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                                <span>Predictive maintenance across all equipment</span>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <div class="w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                                <span>Three-site integration completed</span>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <div class="w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                                <span>Customer self-service capabilities</span>
                                            </div>
                                        </div>
                                        
                                        <!-- Impact Metrics -->
                                        <div class="mt-6 space-y-4">
                                            <div class="bg-purple-50 p-4 rounded-lg">
                                                <div class="font-bold text-purple-800">90% Quote Time Reduction</div>
                                                <div class="text-sm text-purple-600">From days to minutes transformation</div>
                                            </div>
                                            <div class="bg-blue-50 p-4 rounded-lg">
                                                <div class="font-bold text-blue-800">£200K Annual Savings</div>
                                                <div class="text-sm text-blue-600">Predictive maintenance impact</div>
                                            </div>
                                            <div class="bg-green-50 p-4 rounded-lg">
                                                <div class="font-bold text-green-800">25-30% Quote Volume Increase</div>
                                                <div class="text-sm text-green-600">Enhanced customer engagement</div>
                                            </div>
                                        </div>
                                        
                                        <button data-phase-details="Phase 2: Advanced Capabilities. Customer portal launch with instant quotation engine, predictive maintenance deployment with 95% accuracy, CAD integration with computer vision, and extended three-site connectivity for comprehensive manufacturing execution." class="generate-email-btn professional-button w-full mt-6">
                                            ✨ Generate Stakeholder Update
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="phase3" class="phase-content hidden">
                            <div class="grid lg:grid-cols-2 gap-12 items-center">
                                <div class="fade-in-up">
                                    <h3 class="text-4xl font-bold text-green-600 mb-6">🧪 Phase 3: Innovation Leadership</h3>
                                    <p class="text-xl text-gray-700 mb-8">
                                        Establish ECAM as the undisputed leader in AI-driven manufacturing innovation through 
                                        cutting-edge generative AI, business intelligence, and technology licensing opportunities.
                                    </p>
                                    <div class="space-y-6">
                                        <div class="bg-green-50 p-6 rounded-xl border-l-4 border-green-500">
                                            <h4 class="font-bold text-green-800 mb-2">🤖 Generative AI Integration</h4>
                                            <p class="text-green-600">Deploy revolutionary text-to-CAD conversion, natural language processing, and advanced computer vision for drawing interpretation</p>
                                        </div>
                                        <div class="bg-blue-50 p-6 rounded-xl border-l-4 border-blue-500">
                                            <h4 class="font-bold text-blue-800 mb-2">📊 Marketing Intelligence Platform</h4>
                                            <p class="text-blue-600">Implement comprehensive CRM, market analysis tools, and business intelligence dashboards for strategic decision support</p>
                                        </div>
                                        <div class="bg-purple-50 p-6 rounded-xl border-l-4 border-purple-500">
                                            <h4 class="font-bold text-purple-800 mb-2">💰 Technology Licensing & Scaling</h4>
                                            <p class="text-purple-600">Optimize platform performance, prepare for licensing opportunities, and establish foundation for market expansion</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="scale-in">
                                    <div class="professional-card p-8">
                                        <h4 class="text-2xl font-bold mb-6 text-center text-green-600">🏆 Phase 3 Innovation Outcomes</h4>
                                        <div class="space-y-4">
                                            <div class="flex items-center space-x-3">
                                                <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                                <span>Revolutionary text-to-CAD generation capabilities</span>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                                <span>Natural language customer interaction systems</span>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                                <span>Comprehensive business intelligence platform</span>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                                <span>Proprietary technology licensing framework</span>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                                                <span>Market expansion readiness achieved</span>
                                            </div>
                                        </div>
                                        
                                        <!-- Innovation Impact -->
                                        <div class="mt-6 space-y-4">
                                            <div class="bg-green-50 p-4 rounded-lg">
                                                <div class="font-bold text-green-800">Industry Leadership Established</div>
                                                <div class="text-sm text-green-600">Technology innovation catalyst position</div>
                                            </div>
                                            <div class="bg-blue-50 p-4 rounded-lg">
                                                <div class="font-bold text-blue-800">£500K+ Annual Licensing Revenue</div>
                                                <div class="text-sm text-blue-600">Passive income from IP monetization</div>
                                            </div>
                                            <div class="bg-purple-50 p-4 rounded-lg">
                                                <div class="font-bold text-purple-800">12+ Patents & IP Assets</div>
                                                <div class="text-sm text-purple-600">Valuable intellectual property portfolio</div>
                                            </div>
                                        </div>
                                        
                                        <!-- Future Opportunities -->
                                        <div class="mt-6 p-4 bg-gradient-to-r from-green-100 to-blue-100 rounded-lg">
                                            <h5 class="font-bold text-gray-800 mb-2">🚀 Future Opportunities</h5>
                                            <ul class="text-sm text-gray-700 space-y-1">
                                                <li>• Expansion into adjacent manufacturing sectors</li>
                                                <li>• International licensing partnerships</li>
                                                <li>• Academic collaboration networks</li>
                                                <li>• Government innovation showcase programs</li>
                                            </ul>
                                        </div>
                                        
                                        <button data-phase-details="Phase 3: Innovation Leadership. Revolutionary generative AI integration with text-to-CAD conversion, comprehensive marketing intelligence platform deployment, technology licensing framework establishment, and market expansion preparation for industry transformation leadership." class="generate-email-btn professional-button w-full mt-6">
                                            ✨ Generate Stakeholder Update
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Overall Project Impact Summary -->
                        <div class="mt-16 bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl p-8">
                            <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">📈 Comprehensive Project Impact</h3>
                            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <span class="text-white font-bold text-xl">£</span>
                                    </div>
                                    <h4 class="font-bold text-gray-800 mb-2">Financial Growth</h4>
                                    <p class="text-sm text-gray-600">£4.4M → £10M revenue transformation over 5 years</p>
                                </div>
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <span class="text-white font-bold text-xl">⚡</span>
                                    </div>
                                    <h4 class="font-bold text-gray-800 mb-2">Operational Excellence</h4>
                                    <p class="text-sm text-gray-600">90% quotation time reduction, 25% maintenance savings</p>
                                </div>
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-purple-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <span class="text-white font-bold text-xl">🎯</span>
                                    </div>
                                    <h4 class="font-bold text-gray-800 mb-2">Market Leadership</h4>
                                    <p class="text-sm text-gray-600">Technology innovation catalyst in precision manufacturing</p>
                                </div>
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-orange-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <span class="text-white font-bold text-xl">🚀</span>
                                    </div>
                                    <h4 class="font-bold text-gray-800 mb-2">Future Ready</h4>
                                    <p class="text-sm text-gray-600">Scalable platform for expansion and licensing opportunities</p>
                                </div>
                            </div>
                            
                            <!-- Key Success Metrics -->
                            <div class="mt-8 bg-white rounded-xl p-6">
                                <h4 class="text-xl font-bold text-center mb-6 text-gray-800">🎯 Key Success Metrics</h4>
                                <div class="grid md:grid-cols-3 gap-6">
                                    <div class="text-center">
                                        <div class="text-3xl font-bold text-blue-600 mb-2">95%</div>
                                        <div class="text-sm text-gray-600">Predictive maintenance accuracy</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-3xl font-bold text-green-600 mb-2">350%</div>
                                        <div class="text-sm text-gray-600">Return on investment</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-3xl font-bold text-purple-600 mb-2">99.9%</div>
                                        <div class="text-sm text-gray-600">System uptime guarantee</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Project Timeline Gantt Chart Section -->
        <section class="py-20 bg-gray-50">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-5xl md:text-6xl font-black text-gray-900 mb-8">
                        📅 PROJECT PLANNED TIMELINE (GANTT CHART)
                    </h2>
                    <p class="text-2xl text-gray-600 max-w-4xl mx-auto">
                        This 36-month Knowledge Transfer Partnership (KTP) project is structured in three major phases, with all key deliverables and dependencies mapped. The timeline below reflects the coordinated work of <strong>two full-time KTP Associates</strong> alongside the ECAM and BCU teams.
                    </p>
                </div>

                <!-- Gantt Chart Image Display - CORRECTED IMPLEMENTATION -->
                <div class="mb-16">
                    <div class="professional-card p-8 bg-white rounded-2xl shadow-xl">
                        <h3 class="text-3xl font-bold text-center mb-8 professional-text">🗓️ Master Project Gantt Chart</h3>
                        
                        <!-- Gantt Chart Image with proper error handling -->
                        <div class="bg-gray-50 p-6 rounded-xl border-2 border-gray-200 mb-8">
                            <!-- Try PNG first -->
                            <img src="./assets/images/ganttchart.png">
                                alt="ECAM KTP Project Gantt Chart"
                                class="w-full h-auto rounded-lg shadow-md"
                                onerror="this.style.display='none'; document.getElementById('jpg-fallback').style.display='block';">
                            
                            <!-- JPG fallback -->
                            <img id="jpg-fallback" src="./assets/images/ganttchart.png">
                                alt="ECAM KTP Project Gantt Chart"
                                class="w-full h-auto rounded-lg shadow-md hidden"
                                onerror="this.style.display='none'; document.getElementById('text-fallback').style.display='block';">
                            
                            <!-- Text fallback if both image formats fail -->
                            <div id="text-fallback" class="hidden text-center p-12 bg-blue-100 rounded-lg">
                                <div class="text-6xl mb-4">📊</div>
                                <h4 class="text-2xl font-bold text-blue-800 mb-4">Project Gantt Chart</h4>
                                <p class="text-blue-600">36-month implementation timeline (Feb 2026 - Jan 2029)</p>
                                <p class="text-sm text-blue-500 mt-2">Three-phase delivery: Foundation → Advanced Capabilities → Innovation Leadership</p>
                            </div>
                        </div>
                        <section class="py-20 bg-gray-50">
                            <div class="container mx-auto px-6">
                                <h2 class="text-4xl font-bold text-center text-gray-900 mb-8">📆 Project Timeline: 36-Month Gantt View</h2>
                                <div class="overflow-x-auto professional-card p-6">
                                <img src="./assets/images/ktp_gantt_timeline.png"> alt="KTP Gantt Chart Timeline" class="w-full h-auto rounded-lg shadow-md">
                                <p class="text-sm text-center text-gray-600 mt-4">Milestones across development, deployment, training, and dissemination</p>
                                </div>
                            </div>
                        </section>

                        <!-- Note about the KTP Associates -->
                        <div class="text-center text-sm text-gray-500">
                            <strong>Note:</strong> This plan is delivered by <span class="text-blue-700 font-semibold">two KTP Associates</span> working in parallel across the 36-month timeline.
                        </div>

                        <!-- Phase Descriptions based on the actual Gantt chart image -->
                        <div class="mt-8">
                            <div class="space-y-6">
                                <div class="p-4 rounded-lg" style="background-color: #8AAE36; color: white;">
                                    <h4 class="font-bold text-xl">Phase 1: Foundation Development (Months 1-12)</h4>
                                    <p class="text-sm mt-2">MES Core Development, IoT Infrastructure, Machine Connectivity across 3 sites, AI Framework</p>
                                </div>
                                
                                <div class="p-4 rounded-lg" style="background-color: #8AAE36; color: white;">
                                    <h4 class="font-bold text-xl">Phase 2: Advanced Capabilities (Months 13-24)</h4>
                                    <p class="text-sm mt-2">Customer Portal, Predictive Maintenance, CAD Integration, Instant Quotation Engine</p>
                                </div>
                                
                                <div class="p-4 rounded-lg" style="background-color: #8AAE36; color: white;">
                                    <h4 class="font-bold text-xl">Phase 3: Innovation Leadership (Months 25-36)</h4>
                                    <p class="text-sm mt-2">Generative AI, Text-to-CAD, Business Intelligence, Technology Licensing Framework</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Timeline Summary Stats -->
                <div class="grid md:grid-cols-4 gap-6 mb-16">
                    <div class="text-center p-6 bg-blue-50 rounded-xl">
                        <div class="text-3xl font-bold text-blue-600 mb-2">36</div>
                        <div class="text-blue-800 font-semibold">Months Duration</div>
                        <div class="text-sm text-blue-600">Feb 2026 – Jan 2029</div>
                    </div>
                    <div class="text-center p-6 bg-green-50 rounded-xl">
                        <div class="text-3xl font-bold text-green-600 mb-2">3</div>
                        <div class="text-green-800 font-semibold">Major Phases</div>
                        <div class="text-sm text-green-600">Foundation, Advanced, Innovation</div>
                    </div>
                    <div class="text-center p-6 bg-purple-50 rounded-xl">
                        <div class="text-3xl font-bold text-purple-600 mb-2">2</div>
                        <div class="text-purple-800 font-semibold">KTP Associates</div>
                        <div class="text-sm text-purple-600">Full-time experts</div>
                    </div>
                    <div class="text-center p-6 bg-orange-50 rounded-xl">
                        <div class="text-3xl font-bold text-orange-600 mb-2">40+</div>
                        <div class="text-orange-800 font-semibold">Project Tasks</div>
                        <div class="text-sm text-orange-600">Across three phases</div>
                    </div>
                </div>
                
                <!-- Key Tasks from the actual Gantt chart -->
                <div class="professional-card p-8 mb-16">
                    <h3 class="text-3xl font-bold text-center mb-8 text-gray-900">📋 Key Project Activities</h3>
                    <div class="grid md:grid-cols-3 gap-8">
                        <!-- Phase 1 Activities -->
                        <div class="space-y-2">
                            <h4 class="text-xl font-bold text-blue-600 mb-4">Phase 1 Activities</h4>
                            <div class="flex items-center p-2 bg-red-50 rounded-lg">
                                <div class="w-3 h-3 bg-red-500 rounded-full mr-3"></div>
                                <span class="text-sm">Project Initiation & Setup</span>
                            </div>
                            <div class="flex items-center p-2 bg-orange-50 rounded-lg">
                                <div class="w-3 h-3 bg-orange-500 rounded-full mr-3"></div>
                                <span class="text-sm">KTA Onboarding & Training</span>
                            </div>
                            <div class="flex items-center p-2 bg-blue-50 rounded-lg">
                                <div class="w-3 h-3 bg-blue-500 rounded-full mr-3"></div>
                                <span class="text-sm">MES Core Development</span>
                            </div>
                            <div class="flex items-center p-2 bg-green-50 rounded-lg">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                <span class="text-sm">IoT Infrastructure Setup</span>
                            </div>
                            <div class="flex items-center p-2 bg-cyan-50 rounded-lg">
                                <div class="w-3 h-3 bg-cyan-500 rounded-full mr-3"></div>
                                <span class="text-sm">Machine Connectivity (3 Sites)</span>
                            </div>
                        </div>

                        <!-- Phase 2 Activities -->
                        <div class="space-y-2">
                            <h4 class="text-xl font-bold text-purple-600 mb-4">Phase 2 Activities</h4>
                            <div class="flex items-center p-2 bg-green-50 rounded-lg">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                <span class="text-sm">Customer Portal Design</span>
                            </div>
                            <div class="flex items-center p-2 bg-pink-50 rounded-lg">
                                <div class="w-3 h-3 bg-pink-500 rounded-full mr-3"></div>
                                <span class="text-sm">Predictive Maintenance Algorithms</span>
                            </div>
                            <div class="flex items-center p-2 bg-blue-50 rounded-lg">
                                <div class="w-3 h-3 bg-blue-500 rounded-full mr-3"></div>
                                <span class="text-sm">CAD Integration Module</span>
                            </div>
                            <div class="flex items-center p-2 bg-yellow-50 rounded-lg">
                                <div class="w-3 h-3 bg-yellow-500 rounded-full mr-3"></div>
                                <span class="text-sm">Drawing Upload System</span>
                            </div>
                            <div class="flex items-center p-2 bg-orange-50 rounded-lg">
                                <div class="w-3 h-3 bg-orange-500 rounded-full mr-3"></div>
                                <span class="text-sm">Instant Quotation Engine</span>
                            </div>
                        </div>

                        <!-- Phase 3 Activities -->
                        <div class="space-y-2">
                            <h4 class="text-xl font-bold text-green-600 mb-4">Phase 3 Activities</h4>
                            <div class="flex items-center p-2 bg-pink-50 rounded-lg">
                                <div class="w-3 h-3 bg-pink-500 rounded-full mr-3"></div>
                                <span class="text-sm">Generative AI Research</span>
                            </div>
                            <div class="flex items-center p-2 bg-blue-50 rounded-lg">
                                <div class="w-3 h-3 bg-blue-500 rounded-full mr-3"></div>
                                <span class="text-sm">Text-to-CAD Development</span>
                            </div>
                            <div class="flex items-center p-2 bg-green-50 rounded-lg">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                <span class="text-sm">Marketing Intelligence Platform</span>
                            </div>
                            <div class="flex items-center p-2 bg-orange-50 rounded-lg">
                                <div class="w-3 h-3 bg-orange-500 rounded-full mr-3"></div>
                                <span class="text-sm">Technology Licensing Framework</span>
                            </div>
                            <div class="flex items-center p-2 bg-yellow-50 rounded-lg">
                                <div class="w-3 h-3 bg-yellow-500 rounded-full mr-3"></div>
                                <span class="text-sm">Knowledge Transfer & Handover</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Partners Grid -->
                <div class="grid md:grid-cols-3 gap-12 max-w-6xl mx-auto">
                    <!-- ECAM Engineering -->
                    <div class="professional-card p-8 text-center hover:shadow-xl transition-all duration-300">
                        <div class="mb-6">
                            <img src="./assets/images/logos/ECAM_logo.jpg">
                                 alt="ECAM Engineering Limited Logo" 
                                 class="w-48 h-32 object-contain mx-auto bg-white rounded-lg shadow-md"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div class="hidden w-48 h-32 bg-blue-100 rounded-lg flex items-center justify-center mx-auto">
                                <span class="text-blue-600 font-bold text-lg">ECAM ENGINEERING</span>
                            </div>
                        </div>
                        <h3 class="text-2xl font-bold professional-text mb-4">ECAM ENGINEERING LIMITED</h3>
                        <p class="text-gray-600 mb-4">Industry Partner</p>
                        <p class="text-sm text-gray-500">
                            Leading precision engineering company specializing in advanced manufacturing solutions 
                            since 1967. Driving innovation in aerospace, defense, and industrial sectors.
                        </p>
                        <div class="mt-4 inline-flex items-center text-blue-600">
                            <span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
                            <span class="text-sm font-semibold">Primary Industry Partner</span>
                        </div>
                    </div>

                    <!-- Birmingham City University -->
                    <div class="professional-card p-8 text-center hover:shadow-xl transition-all duration-300">
                        <div class="mb-6">
                            <img src="./assets/images/logos/BCU_logo.jpg"> 
                                 alt="Birmingham City University Logo" 
                                 class="w-48 h-32 object-contain mx-auto bg-white rounded-lg shadow-md"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div class="hidden w-48 h-32 bg-purple-100 rounded-lg flex items-center justify-center mx-auto">
                                <span class="text-purple-600 font-bold text-lg">BCU</span>
                            </div>
                        </div>
                        <h3 class="text-2xl font-bold professional-text mb-4">BIRMINGHAM CITY UNIVERSITY</h3>
                        <p class="text-gray-600 mb-4">Academic Partner</p>
                        <p class="text-sm text-gray-500">
                            Leading research university providing cutting-edge expertise in AI, IoT, and digital 
                            manufacturing technologies. Delivering world-class research and innovation support.
                        </p>
                        <div class="mt-4 inline-flex items-center text-purple-600">
                            <span class="w-3 h-3 bg-purple-500 rounded-full mr-2"></span>
                            <span class="text-sm font-semibold">Knowledge Transfer Partner</span>
                        </div>
                    </div>

                    <!-- Innovate UK -->
                    <div class="professional-card p-8 text-center hover:shadow-xl transition-all duration-300">
                        <div class="mb-6">
                            <img src="./assets/images/logos/Innovate_logo.png"> 
                                 alt="Innovate UK Logo" 
                                 class="w-48 h-32 object-contain mx-auto bg-white rounded-lg shadow-md"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div class="hidden w-48 h-32 bg-red-100 rounded-lg flex items-center justify-center mx-auto">
                                <span class="text-red-600 font-bold text-lg">INNOVATE UK</span>
                            </div>
                        </div>
                        <h3 class="text-2xl font-bold professional-text mb-4">INNOVATE UK</h3>
                        <p class="text-gray-600 mb-4">Funding Partner</p>
                        <p class="text-sm text-gray-500">
                            UK's innovation agency driving productivity and economic growth by supporting businesses 
                            to develop and realize the potential of new ideas, including disruptive technologies.
                        </p>
                        <div class="mt-4 inline-flex items-center text-red-600">
                            <span class="w-3 h-3 bg-red-500 rounded-full mr-2"></span>
                            <span class="text-sm font-semibold">Strategic Funding Partner</span>
                        </div>
                    </div>
                </div>

                <!-- Partnership Benefits -->
                <div class="mt-16 professional-gradient rounded-xl p-8 text-white">
                    <h3 class="text-3xl font-bold text-center mb-8">Partnership Excellence</h3>
                    <div class="grid md:grid-cols-3 gap-8">
                        <div class="text-center">
                            <div class="text-4xl mb-4">🏭</div>
                            <h4 class="text-xl font-bold mb-2">Industry Expertise</h4>
                            <p class="text-blue-100">Deep manufacturing knowledge and real-world application experience</p>
                        </div>
                        <div class="text-center">
                            <div class="text-4xl mb-4">🎓</div>
                            <h4 class="text-xl font-bold mb-2">Academic Excellence</h4>
                            <p class="text-blue-100">Cutting-edge research and innovation methodologies</p>
                        </div>
                        <div class="text-center">
                            <div class="text-4xl mb-4">💰</div>
                            <h4 class="text-xl font-bold mb-2">Strategic Investment</h4>
                            <p class="text-blue-100">Government backing for transformational technology development</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <h2 class="text-4xl font-bold text-center text-gray-900 mb-8">🎯 KTP Objectives & Strategic Roles</h2>
                <div class="grid md:grid-cols-2 gap-8">
                <div class="professional-card p-6">
                    <h3 class="text-xl font-bold mb-4 text-blue-800">SMART Objectives</h3>
                    <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
                    <li>Develop and deploy a robust MES-IoT platform integrated with AI capabilities by month 24</li>
                    <li>Reduce ECAM's machine downtime by 75% and improve quotation turnaround by 90%</li>
                    <li>Deliver real-time manufacturing intelligence across three factory floors</li>
                    <li>Achieve at least two academic publications and open-source modules by project end</li>
                    </ul>
                </div>
                <div class="professional-card p-6">
                    <h3 class="text-xl font-bold mb-4 text-green-800">KTP Key Roles</h3>
                    <ul class="list-inside text-sm text-gray-700 space-y-2">
                    <li><strong>Associate 1 (IoT/AI Engineer):</strong> Sensor integration, data pipelines, ML model development</li>
                    <li><strong>Associate 2 (Computing):</strong> Full-stack development, dashboard, API, infrastructure</li>
                    <li><strong>Academic Supervisor:</strong> Methodology, technical mentorship, research validation</li>
                    <li><strong>Company Supervisor:</strong> Project execution, resource coordination, adoption</li>
                    </ul>
                </div>
                </div>
            </div>
        </section>

        <!-- ⚠️ Risk Management Section -->
        <section class="py-20 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="text-4xl font-bold text-center text-gray-900 mb-8">⚠️ Risk Assessment & Mitigation Strategy</h2>
            <div class="overflow-x-auto professional-card p-6">
            <table class="w-full text-sm text-left border border-gray-300">
                <thead class="bg-gray-100">
                <tr>
                    <th class="p-3 border">Risk</th>
                    <th class="p-3 border">Impact</th>
                    <th class="p-3 border">Likelihood</th>
                    <th class="p-3 border">Mitigation</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td class="p-3 border">Sensor/MCU failure</td>
                    <td class="p-3 border">Medium</td>
                    <td class="p-3 border">Medium</td>
                    <td class="p-3 border">Spare kits and fallback logging via Flask</td>
                </tr>
                <tr>
                    <td class="p-3 border">Associate departure</td>
                    <td class="p-3 border">High</td>
                    <td class="p-3 border">Medium</td>
                    <td class="p-3 border">University-backed contingency hiring + shadow onboarding</td>
                </tr>
                <tr>
                    <td class="p-3 border">Data security breach</td>
                    <td class="p-3 border">High</td>
                    <td class="p-3 border">Low</td>
                    <td class="p-3 border">Cyber Essentials, network segmentation, AI logs monitoring</td>
                </tr>
                </tbody>
            </table>
            </div>
        </div>
        </section>
        
        <!-- 💷 Updated Funding & Cost Allocation Section -->
        <section class="py-20 bg-gray-50">
        <div class="container mx-auto px-6">
            <h2 class="text-4xl font-bold text-center text-gray-900 mb-8">💷 KTP Total Funding & Cost Allocation</h2>
            <div class="professional-card p-6">
            <table class="w-full text-sm text-left border border-gray-300">
                <thead class="bg-gray-100">
                <tr>
                    <th class="p-3 border">Cost Category</th>
                    <th class="p-3 border">ECAM Contribution (33%)</th>
                    <th class="p-3 border">Innovate UK (67%)</th>
                    <th class="p-3 border">Total (£)</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td class="p-3 border">Associate Salaries (2 × £38,000 × 3)</td>
                    <td class="p-3 border">£75,240</td>
                    <td class="p-3 border">£152,760</td>
                    <td class="p-3 border">£228,000</td>
                </tr>
                <tr>
                    <td class="p-3 border">Associate Support (2 × £1,500 × 36)</td>
                    <td class="p-3 border">£35,640</td>
                    <td class="p-3 border">£72,360</td>
                    <td class="p-3 border">£108,000</td>
                </tr>
                <tr>
                    <td class="p-3 border">Personal Development (£6,000 × 2)</td>
                    <td class="p-3 border">£3,960</td>
                    <td class="p-3 border">£8,040</td>
                    <td class="p-3 border">£12,000</td>
                </tr>
                <tr>
                    <td class="p-3 border">Consumables (£2,000 × 2)</td>
                    <td class="p-3 border">£1,320</td>
                    <td class="p-3 border">£2,680</td>
                    <td class="p-3 border">£4,000</td>
                </tr>
                <tr>
                    <td class="p-3 border">Travel & Dissemination</td>
                    <td class="p-3 border">£3,300</td>
                    <td class="p-3 border">£6,700</td>
                    <td class="p-3 border">£10,000</td>
                </tr>
                <tr>
                    <td class="p-3 border">Initial Computing Setup (one-time)</td>
                    <td class="p-3 border">£5,000</td>
                    <td class="p-3 border">—</td>
                    <td class="p-3 border">£5,000</td>
                </tr>
                <tr class="font-bold bg-green-50">
                    <td class="p-3 border">Total</td>
                    <td class="p-3 border">£124,460</td>
                    <td class="p-3 border">£242,540</td>
                    <td class="p-3 border">£367,000</td>
                </tr>
                </tbody>
            </table>
            </div>
        </div>
        </section>

        /* <!-- ♻️ Sustainability Strategy -->
        <section class="py-20 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="text-4xl font-bold text-center text-gray-900 mb-8">♻️ Sustainability & Scalability Strategy</h2>
            <div class="professional-card p-6">
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
                <li>Associates will train internal ECAM staff in year 3 to ensure knowledge retention</li>
                <li>All systems built using open standards and scalable cloud-native architecture</li>
                <li>ECAM will adopt internal roles to maintain, extend, and commercialize FlaskDatamile+AI post-KTP</li>
                <li>Sensor network and real-time dashboard will be repurposable across multiple sites</li>
            </ul>
            </div>
        </div>
        </section> */

        <!-- 🎓 Academic Collaboration -->
        <section class="py-20 bg-gray-50">
        <div class="container mx-auto px-6">
            <h2 class="text-4xl font-bold text-center text-gray-900 mb-8">🎓 Academic Collaboration & Knowledge Exchange</h2>
            <div class="grid md:grid-cols-2 gap-8">
            <div class="professional-card p-6">
                <h3 class="text-xl font-bold text-blue-700 mb-4">Academic Contributions</h3>
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
                <li>Monthly academic review boards</li>
                <li>University lab usage for simulation and AI testing</li>
                <li>Three co-authored papers and one conference presentation planned</li>
                </ul>
            </div>
            <div class="professional-card p-6">
                <h3 class="text-xl font-bold text-green-700 mb-4">Knowledge Dissemination</h3>
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
                <li>Workshops with local manufacturers</li>
                <li>Public webinars and technical documentation</li>
                <li>IP agreement established for commercial tools</li>
                </ul>
            </div>
            </div>
        </div>
        </section>

        <!-- Industry Validation Carousel -->
        <section class="py-20 bg-gray-50">
            <div class="container mx-auto px-6">
                <div class="professional-card p-8 bg-white">
                    <h3 class="text-3xl font-bold text-center mb-8">🏆 Industry Validation & Success Stories</h3>
                    <div class="testimonial-carousel max-w-4xl mx-auto">
                        <div class="grid md:grid-cols-2 gap-8">
                            <div class="testimonial bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl border-l-4 border-blue-500">
                                <div class="flex items-center mb-4">
                                    <div class="logo w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-2xl mr-4">🏭</div>
                                    <div>
                                        <div class="font-bold text-blue-800">Tinsley Bridge Engineering</div>
                                        <div class="text-sm text-blue-600">Sheffield, UK - Heavy Forging</div>
                                    </div>
                                </div>
                                <blockquote class="text-gray-700 italic mb-4 text-lg">
                                    "ECAM's IoT retrofit approach reduced our unplanned downtime by 28% within just 6 months. 
                                    The predictive maintenance system has saved us £142,000 annually in maintenance costs alone."
                                </blockquote>
                                <div class="grid grid-cols-2 gap-4 text-center">
                                    <div class="bg-white p-3 rounded-lg">
                                        <div class="text-2xl font-bold text-green-600">28%</div>
                                        <div class="text-xs text-gray-600">Downtime Reduction</div>
                                    </div>
                                    <div class="bg-white p-3 rounded-lg">
                                        <div class="text-2xl font-bold text-blue-600">£142K</div>
                                        <div class="text-xs text-gray-600">Annual Savings</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="testimonial bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-xl border-l-4 border-green-500">
                                <div class="flex items-center mb-4">
                                    <div class="logo w-16 h-16 bg-green-500 rounded-full flex items-center justify-center text-white text-2xl mr-4">⚙️</div>
                                    <div>
                                        <div class="font-bold text-green-800">Vishay Intertechnology</div>
                                        <div class="text-sm text-green-600">Global Semiconductor Manufacturing</div>
                                    </div>
                                </div>
                                <blockquote class="text-gray-700 italic mb-4 text-lg">
                                    "The MTConnect integration across our 23 CNC machines delivered a 19% OEE improvement 
                                    and 63% faster work order reconciliation. Game-changing technology implementation."
                                </blockquote>
                                <div class="grid grid-cols-2 gap-4 text-center">
                                    <div class="bg-white p-3 rounded-lg">
                                        <div class="text-2xl font-bold text-green-600">19%</div>
                                        <div class="text-xs text-gray-600">OEE Improvement</div>
                                    </div>
                                    <div class="bg-white p-3 rounded-lg">
                                        <div class="text-2xl font-bold text-purple-600">63%</div>
                                        <div class="text-xs text-gray-600">Faster Processing</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-8 text-center">
                            <div class="inline-flex items-center bg-gradient-to-r from-blue-600 to-green-600 text-white px-8 py-4 rounded-full font-bold">
                                🎯 Proven Technology • Measurable Results • Industry-Leading ROI
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Download Section -->
        <section class="py-20 bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 text-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-5xl md:text-6xl font-black text-white mb-8">
                        📄 PROJECT DOCUMENTATION
                    </h2>
                    <p class="text-2xl text-blue-200 max-w-4xl mx-auto">
                        Access comprehensive project documentation and save this presentation for future reference. 
                        Download the complete KTP proposal or export this interactive presentation.
                    </p>
                </div>

                <div class="grid lg:grid-cols-2 gap-12 max-w-6xl mx-auto">
                    <!-- Detailed Proposal Download -->
                    <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8 text-center hover:bg-white/20 transition-all duration-300 group">
                        <div class="mb-6">
                            <div class="w-20 h-20 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                                <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                            </div>
                            <h3 class="text-3xl font-bold mb-4">Complete KTP Proposal</h3>
                            <p class="text-blue-200 mb-8 text-lg">
                                Download the comprehensive 36-month project proposal document with detailed technical specifications, 
                                implementation roadmap, financial projections, and partnership framework.
                            </p>
                        </div>
                        
                        <div class="space-y-4 mb-8">
                            <div class="flex items-center justify-center space-x-4 text-sm">
                                <span class="bg-blue-500/30 px-3 py-1 rounded-full">📊 36-Month Timeline</span>
                                <span class="bg-green-500/30 px-3 py-1 rounded-full">💰 £80K Investment</span>
                            </div>
                            <div class="flex items-center justify-center space-x-4 text-sm">
                                <span class="bg-purple-500/30 px-3 py-1 rounded-full">🎯 Technical Specs</span>
                                <span class="bg-orange-500/30 px-3 py-1 rounded-full">📈 ROI Analysis</span>
                            </div>
                        </div>

                        <button id="download-proposal-btn" class="inline-flex items-center bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-xl text-xl transition-all duration-300 transform hover:scale-105 shadow-xl">
                            <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                            </svg>
                            Click Here for Detailed Proposal
                        </button>
                        
                        <div class="mt-4 text-sm text-blue-300">
                            📄 Microsoft Word Document • 45+ Pages • Complete Technical Specification
                        </div>
                    </div>

                    <!-- Presentation PDF Download -->
                    <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8 text-center hover:bg-white/20 transition-all duration-300 group">
                        <div class="mb-6">
                            <div class="w-20 h-20 bg-red-600 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                                <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                                </svg>
                            </div>
                            <h3 class="text-3xl font-bold mb-4">Interactive Presentation</h3>
                            <p class="text-blue-200 mb-8 text-lg">
                                Export this comprehensive interactive presentation as a PDF document. Includes all charts, 
                                graphics, timeline, and project details in a professional format perfect for sharing.
                            </p>
                        </div>
                        
                        <div class="space-y-4 mb-8">
                            <div class="flex items-center justify-center space-x-4 text-sm">
                                <span class="bg-red-500/30 px-3 py-1 rounded-full">📊 Interactive Charts</span>
                                <span class="bg-blue-500/30 px-3 py-1 rounded-full">📈 Gantt Timeline</span>
                            </div>
                            <div class="flex items-center justify-center space-x-4 text-sm">
                                <span class="bg-green-500/30 px-3 py-1 rounded-full">🎨 Professional Design</span>
                                <span class="bg-purple-500/30 px-3 py-1 rounded-full">📱 Print Optimized</span>
                            </div>
                        </div>

                        <button id="download-pdf-btn" class="inline-flex items-center bg-red-600 hover:bg-red-700 text-white font-bold py-4 px-8 rounded-xl text-xl transition-all duration-300 transform hover:scale-105 shadow-xl">
                            <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                            </svg>
                            Download this Presentation as PDF
                        </button>
                        
                        <div class="mt-4 text-sm text-blue-300">
                            📄 PDF Format • High Quality Graphics • Optimized for Printing & Sharing
                        </div>
                    </div>
                </div>

                <!-- Additional Information -->
                <div class="mt-16 bg-white/5 backdrop-blur-sm rounded-xl p-8 max-w-4xl mx-auto">
                    <h4 class="text-2xl font-bold text-center mb-6">📋 Document Information</h4>
                    <div class="grid md:grid-cols-2 gap-8 text-center">
                        <div>
                            <h5 class="text-xl font-semibold text-blue-300 mb-3">KTP Proposal Document</h5>
                            <ul class="text-sm text-blue-200 space-y-2">
                                <li>✅ Comprehensive project scope and objectives</li>
                                <li>✅ Detailed technical implementation plan</li>
                                <li>✅ Financial projections and ROI analysis</li>
                                <li>✅ Risk assessment and mitigation strategies</li>
                                <li>✅ Partnership framework and responsibilities</li>
                            </ul>
                        </div>
                        <div>
                            <h5 class="text-xl font-semibold text-red-300 mb-3">Presentation PDF</h5>
                            <ul class="text-sm text-blue-200 space-y-2">
                                <li>✅ Executive summary and key highlights</li>
                                <li>✅ Interactive charts and visualizations</li>
                                <li>✅ Project timeline and Gantt chart</li>
                                <li>✅ Financial impact analysis</li>
                                <li>✅ Implementation roadmap overview</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Transformation Visualization -->
        <section class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <div class="professional-card p-8 bg-gray-50">
                    <h3 class="text-3xl font-bold text-center mb-8">🔄 Digital Transformation Impact</h3>
                    
                    <div class="grid lg:grid-cols-2 gap-12 mb-8">
                        <div class="bg-red-50 p-6 rounded-xl border-l-4 border-red-500">
                            <div class="text-center mb-6">
                                <div class="w-16 h-16 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <span class="text-white text-2xl">📋</span>
                                </div>
                                <h4 class="text-2xl font-bold text-red-800">Current Manual Processes</h4>
                            </div>
                            <ul class="space-y-3">
                                <li class="flex items-center text-red-700">
                                    <span class="w-6 h-6 bg-red-200 rounded-full flex items-center justify-center mr-3 text-sm">❌</span>
                                    2-3 day quotation process
                                </li>
                                <li class="flex items-center text-red-700">
                                    <span class="w-6 h-6 bg-red-200 rounded-full flex items-center justify-center mr-3 text-sm">⚠️</span>
                                    21% unplanned downtime
                                </li>
                                <li class="flex items-center text-red-700">
                                    <span class="w-6 h-6 bg-red-200 rounded-full flex items-center justify-center mr-3 text-sm">📝</span>
                                    Manual quality checks & documentation
                                </li>
                                <li class="flex items-center text-red-700">
                                    <span class="w-6 h-6 bg-red-200 rounded-full flex items-center justify-center mr-3 text-sm">📞</span>
                                    Reactive customer communication
                                </li>
                                <li class="flex items-center text-red-700">
                                    <span class="w-6 h-6 bg-red-200 rounded-full flex items-center justify-center mr-3 text-sm">💸</span>
                                    Higher maintenance costs & Machine Failures
                                </li>
                            </ul>
                            <div class="mt-6 p-4 bg-red-100 rounded-lg">
                                <div class="text-red-800 font-bold">Annual Impact:</div>
                                <div class="text-red-700">Lost opportunities: £200K+</div>
                            </div>
                        </div>

                        <div class="bg-green-50 p-6 rounded-xl border-l-4 border-green-500">
                            <div class="text-center mb-6">
                                <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <span class="text-white text-2xl">🚀</span>
                                </div>
                                <h4 class="text-2xl font-bold text-green-800">AI-Driven Smart Operations</h4>
                            </div>
                            <ul class="space-y-3">
                                <li class="flex items-center text-green-700">
                                    <span class="w-6 h-6 bg-green-200 rounded-full flex items-center justify-center mr-3 text-sm">⚡</span>
                                    2-5 minute AI-powered quotations
                                </li>
                                <li class="flex items-center text-green-700">
                                    <span class="w-6 h-6 bg-green-200 rounded-full flex items-center justify-center mr-3 text-sm">🔮</span>
                                    Predictive maintenance alerts
                                </li>
                                <li class="flex items-center text-green-700">
                                    <span class="w-6 h-6 bg-green-200 rounded-full flex items-center justify-center mr-3 text-sm">🤖</span>
                                    Automated quality assurance & reporting
                                </li>
                                <li class="flex items-center text-green-700">
                                    <span class="w-6 h-6 bg-green-200 rounded-full flex items-center justify-center mr-3 text-sm">📱</span>
                                    Proactive customer updates
                                </li>
                                <li class="flex items-center text-green-700">
                                    <span class="w-6 h-6 bg-green-200 rounded-full flex items-center justify-center mr-3 text-sm">💰</span>
                                    25% maintenance cost reduction
                                </li>
                            </ul>
                            <div class="mt-6 p-4 bg-green-100 rounded-lg">
                                <div class="text-green-800 font-bold">Annual Benefit:</div>
                                <div class="text-green-700">Additional savings: £425K+</div>
                            </div>
                        </div>
                    </div>

                    <div class="text-center">
                        <div class="inline-flex items-center bg-gradient-to-r from-green-500 to-blue-500 text-white px-8 py-4 rounded-full font-bold text-xl">
                            🎯 350% ROI within 36 months
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- AI-Optimized Production Flow -->
        <section class="py-20 bg-gray-50">
            <div class="container mx-auto px-6">
                <div class="professional-card p-8 bg-white">
                    <h3 class="text-3xl font-bold text-center mb-8">🔄 AI-Optimized Production Flow</h3>
                    <div class="process-flow flex items-center justify-center flex-wrap gap-4 mb-8">
                        <div class="flow-step bg-blue-100 border-l-4 border-blue-500 p-4 rounded-lg text-center min-w-32">
                            <div class="text-2xl mb-2">📧</div>
                            <div class="font-bold text-blue-800">Order Received</div>
                            <div class="text-xs text-blue-600 mt-1">Customer portal</div>
                        </div>
                        <div class="flow-arrow text-2xl text-gray-400 animate-pulse">→</div>
                        <div class="flow-step bg-green-100 border-l-4 border-green-500 p-4 rounded-lg text-center min-w-32">
                            <div class="text-2xl mb-2">🤖</div>
                            <div class="font-bold text-green-800">AI Quotation</div>
                            <div class="text-xs text-green-600 mt-1">2-5 minutes</div>
                        </div>
                        <div class="flow-arrow text-2xl text-gray-400 animate-pulse" style="animation-delay: 0.5s;">→</div>
                        <div class="flow-step bg-purple-100 border-l-4 border-purple-500 p-4 rounded-lg text-center min-w-32">
                            <div class="text-2xl mb-2">📅</div>
                            <div class="font-bold text-purple-800">Smart Scheduling</div>
                            <div class="text-xs text-purple-600 mt-1">Optimized slots</div>
                        </div>
                        <div class="flow-arrow text-2xl text-gray-400 animate-pulse" style="animation-delay: 1s;">→</div>
                        <div class="flow-step bg-orange-100 border-l-4 border-orange-500 p-4 rounded-lg text-center min-w-32">
                            <div class="text-2xl mb-2">⚙️</div>
                            <div class="font-bold text-orange-800">Production</div>
                            <div class="text-xs text-orange-600 mt-1">Live tracking</div>
                        </div>
                        <div class="flow-arrow text-2xl text-gray-400 animate-pulse" style="animation-delay: 1.5s;">→</div>
                        <div class="flow-step bg-red-100 border-l-4 border-red-500 p-4 rounded-lg text-center min-w-32">
                            <div class="text-2xl mb-2">✅</div>
                            <div class="font-bold text-red-800">Quality Assurance</div>
                            <div class="text-xs text-red-600 mt-1">Automated checks</div>
                        </div>
                    </div>
                    
                    <div class="grid md:grid-cols-3 gap-6 mt-8">
                        <div class="text-center p-4 bg-blue-50 rounded-lg">
                            <div class="text-3xl font-bold text-blue-600 mb-2">90%</div>
                            <div class="text-blue-800 font-semibold">Faster Quotations</div>
                            <div class="text-sm text-blue-600">From days to minutes</div>
                        </div>
                        <div class="text-center p-4 bg-green-50 rounded-lg">
                            <div class="text-3xl font-bold text-green-600 mb-2">25%</div>
                            <div class="text-green-800 font-semibold">Efficiency Gain</div>
                            <div class="text-sm text-green-600">Through optimization</div>
                        </div>
                        <div class="text-center p-4 bg-purple-50 rounded-lg">
                            <div class="text-3xl font-bold text-purple-600 mb-2">100%</div>
                            <div class="text-purple-800 font-semibold">Process Visibility</div>
                            <div class="text-sm text-purple-600">Real-time tracking</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Professional Manufacturing ROI Calculator with Modal Integration -->
        <section class="py-20 bg-white" id="roi-calculator-section">
        <div class="container mx-auto px-6">
            <div class="professional-card p-8 bg-gradient-to-br from-green-50 to-blue-50 rounded-xl shadow-lg">
            <h3 class="text-3xl font-bold text-center mb-8">💸 Professional Manufacturing ROI Calculator</h3>
            
            <!-- Calculator Controls with Modal Triggers -->
            <div class="calculator-controls" style="text-align: center; margin: 20px 0;">
                <button type="button" class="about-trigger" onclick="openCalculatorModal()">
                <span>📖</span>
                About This Calculator
                </button>
                <button type="button" class="help-trigger" onclick="showCalculatorHelp(this)" title="Quick help">
                <span>❓</span>
                Help
                </button>
            </div>
            
            <!-- Enhanced Business Metrics Section -->
            <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-blue-500 mb-8">
                <h4 class="text-xl font-bold mb-4 text-gray-800">📊 Financial Parameters (Industry-Validated)</h4>
                <div class="grid md:grid-cols-4 gap-6">
                
                <!-- Operational Metrics -->
                <div class="space-y-4">
                    <h5 class="font-bold text-blue-600">🏭 Operational Metrics</h5>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Production Capacity (units/month)</label>
                    <input type="number" min="1000" max="50000" value="10000" step="100" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" id="productionCapacity">
                    <small class="text-gray-500">Maximum production capability</small>
                    </div>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Current Utilization (%)</label>
                    <input type="number" min="50" max="100" value="75" step="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" id="currentUtilization">
                    <small class="text-gray-500">Current capacity utilization</small>
                    </div>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Labor Force (FTE)</label>
                    <input type="number" min="5" max="200" value="35" step="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" id="laborForce">
                    <small class="text-gray-500">Full-time equivalent employees</small>
                    </div>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Average Wage Rate (£/hour)</label>
                    <input type="number" min="10" max="35" value="14.5" step="0.5" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" id="wageRate">
                    <small class="text-gray-500">Blended hourly rate</small>
                    </div>
                </div>

                <!-- Financial Metrics -->
                <div class="space-y-4">
                    <h5 class="font-bold text-green-600">💰 Financial Metrics</h5>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Annual Revenue (£M)</label>
                    <input type="number" min="0.5" max="50" value="3.2" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" id="annualRevenue">
                    <small class="text-gray-500">Current annual turnover</small>
                    </div>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Gross Margin (%)</label>
                    <input type="number" min="15" max="60" value="32" step="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" id="grossMargin">
                    <small class="text-gray-500">Revenue minus COGS</small>
                    </div>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">EBITDA Margin (%)</label>
                    <input type="number" min="5" max="40" value="18" step="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" id="ebitdaMargin">
                    <small class="text-gray-500">Operating profitability</small>
                    </div>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Working Capital (% of Revenue)</label>
                    <input type="number" min="5" max="25" value="12" step="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" id="workingCapital">
                    <small class="text-gray-500">Inventory + Receivables - Payables</small>
                    </div>
                </div>

                <!-- Cost Structure -->
                <div class="space-y-4">
                    <h5 class="font-bold text-purple-600">📊 Cost Structure</h5>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Material Costs (% of Revenue)</label>
                    <input type="number" min="25" max="65" value="45" step="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" id="materialCostRatio">
                    <small class="text-gray-500">Direct material expenses</small>
                    </div>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Energy Costs (% of Revenue)</label>
                    <input type="number" min="3" max="15" value="8" step="0.5" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" id="energyCostRatio">
                    <small class="text-gray-500">Electricity, gas, utilities</small>
                    </div>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Maintenance Costs (% of Revenue)</label>
                    <input type="number" min="2" max="12" value="6" step="0.5" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" id="maintenanceCostRatio">
                    <small class="text-gray-500">Equipment maintenance</small>
                    </div>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Quality Costs (% of Revenue)</label>
                    <input type="number" min="1" max="8" value="3" step="0.5" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" id="qualityCostRatio">
                    <small class="text-gray-500">Rework, scrap, inspection</small>
                    </div>
                </div>

                <!-- Investment & Risk Parameters -->
                <div class="space-y-4">
                    <h5 class="font-bold text-orange-600">🎯 Investment & Risk</h5>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Project Investment (£)</label>
                    <input type="number" min="100000" max="2000000" value="367000" step="10000" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500" id="projectInvestment">
                    <small class="text-gray-500">Total capital expenditure</small>
                    </div>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Discount Rate (%)</label>
                    <input type="number" min="5" max="20" value="12" step="0.5" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500" id="discountRate">
                    <small class="text-gray-500">Weighted average cost of capital</small>
                    </div>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Implementation Risk (%)</label>
                    <input type="number" min="0" max="30" value="15" step="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500" id="implementationRisk">
                    <small class="text-gray-500">Probability of delays/issues</small>
                    </div>
                    <div>
                    <label class="font-semibold text-gray-700 mb-2 block">Analysis Period (years)</label>
                    <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500" id="analysisPeriod">
                        <option value="3">3 Years</option>
                        <option value="5" selected>5 Years</option>
                        <option value="7">7 Years</option>
                        <option value="10">10 Years</option>
                    </select>
                    <small class="text-gray-500">Investment evaluation horizon</small>
                    </div>
                </div>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <!-- Improvement Parameters -->
                <div class="space-y-6">
                <h4 class="text-xl font-bold text-gray-800 mb-4">🚀 Improvement Targets</h4>
                <div>
                    <label class="font-bold text-gray-800 mb-2 block" for="efficiencyImprovement">Operational Efficiency Gain (%)</label>
                    <input type="range" min="5" max="40" value="20" step="1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" id="efficiencyImprovement">
                    <output id="efficiencyOutput" class="text-xl font-bold text-purple-600 block mt-2">20%</output>
                </div>
                <div>
                    <label class="font-bold text-gray-800 mb-2 block" for="downtimeReduction">Downtime Reduction (%)</label>
                    <input type="range" min="10" max="60" value="30" step="1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" id="downtimeReduction">
                    <output id="downtimeOutput" class="text-xl font-bold text-green-600 block mt-2">30%</output>
                </div>
                <div>
                    <label class="font-bold text-gray-800 mb-2 block" for="qualityImprovement">Quality Enhancement (%)</label>
                    <input type="range" min="5" max="50" value="25" step="1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" id="qualityImprovement">
                    <output id="qualityImprovementOutput" class="text-xl font-bold text-orange-600 block mt-2">25%</output>
                </div>
                <div>
                    <label class="font-bold text-gray-800 mb-2 block" for="marketPenetration">Market Penetration Increase (%)</label>
                    <input type="range" min="0" max="25" value="8" step="1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" id="marketPenetration">
                    <output id="marketPenetrationOutput" class="text-xl font-bold text-blue-600 block mt-2">8%</output>
                </div>
                </div>

                <!-- Enhanced Results Panel -->
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-green-500">
                <h4 class="text-xl font-bold mb-4 text-gray-800">💰 Professional Financial Analysis</h4>
                
                <!-- Key Metrics Grid -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="text-center p-3 bg-green-100 rounded-lg border-l-4 border-green-500">
                    <div class="font-bold text-green-800">NPV</div>
                    <div id="npvValue" class="text-xl font-bold text-green-600">£1.2M</div>
                    </div>
                    <div class="text-center p-3 bg-blue-100 rounded-lg border-l-4 border-blue-500">
                    <div class="font-bold text-blue-800">IRR</div>
                    <div id="irrValue" class="text-xl font-bold text-blue-600">45%</div>
                    </div>
                    <div class="text-center p-3 bg-purple-100 rounded-lg border-l-4 border-purple-500">
                    <div class="font-bold text-purple-800">Payback</div>
                    <div id="paybackValue" class="text-xl font-bold text-purple-600">2.1 years</div>
                    </div>
                    <div class="text-center p-3 bg-orange-100 rounded-lg border-l-4 border-orange-500">
                    <div class="font-bold text-orange-800">ROIC</div>
                    <div id="roicValue" class="text-xl font-bold text-orange-600">28%</div>
                    </div>
                </div>

                <!-- Detailed Benefits Breakdown -->
                <div class="space-y-3 mb-6">
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                    <span class="font-semibold">Annual Cost Savings</span>
                    <span id="annualSavings" class="font-bold text-green-600">£485K</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                    <span class="font-semibold">Revenue Enhancement</span>
                    <span id="revenueEnhancement" class="font-bold text-blue-600">£256K</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                    <span class="font-semibold">Working Capital Impact</span>
                    <span id="workingCapitalImpact" class="font-bold text-purple-600">£38K</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-green-100 rounded-lg border-l-4 border-green-500">
                    <span class="font-bold text-green-800">Total Annual Benefit</span>
                    <span id="totalAnnualBenefit" class="font-bold text-green-800">£779K</span>
                    </div>
                </div>

                <!-- Risk Assessment -->
                <div class="pt-4 border-t border-gray-200">
                    <h5 class="font-bold text-gray-800 mb-3">🎯 Risk-Adjusted Analysis</h5>
                    <div class="grid grid-cols-3 gap-4 text-sm">
                    <div class="text-center p-3 bg-green-50 rounded-lg">
                        <div class="font-bold text-green-600" id="bestCase">£1.8M</div>
                        <div class="text-gray-600">Best Case NPV</div>
                    </div>
                    <div class="text-center p-3 bg-yellow-50 rounded-lg">
                        <div class="font-bold text-yellow-600" id="expectedCase">£1.2M</div>
                        <div class="text-gray-600">Expected NPV</div>
                    </div>
                    <div class="text-center p-3 bg-red-50 rounded-lg">
                        <div class="font-bold text-red-600" id="worstCase">£0.6M</div>
                        <div class="text-gray-600">Worst Case NPV</div>
                    </div>
                    </div>
                </div>
                </div>
            </div>
            </div>
        </div>
        </section>

        <!-- Modal Dialog for Calculator Information -->
        <div id="calculatorModal" class="modal-overlay" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
        <div class="modal-container">
            <div class="modal-header">
            <h2 id="modalTitle" class="modal-title">
                <span class="modal-icon">📊</span>
                About This ROI Calculator
            </h2>
            <button type="button" class="modal-close" aria-label="Close modal" onclick="closeCalculatorModal()">
                <span aria-hidden="true">&times;</span>
            </button>
            </div>
            
            <div class="modal-body">
            <div class="modal-tabs">
                <button class="tab-button active" onclick="switchCalculatorTab('overview')">Overview</button>
                <button class="tab-button" onclick="switchCalculatorTab('formulas')">Formulas</button>
                <button class="tab-button" onclick="switchCalculatorTab('definitions')">Definitions</button>
                <button class="tab-button" onclick="switchCalculatorTab('references')">References</button>
            </div>
            
            <!-- Overview Tab -->
            <div id="overview" class="tab-content active">
                <h3>Professional Manufacturing ROI Calculator</h3>
                <p>This calculator provides investment-grade financial analysis for manufacturing efficiency projects using industry-validated methodologies and real-world operational data from ECAM Engineering's KTP project.</p>
                
                <div class="feature-grid">
                    <div class="feature-item">
                        <h4>🎯 NPV Analysis</h4>
                        <p>Net Present Value calculation using discounted cash flow methodology based on ECAM's £367,000 KTP investment</p>
                    </div>
                    <div class="feature-item">
                        <h4>📈 IRR Computation</h4>
                        <p>Internal Rate of Return using Newton-Raphson iterative method for precise financial modeling</p>
                    </div>
                    <div class="feature-item">
                        <h4>⚖️ Risk Assessment</h4>
                        <p>Monte Carlo-style sensitivity analysis with implementation risk factors specific to manufacturing projects</p>
                    </div>
                    <div class="feature-item">
                        <h4>🏭 Industry Validation</h4>
                        <p>Coefficients and assumptions based on UK manufacturing benchmarks and ECAM's operational data</p>
                    </div>
                </div>
            </div>
            
            <!-- Formulas Tab -->
            <div id="formulas" class="tab-content">
                <h3>Mathematical Formulas</h3>
                
                <div class="formula-section">
                    <h4>Net Present Value (NPV)</h4>
                    <div class="formula-box">
                        <code>NPV = Σ(CF_t / (1 + r)^t) - Initial Investment</code>
                        <code>Where: CF_t = Cash flow at time t, r = Discount rate (12% WACC)</code>
                    </div>
                    <p><strong>ECAM Application:</strong> £367,000 initial investment with projected £779K annual benefits</p>
                </div>
                
                <div class="formula-section">
                    <h4>Efficiency Savings Calculations</h4>
                    <div class="formula-box">
                        <code>Labor Savings = Labor Cost × Efficiency Gain × 0.7</code>
                        <code>Material Savings = Material Cost × min(Efficiency × 0.6 + Quality × 0.4, 0.35)</code>
                        <code>Energy Savings = Energy Cost × min(Efficiency × 0.5 + Downtime × 0.3, 0.25)</code>
                    </div>
                    <p><strong>Validation:</strong> Coefficients derived from ECAM's 74,886 minutes annual downtime analysis</p>
                </div>
                
                <div class="formula-section">
                    <h4>Revenue Enhancement Model</h4>
                    <div class="formula-box">
                        <code>Capacity Revenue = (Current Production × Efficiency Gain × 0.6) × Unit Price</code>
                        <code>Market Revenue = Current Revenue × Market Penetration × Market Absorption</code>
                        <code>Quality Premium = Current Revenue × Quality Improvement × 0.15</code>
                    </div>
                    <p><strong>Baseline:</strong> £3.2M current revenue with 20% efficiency improvement target</p>
                </div>
            </div>
            
            <!-- Definitions Tab -->
            <div id="definitions" class="tab-content">
                <h3>Key Terms & Definitions</h3>
                
                <div class="definition-list">
                    <div class="definition-item">
                        <h4>Net Present Value (NPV)</h4>
                        <p>The difference between present value of cash inflows and outflows over the project lifetime. ECAM's target: Positive NPV indicating profitable KTP investment.</p>
                    </div>
                    
                    <div class="definition-item">
                        <h4>Internal Rate of Return (IRR)</h4>
                        <p>The discount rate that makes NPV equal to zero. Manufacturing projects typically target 20-30% IRR for viability.</p>
                    </div>
                    
                    <div class="definition-item">
                        <h4>EBITDA Margin</h4>
                        <p>Earnings Before Interest, Taxes, Depreciation, and Amortization as percentage of revenue. ECAM baseline: 18% with improvement targets.</p>
                    </div>
                    
                    <div class="definition-item">
                        <h4>Working Capital Impact</h4>
                        <p>Change in inventory, receivables, and payables from operational improvements. Includes efficiency gains and revenue growth effects.</p>
                    </div>
                    
                    <div class="definition-item">
                        <h4>Implementation Risk</h4>
                        <p>Probability-weighted adjustment for project delays, technical challenges, and market volatility. Default: 15% for manufacturing automation projects.</p>
                    </div>
                </div>
            </div>
            
            <!-- References Tab -->
            <div id="references" class="tab-content">
                <h3>References & Validation Sources</h3>
                
                <div class="reference-section">
                    <h4>ECAM Engineering Data Sources</h4>
                    <ul>
                        <li>Operational analysis: 74,886 minutes annual downtime across 18 machines</li>
                        <li>Financial baseline: £3.2M annual revenue, 32% gross margin</li>
                        <li>Labor structure: 35 FTE at £14.50/hour average rate</li>
                        <li>KTP project scope: £367,000 total investment over 36 months</li>
                    </ul>
                </div>
                
                <div class="reference-section">
                    <h4>Industry Benchmarks</h4>
                    <ul>
                        <li>UK Manufacturing Technology Centre: Energy efficiency improvement ranges</li>
                        <li>Make UK (2024): Manufacturing cost structure analysis</li>
                        <li>McKinsey Global Institute: Industry 4.0 implementation studies</li>
                        <li>Innovate UK KTP: Success metrics and ROI validation</li>
                    </ul>
                </div>
                
                <div class="reference-section">
                    <h4>Financial Methodologies</h4>
                    <ul>
                        <li>CIMA Standards: Manufacturing investment appraisal guidelines</li>
                        <li>NPV/IRR calculations: Standard corporate finance methodologies</li>
                        <li>Risk assessment: Monte Carlo simulation principles</li>
                        <li>Working capital modeling: Manufacturing-specific approaches</li>
                    </ul>
                </div>
            </div>
        </div>
            
            <div class="modal-footer">
            <button type="button" class="btn-secondary" onclick="closeCalculatorModal()">Close</button>
            <button type="button" class="btn-primary" onclick="expandCalculatorInNewTab()">
                <span class="btn-icon">🔗</span>
                Expand in New Tab
            </button>
            </div>
        </div>
        </div>

        <!-- Popover for Quick Help -->
        <div id="calculatorPopover" class="popover" role="tooltip">
        <div class="popover-arrow"></div>
        <div class="popover-content">
            <h4>ROI Calculator Help</h4>
            <p>Adjust the improvement sliders to see real-time NPV, IRR, and payback calculations. Based on ECAM's actual operational data and KTP project parameters.</p>
        </div>
        </div>

    <!-- Professional CTA Buttons -->
    <div class="space-y-8">
        <!-- LinkedIn Follow & Website Visit Section -->
        <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
            <!-- LinkedIn Follow Section -->
            <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8 text-center hover:bg-white/20 transition-all duration-300">
                <div class="mb-6">
                    <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                    </div>
                    <h3 class="text-2xl font-bold mb-4">Follow Us on LinkedIn</h3>
                    <p class="text-blue-200 mb-6">
                        Stay updated with our latest innovations, project developments, and industry insights. 
                        Join our professional community and be part of the manufacturing revolution.
                    </p>
                </div>
                <a href="https://www.linkedin.com/company/ecam-engineering-limited/" 
                    target="_blank" 
                    rel="noopener noreferrer"
                    class="inline-flex items-center professional-button text-lg py-4 px-8 transform hover:scale-105">
                    <svg class="w-5 h-5 mr-3" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                    </svg>
                    Follow ECAM Engineering
                </a>
                <div class="mt-4 text-sm text-blue-300">
                    🚀 Join 500+ industry professionals following our journey
                </div>
            </div>

            <!-- Website Visit Section -->
            <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8 text-center hover:bg-white/20 transition-all duration-300">
                <div class="mb-6">
                    <div class="w-16 h-16 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9m0 9c-5 0-9-4-9-9s4-9 9-9"/>
                        </svg>
                    </div>
                    <h3 class="text-2xl font-bold mb-4">Visit Our Website</h3>
                    <p class="text-blue-200 mb-6">
                        Explore our comprehensive capabilities, view our project portfolio, and discover how 
                        ECAM Engineering delivers precision manufacturing excellence across multiple industries.
                    </p>
                </div>
                <a href="https://ecam.co.uk/" 
                    target="_blank" 
                    rel="noopener noreferrer"
                    class="inline-flex items-center bg-white text-blue-700 font-bold py-4 px-8 rounded-lg text-lg transition-all duration-300 transform hover:scale-105 hover:shadow-xl">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                    </svg>
                    Visit ecam.co.uk
                </a>
                <div class="mt-4 text-sm text-blue-300">
                    🏭 Discover 55+ years of manufacturing excellence
                </div>
            </div>
        </div>

        <!-- Additional Engagement Options -->
        <div class="bg-white/5 backdrop-blur-sm rounded-xl p-6 max-w-4xl mx-auto">
            <h4 class="text-xl font-bold text-center mb-4">Connect With Our Team</h4>
            <div class="grid md:grid-cols-3 gap-6 text-center">
                <div class="flex flex-col items-center">
                    <div class="w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center mb-3">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                        </svg>
                    </div>
                    <h5 class="font-semibold mb-2">Email Inquiries</h5>
                    <p class="text-sm text-blue-200">Direct project discussions and technical consultations</p>
                </div>
                <div class="flex flex-col items-center">
                    <div class="w-12 h-12 bg-green-500/20 rounded-lg flex items-center justify-center mb-3">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                        </svg>
                    </div>
                    <h5 class="font-semibold mb-2">Phone Support</h5>
                    <p class="text-sm text-blue-200">Immediate assistance and expert guidance available</p>
                </div>
                <div class="flex flex-col items-center">
                    <div class="w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center mb-3">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                    </div>
                    <h5 class="font-semibold mb-2">Facility Visits</h5>
                    <p class="text-sm text-blue-200">Schedule a tour of our state-of-the-art facilities</p>
                </div>
            </div>
        </div>

        <div class="text-center space-y-2">
            <div class="text-lg text-blue-200">
                Ready to experience the future of precision manufacturing?
            </div>
            <div class="text-sm text-blue-300">
                Join the digital transformation journey with ECAM Engineering Limited
            </div>
        </div>
    </div>


    <!-- Enhanced Modal -->
    <div id="email-modal" class="fixed inset-0 modal-backdrop z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] flex flex-col slide-in-right">
            <div class="p-6 border-b-2 border-gray-200 flex justify-between items-center professional-gradient text-white rounded-t-2xl">
                <h3 class="text-2xl font-bold">📧 AI-Generated Communication</h3>
                <button id="close-modal-btn" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
            </div>
            <div id="modal-content" class="p-8 overflow-y-auto flex-1">
                <div id="modal-loader" class="flex justify-center items-center h-48">
                    <div class="loading-bar w-64">
                        <div class="loading-progress"></div>
                    </div>
                </div>
                <div id="modal-text" class="whitespace-pre-wrap text-gray-700 text-lg leading-relaxed"></div>
            </div>
            <div class="p-6 border-t-2 border-gray-200 bg-gray-50 rounded-b-2xl flex justify-end space-x-4">
                <button id="copy-email-btn" class="professional-button">
                    📋 Copy to Clipboard
                </button>
                <button id="send-email-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold px-6 py-3 rounded-lg transition-all">
                    📧 Send Email
                </button>
                <button id="download-email-btn" class="bg-purple-600 hover:bg-purple-700 text-white font-bold px-6 py-3 rounded-lg transition-all">
                    💾 Download PDF
                </button>
            </div>
        </div>
    </div>

    <!-- Enhanced JavaScript with API Integration -->
    <ul id="mobileMenu"
        class="fixed inset-0 bg-gray-900/95 text-center pt-24
            space-y-8 text-2xl font-semibold hidden">
        <li><a href="index.html">Home</a></li>
        <li><a href="ai-iot-project.html">AI Project</a></li>
        <li><a href="marketing-project.html">Marketing Project</a></li>
    </ul>

<script>
const btn   = document.getElementById('menuBtn');
const menu  = document.getElementById('mobileMenu');
btn?.addEventListener('click',()=>menu.classList.toggle('hidden'));
</script>

<script>
// Debug script to check static file paths
console.log('=== STATIC FILE DEBUG ===');
console.log('ECAM Logo:', "./assets/images/logos/ECAM_logo.jpg') }}");
console.log('BCU Logo:', "./assets/images/logos/BCU_logo.jpg') }}");
console.log('Innovate Logo:', "./assets/images/logos/Innovate_logo.png') }}");
console.log('Benefits Chart:', "./assets/images/benefits_chart.png') }}");
console.log('Revenue Chart:', "./assets/images/revenue_growth_projection.png') }}");
console.log('Timeline Chart:', "./assets/images/implementation_timeline.png') }}");
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    
    // API Configuration with pre-configured keys
    const API_KEYS = {
        gemini: 'AIzaSyBvX6QUHyyIpysLfhKnf7ntO_dEYbXNJrQ',
        perplexity: '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',
        chatgpt: '',
        copilot: ''
    };

    // Model priority: Gemini first, then Perplexity
    const MODEL_PRIORITY = ['gemini', 'perplexity', 'chatgpt', 'copilot'];

    // Initialize Particles.js with professional colors
    particlesJS('particles-js', {
        particles: {
            number: { value: 30, density: { enable: true, value_area: 800 } },
            color: { value: '#3730a3' },
            shape: { type: 'circle' },
            opacity: { value: 0.3, random: true },
            size: { value: 3, random: true },
            line_linked: { enable: true, distance: 150, color: '#3730a3', opacity: 0.2, width: 1 },
            move: { enable: true, speed: 1, direction: 'none', random: true, straight: false, out_mode: 'out', bounce: false }
        },
        interactivity: {
            detect_on: 'canvas',
            events: { onhover: { enable: true, mode: 'repulse' }, onclick: { enable: true, mode: 'push' }, resize: true },
            modes: { repulse: { distance: 100, duration: 0.4 }, push: { particles_nb: 2 } }
        },
        retina_detect: true
    });

    // Professional Chart Configuration
    const chartDefaults = {
        plugins: {
            legend: { display: false },
            tooltip: {
                backgroundColor: 'rgba(30, 64, 175, 0.9)',
                titleColor: '#ffffff',
                bodyColor: '#ffffff',
                borderColor: '#3730a3',
                borderWidth: 2,
                cornerRadius: 8,
                displayColors: false,
            }
        },
        scales: {
            y: {
                beginAtZero: true,
                grid: { color: 'rgba(30, 64, 175, 0.1)' },
                ticks: { color: '#374151', font: { size: 12, weight: '500' } }
            },
            x: {
                grid: { display: false },
                ticks: { color: '#374151', font: { size: 12, weight: '500' } }
            }
        },
        maintainAspectRatio: false,
        responsive: true,
        animation: { duration: 1500, easing: 'easeInOutQuart' }
    };

    // Revenue Chart with Professional Styling
    const revenueCtx = document.getElementById('revenueChart');
    if (revenueCtx) {
        new Chart(revenueCtx, {
            type: 'line',
            data: {
                labels: ['Current', 'Year 1', 'Year 2', 'Year 3', 'Year 4', 'Year 5'],
                datasets: [{
                    label: 'Revenue (£M)',
                    data: [4.4, 5.2, 6.1, 7.2, 8.5, 10.0],
                    borderColor: '#1e40af',
                    backgroundColor: 'rgba(30, 64, 175, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#1e40af',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 6
                }]
            },
            options: { 
                ...chartDefaults,
                scales: {
                    ...chartDefaults.scales,
                    y: { 
                        ...chartDefaults.scales.y, 
                        ticks: { 
                            ...chartDefaults.scales.y.ticks, 
                            callback: value => `£${value}M` 
                        } 
                    }
                }
            }
        });
    }

    // Cost Savings Chart
    const savingsCtx = document.getElementById('savingsChart');
    if (savingsCtx) {
        new Chart(savingsCtx, {
            type: 'doughnut',
            data: {
                labels: ['Maintenance Savings', 'Efficiency Gains', 'Quality Improvements', 'Time Savings'],
                datasets: [{
                    data: [200000, 350000, 150000, 300000],
                    backgroundColor: ['#1e40af', '#059669', '#7c3aed', '#f59e0b'],
                    borderColor: '#ffffff',
                    borderWidth: 3,
                    hoverOffset: 10
                }]
            },
            options: {
                ...chartDefaults,
                plugins: {
                    ...chartDefaults.plugins,
                    tooltip: {
                        ...chartDefaults.plugins.tooltip,
                        callbacks: {
                            label: function(context) {
                                return `${context.label}: £${context.parsed.toLocaleString()}`;
                            }
                        }
                    }
                },
                cutout: '60%'
            }
        });
    }

    // Live Monitoring Chart
    const liveMonitoringCtx = document.getElementById('liveMonitoringChart');
    if (liveMonitoringCtx) {
        new Chart(liveMonitoringCtx, {
            type: 'bar',
            data: {
                labels: ['CNC 1', 'CNC 2', 'Plasma', 'Laser', 'Weld 1', 'Weld 2'],
                datasets: [{
                    label: 'Utilization %',
                    data: [85, 92, 78, 88, 95, 82],
                    backgroundColor: '#1e40af',
                    borderColor: '#3730a3',
                    borderWidth: 2,
                    borderRadius: 4
                }]
            },
            options: { 
                ...chartDefaults,
                scales: {
                    ...chartDefaults.scales,
                    y: { 
                        ...chartDefaults.scales.y, 
                        max: 100,
                        ticks: { 
                            ...chartDefaults.scales.y.ticks, 
                            callback: value => `${value}%` 
                        } 
                    }
                }
            }
        });
    }

    // API Configuration Functions
    function toggleApiConfig() {
        const configSection = document.getElementById('api-config');
        if (configSection.classList.contains('hidden')) {
            configSection.classList.remove('hidden');
            configSection.scrollIntoView({ behavior: 'smooth' });
        } else {
            configSection.classList.add('hidden');
        }
    }

    function saveApiConfig() {
        // Update API keys from inputs
        API_KEYS.chatgpt = document.getElementById('chatgpt-api-key').value;
        API_KEYS.gemini = document.getElementById('gemini-api-key').value;
        API_KEYS.perplexity = document.getElementById('perplexity-api-key').value;
        API_KEYS.copilot = document.getElementById('copilot-api-key').value;
        
        updateApiStatus();
        showNotification('🔧 API configuration saved successfully!', 'success');
    }

    function updateApiStatus() {
        Object.keys(API_KEYS).forEach(model => {
            const statusElement = document.getElementById(`${model}-status`);
            const indicatorElement = document.getElementById(`${model}-indicator`);
            
            if (statusElement && indicatorElement) {
                const isConfigured = API_KEYS[model] && API_KEYS[model].length > 0;
                statusElement.textContent = isConfigured ? '✓ Configured' : 'Not configured';
                statusElement.className = isConfigured ? 'text-green-600 text-sm font-bold' : 'text-gray-500 text-sm';
                indicatorElement.className = `api-status-indicator ${isConfigured ? 'api-configured' : 'api-not-configured'}`;
            }
        });
    }

    // Enhanced Multi-AI Integration with Priority System
    async function callAI(prompt, isJson = false) {
        const statusElement = document.getElementById('cad-model-status');
        
        for (const model of MODEL_PRIORITY) {
            if (!API_KEYS[model] || API_KEYS[model].length === 0) continue;
            
            try {
                if (statusElement) statusElement.textContent = `🚀 Processing with ${model.toUpperCase()}...`;
                const result = await callSpecificAI(prompt, model, API_KEYS[model], isJson);
                if (statusElement) statusElement.textContent = `✅ Success with ${model.toUpperCase()}`;
                return result;
            } catch (error) {
                console.warn(`${model} failed:`, error);
                if (statusElement) statusElement.textContent = `⚠️ ${model.toUpperCase()} failed, trying next...`;
                
                // Continue to next model in priority list
                continue;
            }
        }

        if (statusElement) statusElement.textContent = '❌ All AI models failed - Please check configuration';
        throw new Error('All configured AI models failed to respond');
    }

    async function callSpecificAI(prompt, model, apiKey, isJson = false) {
        if (!apiKey) {
            throw new Error(`No API key configured for ${model}`);
        }

        switch (model) {
            case 'gemini':
                return await callGemini(prompt, apiKey, isJson);
            case 'perplexity':
                return await callPerplexity(prompt, apiKey);
            case 'chatgpt':
                return await callChatGPT(prompt, apiKey, isJson);
            case 'copilot':
                return await callCopilot(prompt, apiKey);
            default:
                throw new Error(`Unknown model: ${model}`);
        }
    }

    async function callGemini(prompt, apiKey, isJson = false) {
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
        const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };

        if (isJson) {
            payload.generationConfig = {
                responseMimeType: "application/json",
                responseSchema: {
                    type: "OBJECT",
                    properties: {
                        partName: { type: "STRING" },
                        material: { type: "STRING" },
                        dimensions: { type: "STRING" },
                        specifications: { type: "STRING" },
                        processes: { type: "ARRAY", items: { type: "STRING" } },
                        estimatedCost: { type: "STRING" },
                        productionTime: { type: "STRING" },
                        drawingDescription: { type: "STRING" },
                        qualityRequirements: { type: "STRING" },
                        safetyConsiderations: { type: "STRING" }
                    }
                }
            };
        }

        const response = await fetch(apiUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });

        if (!response.ok) {
            throw new Error(`Gemini API failed with status: ${response.status}`);
        }
        
        const result = await response.json();
        
        if (result.error) {
            throw new Error(`Gemini API error: ${result.error.message}`);
        }
        
        return result.candidates?.[0]?.content?.parts?.[0]?.text || 'No response generated';
    }

    async function callPerplexity(prompt, apiKey) {
        const response = await fetch('https://api.perplexity.ai/chat/completions', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${apiKey}`
            },
            body: JSON.stringify({
                model: 'llama-3.1-sonar-small-128k-online',
                messages: [{ role: 'user', content: prompt }],
                temperature: 0.7
            })
        });

        if (!response.ok) {
            throw new Error(`Perplexity API failed with status: ${response.status}`);
        }
        
        const result = await response.json();
        
        if (result.error) {
            throw new Error(`Perplexity API error: ${result.error.message}`);
        }
        
        return result.choices?.[0]?.message?.content || 'No response generated';
    }

    async function callChatGPT(prompt, apiKey, isJson = false) {
        const response = await fetch('https://api.openai.com/v1/chat/completions', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${apiKey}`
            },
            body: JSON.stringify({
                model: 'gpt-4',
                messages: [{ role: 'user', content: prompt }],
                response_format: isJson ? { type: 'json_object' } : undefined,
                temperature: 0.7
            })
        });

        if (!response.ok) {
            throw new Error(`ChatGPT API failed with status: ${response.status}`);
        }
        
        const result = await response.json();
        
        if (result.error) {
            throw new Error(`ChatGPT API error: ${result.error.message}`);
        }
        
        return result.choices?.[0]?.message?.content || 'No response generated';
    }

    async function callCopilot(prompt, apiKey) {
        throw new Error('Copilot API integration requires GitHub/Azure setup - Contact IT team');
    }

    // Enhanced Text-to-CAD Generation
    const generateCadBtn = document.getElementById('generate-cad-btn');
    const cadInput = document.getElementById('text-to-cad-input');
    const cadLoader = document.getElementById('cad-output-loader');
    const cadSpecsOutput = document.getElementById('cad-specs-output');
    const cadImageOutput = document.getElementById('cad-image-output');

    if (generateCadBtn) {
        generateCadBtn.addEventListener('click', async () => {
            const userInput = cadInput.value.trim();
            if (!userInput) {
                showNotification('🚨 Please describe your component first!', 'warning');
                return;
            }

            generateCadBtn.disabled = true;
            generateCadBtn.innerHTML = '🚀 AI Processing...';
            cadLoader.classList.remove('hidden');
            cadLoader.classList.add('flex');

            try {
                const specsPrompt = `You are a world-class mechanical engineer and CAD specialist at ECAM Engineering Limited. Convert this component description into comprehensive technical specifications in JSON format:

"${userInput}"

Provide detailed specifications including:
- partName: Clear descriptive name
- material: Specific grade (e.g., "S355 Structural Steel", "Inconel 718", "Stainless 316L")
- dimensions: With tolerances (e.g., "300mm x 200mm x 15mm ±0.1mm")
- specifications: Detailed technical specs including surface finish, heat treatment, etc.
- processes: Complete manufacturing sequence array
- estimatedCost: Realistic UK fabrication cost
- productionTime: Accurate timeframe
- drawingDescription: Detailed description for engineering visualization
- qualityRequirements: Relevant standards (ISO, BS, etc.)
- safetyConsiderations: Important safety notes

Make this suitable for precision engineering and steel fabrication at ECAM Engineering Limited.`;

                const specsResult = await callAI(specsPrompt, true);
                
                try {
                    const specs = JSON.parse(specsResult);
                    cadSpecsOutput.textContent = JSON.stringify(specs, null, 2);
                    
                    // Generate enhanced engineering drawing visualization
                    cadImageOutput.innerHTML = `
                        <div class="bg-white p-6 rounded-xl border-2 border-blue-500 shadow-lg">
                            <div class="text-center mb-4">
                                <h6 class="text-xl font-bold text-gray-800">${specs.partName || 'Engineering Component'}</h6>
                                <p class="text-sm text-gray-600">Material: ${specs.material || 'Not specified'}</p>
                                <p class="text-xs text-gray-500">Drawing No: ECM-${Date.now().toString().slice(-6)}</p>
                            </div>
                            <div class="bg-gray-50 border-2 border-dashed border-gray-300 h-48 flex items-center justify-center rounded-lg mb-4">
                                <div class="text-center">
                                    <div class="text-6xl mb-3">📐</div>
                                    <p class="font-semibold text-gray-700">AI-Generated Engineering Drawing</p>
                                    <p class="text-sm text-gray-500">${specs.dimensions || 'Dimensions as specified'}</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4 text-xs">
                                <div>
                                    <p><strong>Processes:</strong></p>
                                    <p class="text-gray-600">${specs.processes ? specs.processes.slice(0,3).join(' → ') : 'Standard fabrication'}</p>
                                </div>
                                <div>
                                    <p><strong>Cost & Time:</strong></p>
                                    <p class="text-gray-600">${specs.estimatedCost || 'TBD'} | ${specs.productionTime || 'TBD'}</p>
                                </div>
                            </div>
                            <div class="mt-4 p-3 bg-blue-50 rounded-lg">
                                <p class="text-xs text-blue-800"><strong>Quality:</strong> ${specs.qualityRequirements || 'Standard ECAM quality protocols'}</p>
                            </div>
                            <div class="mt-2 p-3 bg-yellow-50 rounded-lg">
                                <p class="text-xs text-yellow-800"><strong>Safety:</strong> ${specs.safetyConsiderations || 'Standard safety protocols apply'}</p>
                            </div>
                        </div>
                    `;
                    
                    showNotification('✅ CAD specifications generated successfully!', 'success');
                    
                } catch (e) {
                    console.error('JSON parsing error:', e);
                    cadSpecsOutput.textContent = specsResult;
                    cadImageOutput.innerHTML = '<div class="text-center text-red-500 p-8">⚠️ Unable to generate drawing preview - Check AI response format</div>';
                    showNotification('⚠️ Generated specs but drawing preview failed', 'warning');
                }
                
            } catch (error) {
                console.error('CAD generation failed:', error);
                cadSpecsOutput.textContent = `❌ Error: ${error.message}`;
                cadImageOutput.innerHTML = '<div class="text-center text-red-500 p-8">🚨 Generation failed - Please check API configuration</div>';
                showNotification('❌ CAD generation failed. Check API keys.', 'error');
            } finally {
                generateCadBtn.disabled = false;
                generateCadBtn.innerHTML = '✨ Generate Engineering Specifications';
                cadLoader.classList.add('hidden');
                cadLoader.classList.remove('flex');
            }
        });
    }

    // Tab Switching Functionality
    function initializeCapabilityTabs() {
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        // Function to switch tabs
        function switchTab(targetTab) {
            // Remove active class from all buttons
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });

            // Hide all tab contents
            tabContents.forEach(content => {
                content.classList.remove('active');
            });

            // Add active class to clicked button
            const activeButton = document.querySelector(`[data-tab="${targetTab}"]`);
            if (activeButton) {
                activeButton.classList.add('active');
            }

            // Show target tab content
            const activeContent = document.getElementById(targetTab);
            if (activeContent) {
                activeContent.classList.add('active');
            }

            console.log(`Switched to tab: ${targetTab}`);
        }

        // Add click event listeners to tab buttons
        tabButtons.forEach(button => {
            button.addEventListener('click', function(e) {
                e.preventDefault();
                const targetTab = this.getAttribute('data-tab');
                if (targetTab) {
                    switchTab(targetTab);
                }
            });
        });

        // Initialize with first tab active (predictive)
        switchTab('predictive');
        console.log('✅ Capability tabs initialized successfully');
    }

    // Initialize tabs when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
        // Wait a bit for other initializations
        setTimeout(initializeCapabilityTabs, 500);
    });

    // Debug function to check tab system
    function debugTabSystem() {
        console.log('=== TAB SYSTEM DEBUG ===');
        console.log('Tab buttons found:', document.querySelectorAll('.tab-button').length);
        console.log('Tab contents found:', document.querySelectorAll('.tab-content').length);
        
        document.querySelectorAll('.tab-button').forEach((btn, index) => {
            console.log(`Button ${index}:`, btn.getAttribute('data-tab'), btn.classList.contains('active'));
        });
        
        document.querySelectorAll('.tab-content').forEach((content, index) => {
            console.log(`Content ${index}:`, content.id, content.classList.contains('active'));
        });
    }

    // Call debug function after initialization
    setTimeout(debugTabSystem, 1000);


    // Enhanced Customer Email Generation
    const generateCustomerEmailBtn = document.getElementById('generate-customer-email-btn');
    const emailModal = document.getElementById('email-modal');
    const closeModalBtn = document.getElementById('close-modal-btn');
    const modalContent = document.getElementById('modal-text');
    const modalLoader = document.getElementById('modal-loader');

    if (generateCustomerEmailBtn) {
        generateCustomerEmailBtn.addEventListener('click', async () => {
            const customerName = document.getElementById('customer-name').value;
            const orderNumber = document.getElementById('order-number').value;
            const componentName = document.getElementById('component-name').value;
            const emailType = document.getElementById('email-type').value;

            if (!customerName || !orderNumber || !componentName) {
                showNotification('🚨 Please fill in all customer details first!', 'warning');
                return;
            }

            emailModal.classList.remove('hidden');
            emailModal.classList.add('flex');
            modalContent.classList.add('hidden');
            modalLoader.classList.remove('hidden');

            const emailPrompt = `You are the senior project manager at ECAM Engineering Limited, a prestigious precision engineering company established in 1967. Write an exceptional, professional customer status email for:

Customer: ${customerName}
Order Number: ${orderNumber}
Component: ${componentName}
Email Type: ${emailType}

Current Production Status (Use this real data):
- Housing Shell: ✅ COMPLETED (Inconel 718 - Laser Cutting → CNC Machining → Bending) - Completed 15/06/2025, Quality: 100%
- Mounting Flange: ✅ COMPLETED (S355 Steel - HD Plasma Cutting → Drilling → CNC Machining → Grinding) - Completed 16/06/2025, Quality: 100%  
- Support Bracket: 🔄 IN PROGRESS (Stainless 316L - Gas Cutting → Lathe → Milling) - 85% complete, Expected completion: 18/06/2025
- Final Assembly: 📅 SCHEDULED (Welding → Shot Blast → Paint → Packing) - Scheduled for 19/06/2025

Contract Details:
- Total Value: £24,750
- Materials: Premium grade materials as specified
- Expected Delivery: 20/06/2025 (3 days from now)
- Quality Standards: Exceeding all specifications
- Current date: ${new Date().toLocaleDateString('en-GB')}

Include in the email:
1. Professional subject line with order number and status
2. Warm, confident greeting addressing the customer personally
3. Current progress summary with specific technical details
4. Bill of materials status with completion percentages
5. Next steps and precise timeline
6. Quality assurance highlights and certifications
7. Contact information for queries
8. Professional closing with ECAM Engineering branding

Tone: Professional, confident, customer-focused, and technically detailed. Show pride in workmanship and attention to detail.`;

            try {
                const emailResult = await callAI(emailPrompt);
                modalContent.textContent = emailResult;
                
                showNotification('📧 Customer email generated successfully!', 'success');
                
            } catch (error) {
                console.error('Email generation failed:', error);
                modalContent.textContent = `❌ Email Generation Error: ${error.message}\n\nPlease check your AI API configuration and try again. If the problem persists, contact the ECAM IT support team.`;
                showNotification('❌ Email generation failed. Check API keys.', 'error');
            } finally {
                modalLoader.classList.add('hidden');
                modalContent.classList.remove('hidden');
            }
        });
    }

    // Enhanced Modal Controls
    if (closeModalBtn) {
        closeModalBtn.addEventListener('click', () => {
            emailModal.classList.add('hidden');
            emailModal.classList.remove('flex');
            modalContent.textContent = '';
        });
    }

    // Copy to Clipboard functionality
    const copyEmailBtn = document.getElementById('copy-email-btn');
    if (copyEmailBtn) {
        copyEmailBtn.addEventListener('click', async () => {
            try {
                await navigator.clipboard.writeText(modalContent.textContent);
                showNotification('✅ Email copied to clipboard successfully!', 'success');
                
                // Visual feedback
                copyEmailBtn.innerHTML = '✅ Copied!';
                setTimeout(() => {
                    copyEmailBtn.innerHTML = '📋 Copy to Clipboard';
                }, 2000);
            } catch (error) {
                console.error('Copy failed:', error);
                showNotification('❌ Failed to copy email. Please select and copy manually.', 'error');
            }
        });
    }

    // Send Email functionality
    const sendEmailBtn = document.getElementById('send-email-btn');
    if (sendEmailBtn) {
        sendEmailBtn.addEventListener('click', () => {
            const emailContent = modalContent.textContent;
            if (emailContent && emailContent.length > 50) {
                // In production, this would integrate with email APIs
                showNotification('📧 Email ready for sending. In production, this would integrate with your email system (Outlook, Gmail, etc.)', 'info');
                
                // Optional: Create mailto link
                const subject = emailContent.split('\n')[0].replace('Subject: ', '');
                const body = emailContent;
                const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                
                // Open default email client
                const a = document.createElement('a');
                a.href = mailtoLink;
                a.click();
            } else {
                showNotification('❌ No email content to send', 'warning');
            }
        });
    }

    // Download PDF functionality
    const downloadEmailBtn = document.getElementById('download-email-btn');
    if (downloadEmailBtn) {
        downloadEmailBtn.addEventListener('click', () => {
            const emailContent = modalContent.textContent;
            const customerName = document.getElementById('customer-name')?.value || 'Customer';
            const orderNumber = document.getElementById('order-number')?.value || 'Unknown';
            
            if (emailContent && emailContent.length > 50) {
                downloadEmailAsPDF(emailContent, customerName, orderNumber);
            } else {
                showNotification('❌ No email content to download', 'warning');
            }
        });
    }

    // Enhanced Tab Functionality
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabContents = document.querySelectorAll('.tab-content');
    
    tabButtons.forEach(button => {
        button.addEventListener('click', () => {
            // Remove active classes with animation
            tabButtons.forEach(btn => {
                btn.classList.remove('active', 'text-blue-600', 'border-blue-600');
                btn.classList.add('text-gray-600', 'border-transparent');
            });
            
            // Add active classes to clicked button
            button.classList.add('active', 'text-blue-600', 'border-blue-600');
            button.classList.remove('text-gray-600', 'border-transparent');

            // Show corresponding content with fade effect
            const tabId = button.dataset.tab;
            tabContents.forEach(content => {
                if (content.id === tabId) {
                    content.classList.remove('hidden');
                    // Add smooth fade-in animation
                    content.style.opacity = '0';
                    content.style.transform = 'translateY(20px)';
                    setTimeout(() => {
                        content.style.transition = 'all 0.5s ease-out';
                        content.style.opacity = '1';
                        content.style.transform = 'translateY(0)';
                    }, 10);
                } else {
                    content.classList.add('hidden');
                }
            });
        });
    });

    // Enhanced Timeline Functionality
    const timelineItems = document.querySelectorAll('.timeline-item');
    const phaseContents = document.querySelectorAll('.phase-content');
    
    timelineItems.forEach(item => {
        item.addEventListener('click', () => {
            // Remove active state from all items
            timelineItems.forEach(i => i.classList.remove('active'));
            item.classList.add('active');
            
            const phaseId = item.dataset.phase;
            phaseContents.forEach(content => {
                if (content.id === phaseId) {
                    content.classList.remove('hidden');
                    // Add slide-in animation
                    content.style.transform = 'translateX(-30px)';
                    content.style.opacity = '0';
                    setTimeout(() => {
                        content.style.transition = 'all 0.6s ease-out';
                        content.style.transform = 'translateX(0)';
                        content.style.opacity = '1';
                    }, 10);
                } else {
                    content.classList.add('hidden');
                }
            });
        });
    });

    // Stakeholder Email Generation
    const generateEmailBtns = document.querySelectorAll('.generate-email-btn');
    generateEmailBtns.forEach(btn => {
        btn.addEventListener('click', async () => {
            const phaseDetails = btn.dataset.phaseDetails;
            
            if (!phaseDetails) {
                showNotification('❌ No phase details available', 'warning');
                return;
            }
            
            emailModal.classList.remove('hidden');
            emailModal.classList.add('flex');
            modalContent.classList.add('hidden');
            modalLoader.classList.remove('hidden');

            const stakeholderPrompt = `You are the senior project manager for ECAM Engineering Limited's AI-Driven MES-IoT Platform project. Write a compelling, professional project update email for the board of directors and senior stakeholders.

Project Phase: ${phaseDetails}

Include:
- Compelling subject line emphasizing progress and value
- Executive greeting acknowledging their strategic vision
- Brief project context highlighting the transformation scale  
- Specific achievements and milestones with quantified benefits
- Current progress status with impressive metrics
- Next steps and timeline with confidence-building language
- ROI benefits being realized (£200K savings, 90% efficiency gains, etc.)
- Technology leadership advantages being established
- Any strategic support needed (presented as opportunities)
- Professional closing emphasizing the exceptional returns

Key Metrics to Include:
- £80,000 investment over 3 years
- 350% ROI projection
- £10M revenue target by year 5
- 90% quotation time reduction
- 25% maintenance cost reduction
- 20% production throughput increase

Tone: Confident, results-focused, strategic, and inspiring. Emphasize the competitive advantages being created and the exceptional ROI being delivered. Make stakeholders feel proud of their investment decision.

Length: Professional but comprehensive (400-600 words)`;

            try {
                const result = await callAI(stakeholderPrompt);
                modalContent.textContent = result;
                showNotification('📊 Stakeholder update generated successfully!', 'success');
            } catch (error) {
                console.error('Stakeholder email generation failed:', error);
                modalContent.textContent = `❌ Stakeholder email generation failed: ${error.message}\n\nPlease check your AI API configuration and try again.`;
                showNotification('❌ Stakeholder email generation failed. Check API keys.', 'error');
            } finally {
                modalLoader.classList.add('hidden');
                modalContent.classList.remove('hidden');
            }
        });
    });

    // Enhanced Navigation with Smooth Scrolling
    const sections = document.querySelectorAll('section');
    const navLinks = document.querySelectorAll('.nav-link');

    const observerOptions = {
        root: null,
        rootMargin: '-20% 0px -80% 0px',
        threshold: 0,
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const id = entry.target.getAttribute('id');
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${id}`) {
                        link.classList.add('active');
                    }
                });
            }
        });
    }, observerOptions);

    sections.forEach(section => {
        observer.observe(section);
    });

    // Smooth scrolling for navigation links
    navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const targetId = link.getAttribute('href').substring(1);
            const targetSection = document.getElementById(targetId);
            
            if (targetSection) {
                targetSection.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Close modal on outside click
    if (emailModal) {
        emailModal.addEventListener('click', (e) => {
            if (e.target === emailModal) {
                emailModal.classList.add('hidden');
                emailModal.classList.remove('flex');
                modalContent.textContent = '';
            }
        });
    }

    // Keyboard navigation for modal
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !emailModal.classList.contains('hidden')) {
            emailModal.classList.add('hidden');
            emailModal.classList.remove('flex');
            modalContent.textContent = '';
        }
    });

    // Enhanced Utility Functions
    function showNotification(message, type = 'info') {
        // Remove existing notifications
        const existingNotifications = document.querySelectorAll('.notification');
        existingNotifications.forEach(notification => {
            notification.remove();
        });

        const notification = document.createElement('div');
        notification.className = `notification fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transition-all duration-300 transform translate-x-full`;
        
        const colors = {
            success: 'bg-green-500 text-white border-green-600',
            error: 'bg-red-500 text-white border-red-600',
            info: 'bg-blue-500 text-white border-blue-600',
            warning: 'bg-yellow-500 text-black border-yellow-600'
        };
        
        notification.className += ` ${colors[type] || colors.info} border-l-4`;
        notification.innerHTML = `
            <div class="flex items-start">
                <div class="flex-shrink-0">
                    ${type === 'success' ? '✅' : type === 'error' ? '❌' : type === 'warning' ? '⚠️' : 'ℹ️'}
                </div>
                <div class="ml-3">
                    <p class="text-sm font-medium">${message}</p>
                </div>
                <div class="ml-auto pl-3">
                    <button onclick="this.parentElement.parentElement.parentElement.remove()" class="text-sm opacity-75 hover:opacity-100">✕</button>
                </div>
            </div>
        `;
        
        document.body.appendChild(notification);
        
        // Animate in
        setTimeout(() => {
            notification.classList.remove('translate-x-full');
        }, 100);
        
        // Auto remove after 5 seconds
        setTimeout(() => {
            notification.classList.add('translate-x-full');
            setTimeout(() => {
                if (notification.parentNode) {
                    document.body.removeChild(notification);
                }
            }, 300);
        }, 5000);
    }

    function downloadEmailAsPDF(content, customerName, orderNumber) {
        try {
            // Create a more sophisticated text file with better formatting
            const formattedContent = `
ECAM ENGINEERING LIMITED
Professional Email Communication
Generated on: ${new Date().toLocaleString('en-GB')}

Customer: ${customerName}
Order Number: ${orderNumber}

${content}

---
Generated by ECAM AI-Driven MES-IoT Platform
© 2025 ECAM Engineering Limited
            `.trim();
            
            const blob = new Blob([formattedContent], { type: 'text/plain;charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ECAM_Email_${customerName.replace(/\s+/g, '_')}_${orderNumber}_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('📄 Email downloaded successfully!', 'success');
        } catch (error) {
            console.error('Download failed:', error);
            showNotification('❌ Download failed. Please try again.', 'error');
        }
    }

    function trackEmailGeneration(customerName, orderNumber, emailType, model) {
        // Enhanced analytics tracking
        const analyticsData = {
            timestamp: new Date().toISOString(),
            customer: customerName,
            order: orderNumber,
            type: emailType,
            model: model,
            success: true,
            userAgent: navigator.userAgent,
            url: window.location.href
        };
        
        console.log('📊 Email Generation Analytics:', analyticsData);
        
        // In production, send to analytics service
        // analytics.track('email_generated', analyticsData);
    }

    // Initialize scroll-triggered animations
    const animateOnScroll = () => {
        const elements = document.querySelectorAll('.card-hover, .floating-card, .professional-card');
        elements.forEach(element => {
            const elementTop = element.getBoundingClientRect().top;
            const elementVisible = 150;
            
            if (elementTop < window.innerHeight - elementVisible) {
                element.style.opacity = '1';
                element.style.transform = 'translateY(0)';
            }
        });
    };

    // Initialize animations for cards
    document.querySelectorAll('.card-hover, .floating-card, .professional-card').forEach((element, index) => {
        element.style.opacity = '0';
        element.style.transform = 'translateY(20px)';
        element.style.transition = `all 0.8s ease-out ${index * 0.1}s`;
    });

    // Scroll event listener
    let scrollTimeout;
    window.addEventListener('scroll', () => {
        if (scrollTimeout) {
            clearTimeout(scrollTimeout);
        }
        scrollTimeout = setTimeout(animateOnScroll, 10);
    });

    // Initial animation run
    animateOnScroll();

    // Initialize GSAP animations if available
    if (typeof gsap !== 'undefined') {
        // Animate hero metrics on load
        gsap.from('.metric-counter', {
            duration: 2,
            scale: 0.5,
            opacity: 0,
            stagger: 0.2,
            ease: 'back.out(1.7)',
            delay: 0.5
        });

        // Animate floating cards
        gsap.from('.floating-card', {
            duration: 1.5,
            y: 50,
            opacity: 0,
            stagger: 0.3,
            ease: 'power2.out',
            delay: 1
        });

        // Animate timeline dots
        gsap.from('.timeline-dot', {
            duration: 1,
            scale: 0,
            stagger: 0.2,
            ease: 'elastic.out(1, 0.5)',
            delay: 1.5
        });

        // Animate charts when they come into view
        const chartElements = document.querySelectorAll('.chart-container');
        chartElements.forEach(chart => {
            gsap.fromTo(chart, 
                { opacity: 0, scale: 0.8 },
                { 
                    opacity: 1, 
                    scale: 1, 
                    duration: 1.2,
                    ease: 'power2.out',
                    scrollTrigger: {
                        trigger: chart,
                        start: 'top 80%',
                        end: 'bottom 20%',
                        toggleActions: 'play none none reverse'
                    }
                }
            );
        });
    }

    // Performance monitoring
    function measurePerformance() {
        if ('performance' in window) {
            const navigationTiming = performance.getEntriesByType('navigation')[0];
            const loadTime = navigationTiming.loadEventEnd - navigationTiming.loadEventStart;
            
            console.log('🚀 Page Performance Metrics:', {
                loadTime: `${loadTime}ms`,
                domContentLoaded: `${navigationTiming.domContentLoadedEventEnd - navigationTiming.domContentLoadedEventStart}ms`,
                firstPaint: performance.getEntriesByType('paint').find(entry => entry.name === 'first-paint')?.startTime || 'N/A',
                firstContentfulPaint: performance.getEntriesByType('paint').find(entry => entry.name === 'first-contentful-paint')?.startTime || 'N/A'
            });
        }
    }

    // Make functions globally available
    window.toggleApiConfig = toggleApiConfig;
    window.saveApiConfig = saveApiConfig;
    window.showNotification = showNotification;
    window.callAI = callAI;

    // Initialize API status on load
    updateApiStatus();

    // Performance measurement
    if (document.readyState === 'complete') {
        measurePerformance();
    } else {
        window.addEventListener('load', measurePerformance);
    }

    // Final initialization message
    console.log('🚀 ECAM Engineering AI-Driven MES-IoT Platform Loaded Successfully!');
    console.log('💡 Features: Multi-AI Integration, Text-to-CAD, Customer Communications, Predictive Analytics');
    console.log('🎯 Ready to transform manufacturing with Industry 4.0 technologies!');
    console.log('🔧 API Status:', {
        gemini: API_KEYS.gemini ? '✅ Configured' : '❌ Not configured',
        perplexity: API_KEYS.perplexity ? '✅ Configured' : '❌ Not configured',
        chatgpt: API_KEYS.chatgpt ? '✅ Configured' : '❌ Not configured',
        copilot: API_KEYS.copilot ? '✅ Configured' : '❌ Not configured'
    });
    
    // Show welcome notification
    setTimeout(() => {
        showNotification('🚀 ECAM Digital Transformation Platform Ready! Gemini & Perplexity AI configured and ready to use.', 'success');
    }, 1500);

    // Auto-save configuration periodically
    setInterval(() => {
        if (API_KEYS.gemini || API_KEYS.perplexity || API_KEYS.chatgpt || API_KEYS.copilot) {
            localStorage.setItem('ecam_ai_config', JSON.stringify({
                timestamp: Date.now(),
                configured_models: Object.keys(API_KEYS).filter(key => API_KEYS[key])
            }));
        }
    }, 30000); // Save every 30 seconds

    // Error boundary for unhandled errors
    window.addEventListener('error', (event) => {
        console.error('🚨 Unhandled Error:', event.error);
        showNotification('⚠️ An unexpected error occurred. Please refresh the page if problems persist.', 'warning');
    });

    // Handle unhandled promise rejections
    window.addEventListener('unhandledrejection', (event) => {
        console.error('🚨 Unhandled Promise Rejection:', event.reason);
        showNotification('⚠️ A network or processing error occurred. Please check your connection and try again.', 'warning');
        event.preventDefault(); // Prevent the default console error
    });
});

// Service Worker registration for offline capability (optional)
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
            .then(registration => {
                console.log('🔧 Service Worker registered successfully:', registration.scope);
            })
            .catch(error => {
                console.log('⚠️ Service Worker registration failed:', error);
            });
    });
}

<!-- Complete JavaScript Implementation -->
    // Manufacturing ROI Calculator - Industry-Validated Formulas
    // === CORRECTED ROI CALCULATOR CLASS ===
    class ECAMROICalculator {
    constructor() {
        this.modal = null;
        this.popover = null;
        this.currentTab = 'overview';
        this.isInitialized = false;
        this.init();
    }

    init() {
        if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => this.initialize());
        } else {
        this.initialize();
        }
    }

    initialize() {
        try {
        this.modal = document.getElementById('calculatorModal');
        this.popover = document.getElementById('calculatorPopover');
        
        if (!this.modal || !this.popover) {
            console.warn('ROI Calculator modal elements not found');
            return;
        }

        this.setupEventListeners();
        this.initializeCalculator(); // FIX: Add this method
        this.isInitialized = true;
        console.log('ECAM ROI Calculator initialized successfully');
        } catch (error) {
        console.error('Error initializing ROI Calculator:', error);
        }
    }

    // FIX: ADD MISSING METHOD
    initializeCalculator() {
        this.initializeCalculatorInputs();
        this.calculateROI(); // Initial calculation
    }

    setupEventListeners() {
        // Modal event listeners
        document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && this.modal && this.modal.classList.contains('show')) {
            this.closeModal();
        }
        });

        // Close modal on backdrop click
        if (this.modal) {
        this.modal.addEventListener('click', (e) => {
            if (e.target === this.modal) {
            this.closeModal();
            }
        });

        // Prevent modal close when clicking inside
        const modalContainer = this.modal.querySelector('.modal-container');
        if (modalContainer) {
            modalContainer.addEventListener('click', (e) => {
            e.stopPropagation();
            });
        }
        }
    }

    initializeCalculatorInputs() {
        const inputs = [
        'productionCapacity', 'currentUtilization', 'laborForce', 'wageRate',
        'annualRevenue', 'grossMargin', 'ebitdaMargin', 'workingCapital',
        'materialCostRatio', 'energyCostRatio', 'maintenanceCostRatio', 'qualityCostRatio',
        'projectInvestment', 'discountRate', 'implementationRisk', 'analysisPeriod',
        'efficiencyImprovement', 'downtimeReduction', 'qualityImprovement', 'marketPenetration'
        ];

        inputs.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
            element.addEventListener('input', () => this.calculateROI());
            element.addEventListener('change', () => this.calculateROI());
        }
        });
    }

    calculateROI() {
        try {
        const inputs = this.getInputValues();
        const baseline = this.calculateBaselineCosts(inputs);
        const efficiencyBenefits = this.calculateEfficiencyBenefits(inputs, baseline);
        const revenueEnhancements = this.calculateRevenueEnhancements(inputs);
        const workingCapitalImpact = this.calculateWorkingCapitalImpact(inputs, revenueEnhancements);
        
        const totalAnnualBenefit = efficiencyBenefits.totalAnnualSavings + 
                                revenueEnhancements.totalRevenueEnhancement + 
                                workingCapitalImpact;

        const cashFlows = Array(inputs.analysisPeriod).fill(totalAnnualBenefit);
        const npv = this.calculateNPV(cashFlows, inputs.discountRate) - inputs.projectInvestment;
        const irr = this.calculateIRR(cashFlows, inputs.projectInvestment);
        const paybackPeriod = this.calculatePaybackPeriod(inputs.projectInvestment, totalAnnualBenefit);
        const roic = this.calculateROIC(inputs, totalAnnualBenefit);

        const riskAnalysis = this.performRiskAnalysis(inputs, { npv, totalAnnualBenefit });

        this.updateDisplay({
            npv, irr, paybackPeriod, roic, totalAnnualBenefit,
            efficiencyBenefits, revenueEnhancements, workingCapitalImpact, riskAnalysis
        });

        this.updateSliderOutputs(inputs);
        } catch (error) {
        console.error('Error calculating ROI:', error);
        }
    }

    getInputValues() {
        return {
        productionCapacity: this.getNumericValue('productionCapacity', 10000),
        currentUtilization: this.getNumericValue('currentUtilization', 75) / 100,
        laborForce: this.getNumericValue('laborForce', 35),
        wageRate: this.getNumericValue('wageRate', 14.5),
        annualRevenue: this.getNumericValue('annualRevenue', 3.2) * 1000000,
        grossMargin: this.getNumericValue('grossMargin', 32) / 100,
        ebitdaMargin: this.getNumericValue('ebitdaMargin', 18) / 100,
        workingCapital: this.getNumericValue('workingCapital', 12) / 100,
        materialCostRatio: this.getNumericValue('materialCostRatio', 45) / 100,
        energyCostRatio: this.getNumericValue('energyCostRatio', 8) / 100,
        maintenanceCostRatio: this.getNumericValue('maintenanceCostRatio', 6) / 100,
        qualityCostRatio: this.getNumericValue('qualityCostRatio', 3) / 100,
        projectInvestment: this.getNumericValue('projectInvestment', 367000),
        discountRate: this.getNumericValue('discountRate', 12) / 100,
        implementationRisk: this.getNumericValue('implementationRisk', 15) / 100,
        analysisPeriod: this.getNumericValue('analysisPeriod', 5),
        efficiencyImprovement: this.getNumericValue('efficiencyImprovement', 20) / 100,
        downtimeReduction: this.getNumericValue('downtimeReduction', 30) / 100,
        qualityImprovement: this.getNumericValue('qualityImprovement', 25) / 100,
        marketPenetration: this.getNumericValue('marketPenetration', 8) / 100
        };
    }

    getNumericValue(id, defaultValue) {
        const element = document.getElementById(id);
        if (!element) return defaultValue;
        const value = Number(element.value);
        return isNaN(value) ? defaultValue : value;
    }

    calculateBaselineCosts(inputs) {
        const annualLaborHours = 2087;
        const totalLaborCost = inputs.laborForce * inputs.wageRate * annualLaborHours;
        
        return {
        laborCost: totalLaborCost,
        materialCost: inputs.annualRevenue * inputs.materialCostRatio,
        energyCost: inputs.annualRevenue * inputs.energyCostRatio,
        maintenanceCost: inputs.annualRevenue * inputs.maintenanceCostRatio,
        qualityCost: inputs.annualRevenue * inputs.qualityCostRatio,
        workingCapitalRequirement: inputs.annualRevenue * inputs.workingCapital
        };
    }

    calculateEfficiencyBenefits(inputs, baseline) {
        const laborEfficiencyFactor = 1 - Math.pow(1 - inputs.efficiencyImprovement, 0.8);
        const laborSavings = baseline.laborCost * laborEfficiencyFactor * 0.7;

        const materialWasteReduction = Math.min(
        inputs.efficiencyImprovement * 0.6 + inputs.qualityImprovement * 0.4,
        0.35
        );
        const materialSavings = baseline.materialCost * materialWasteReduction;

        const energyEfficiencyGain = Math.min(
        inputs.efficiencyImprovement * 0.5 + inputs.downtimeReduction * 0.3,
        0.25
        );
        const energySavings = baseline.energyCost * energyEfficiencyGain;

        const maintenanceReduction = Math.min(
        inputs.downtimeReduction * 0.8 + inputs.efficiencyImprovement * 0.2,
        0.40
        );
        const maintenanceSavings = baseline.maintenanceCost * maintenanceReduction;

        const qualityReduction = Math.min(inputs.qualityImprovement * 0.9, 0.60);
        const qualitySavings = baseline.qualityCost * qualityReduction;

        return {
        laborSavings,
        materialSavings,
        energySavings,
        maintenanceSavings,
        qualitySavings,
        totalAnnualSavings: laborSavings + materialSavings + energySavings + maintenanceSavings + qualitySavings
        };
    }

    calculateRevenueEnhancements(inputs) {
        const currentProduction = inputs.productionCapacity * inputs.currentUtilization;
        const efficiencyCapacityGain = currentProduction * inputs.efficiencyImprovement * 0.6;
        const marketPenetrationRevenue = inputs.annualRevenue * inputs.marketPenetration;
        const qualityPremium = inputs.annualRevenue * inputs.qualityImprovement * 0.15;

        const totalRevenueEnhancement = efficiencyCapacityGain * (inputs.annualRevenue / (currentProduction * 12)) + 
                                    marketPenetrationRevenue + qualityPremium;

        return {
        capacityRevenue: efficiencyCapacityGain * (inputs.annualRevenue / (currentProduction * 12)),
        marketRevenue: marketPenetrationRevenue,
        qualityRevenue: qualityPremium,
        totalRevenueEnhancement
        };
    }

    calculateWorkingCapitalImpact(inputs, revenueEnhancement) {
        const additionalWCRequirement = revenueEnhancement.totalRevenueEnhancement * inputs.workingCapital;
        const wcEfficiencyGain = inputs.annualRevenue * inputs.workingCapital * inputs.efficiencyImprovement * 0.3;
        return wcEfficiencyGain - additionalWCRequirement;
    }

    calculateNPV(cashFlows, discountRate) {
        return cashFlows.reduce((npv, cashFlow, year) => {
        return npv + cashFlow / Math.pow(1 + discountRate, year + 1);
        }, 0);
    }

    calculateIRR(cashFlows, initialInvestment) {
        let irr = 0.1;
        const tolerance = 0.0001;
        const maxIterations = 100;

        for (let i = 0; i < maxIterations; i++) {
        let npv = -initialInvestment;
        let npvDerivative = 0;

        cashFlows.forEach((cashFlow, year) => {
            const period = year + 1;
            npv += cashFlow / Math.pow(1 + irr, period);
            npvDerivative -= period * cashFlow / Math.pow(1 + irr, period + 1);
        });

        const newIrr = irr - npv / npvDerivative;
        
        if (Math.abs(newIrr - irr) < tolerance) {
            return newIrr;
        }
        
        irr = newIrr;
        }

        return irr;
    }

    calculatePaybackPeriod(initialInvestment, annualCashFlow) {
        return initialInvestment / annualCashFlow;
    }

    calculateROIC(inputs, totalAnnualBenefit) {
        const investedCapital = inputs.projectInvestment + inputs.annualRevenue * inputs.workingCapital;
        return totalAnnualBenefit / investedCapital;
    }

    performRiskAnalysis(inputs, baseCase) {
        const riskFactor = inputs.implementationRisk;
        
        return {
        bestCase: {
            npv: baseCase.npv * (1 + riskFactor * 0.5),
            benefits: baseCase.totalAnnualBenefit * (1 + riskFactor * 0.3)
        },
        expectedCase: baseCase,
        worstCase: {
            npv: baseCase.npv * (1 - riskFactor * 0.8),
            benefits: baseCase.totalAnnualBenefit * (1 - riskFactor * 0.6)
        }
        };
    }

    updateDisplay(results) {
        this.updateElement('npvValue', this.formatCurrency(results.npv));
        this.updateElement('irrValue', Math.round(results.irr * 100) + '%');
        this.updateElement('paybackValue', results.paybackPeriod.toFixed(1) + ' years');
        this.updateElement('roicValue', Math.round(results.roic * 100) + '%');

        this.updateElement('annualSavings', this.formatCurrency(results.efficiencyBenefits.totalAnnualSavings));
        this.updateElement('revenueEnhancement', this.formatCurrency(results.revenueEnhancements.totalRevenueEnhancement));
        this.updateElement('workingCapitalImpact', this.formatCurrency(results.workingCapitalImpact));
        this.updateElement('totalAnnualBenefit', this.formatCurrency(results.totalAnnualBenefit));

        this.updateElement('bestCase', this.formatCurrency(results.riskAnalysis.bestCase.npv));
        this.updateElement('expectedCase', this.formatCurrency(results.riskAnalysis.expectedCase.npv));
        this.updateElement('worstCase', this.formatCurrency(results.riskAnalysis.worstCase.npv));
    }

    updateSliderOutputs(inputs) {
        this.updateElement('efficiencyOutput', Math.round(inputs.efficiencyImprovement * 100) + '%');
        this.updateElement('downtimeOutput', Math.round(inputs.downtimeReduction * 100) + '%');
        this.updateElement('qualityImprovementOutput', Math.round(inputs.qualityImprovement * 100) + '%');
        this.updateElement('marketPenetrationOutput', Math.round(inputs.marketPenetration * 100) + '%');
    }

    updateElement(id, value) {
        const element = document.getElementById(id);
        if (element) {
        element.textContent = value;
        }
    }

    formatCurrency(value) {
        if (Math.abs(value) >= 1000000) {
        return '£' + (value / 1000000).toFixed(1) + 'M';
        } else if (Math.abs(value) >= 1000) {
        return '£' + (value / 1000).toFixed(0) + 'K';
        }
        return '£' + Math.round(value).toLocaleString('en-GB');
    }

    // Modal management methods
    openModal() {
        if (!this.modal) return;
        this.modal.classList.add('show');
        this.modal.setAttribute('aria-hidden', 'false');
        
        // FIX: Proper focus management
        const modalContainer = this.modal.querySelector('.modal-container');
        if (modalContainer) {
        const firstFocusable = modalContainer.querySelector('.tab-button, button, input, [tabindex]:not([tabindex="-1"])');
        if (firstFocusable) {
            firstFocusable.focus();
        }
        }
        
        document.body.style.overflow = 'hidden';
    }

    closeModal() {
        if (!this.modal) return;
        this.modal.classList.remove('show');
        this.modal.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
    }

    switchTab(tabName) {
        document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
        });
        
        document.querySelectorAll('.tab-button').forEach(button => {
        button.classList.remove('active');
        });
        
        const targetTab = document.getElementById(tabName);
        if (targetTab) {
        targetTab.classList.add('active');
        }
        
        const buttons = document.querySelectorAll('.tab-button');
        buttons.forEach(button => {
        if (button.textContent.toLowerCase().includes(tabName)) {
            button.classList.add('active');
        }
        });
        
        this.currentTab = tabName;
    }

    showPopover(triggerElement) {
        if (!this.popover || !triggerElement) return;
        
        const rect = triggerElement.getBoundingClientRect();
        this.popover.style.left = rect.left + (rect.width / 2) - (this.popover.offsetWidth / 2) + 'px';
        this.popover.style.top = rect.bottom + 10 + 'px';
        this.popover.classList.add('show');
        
        setTimeout(() => {
        this.hidePopover();
        }, 5000);
    }

    hidePopover() {
        if (this.popover) {
        this.popover.classList.remove('show');
        }
    }

    expandInNewTab() {
        const newWindow = window.open('', '_blank', 'width=1000,height=700,scrollbars=yes,resizable=yes');
        
        const modalContent = this.modal.querySelector('.modal-body').innerHTML;
        
        newWindow.document.write(`
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>ECAM ROI Calculator - Detailed Information</title>
            <style>
            body { 
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
                margin: 20px; 
                line-height: 1.6; 
            }
            .tab-content { 
                display: block !important; 
                margin-bottom: 40px; 
                border-bottom: 2px solid #e5e7eb;
                padding-bottom: 30px;
            }
            .modal-tabs { display: none; }
            h2, h3 { 
                color: #1f2937; 
                border-bottom: 2px solid #667eea; 
                padding-bottom: 10px; 
            }
            </style>
        </head>
        <body>
            <h1>🏭 ECAM Engineering - ROI Calculator Documentation</h1>
            <p><strong>Knowledge Transfer Partnership Project</strong> - Manufacturing Excellence & Digital Transformation</p>
            ${modalContent}
        </body>
        </html>
        `);
        
        newWindow.document.close();
    }
}

    // JavaScript fixture for About ROI and Help ? buttons
    function openCalculatorModal() {
        const modal = document.getElementById('calculatorModal');
        if (modal) {
            modal.classList.add('show');
            modal.setAttribute('aria-hidden', 'false');
            document.body.style.overflow = 'hidden';
            
            // Focus management for accessibility
            const firstFocusable = modal.querySelector('button, [tabindex]:not([tabindex="-1"])');
            if (firstFocusable) {
                firstFocusable.focus();
            }
        } else {
            console.error('Calculator modal not found');
        }
    }

    function switchCalculatorTab(tabName) {
        // Hide all tab contents
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        
        // Remove active class from all tab buttons
        document.querySelectorAll('.tab-button').forEach(button => {
            button.classList.remove('active');
        });
        
        // Show selected tab content
        const targetTab = document.getElementById(tabName);
        if (targetTab) {
            targetTab.classList.add('active');
        }
        
        // Add active class to clicked button
        event.target.classList.add('active');
    }

    function expandCalculatorInNewTab() {
        const modalContent = document.getElementById('calculatorModal')?.querySelector('.modal-body')?.innerHTML;
        if (modalContent) {
            const newWindow = window.open('', '_blank', 'width=1000,height=700,scrollbars=yes,resizable=yes');
            newWindow.document.write(`
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Manufacturing ROI Calculator Guide</title>
                    <style>
                        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 20px; line-height: 1.6; }
                        .definition-item { padding: 20px; background: #f8fafc; border-radius: 8px; margin-bottom: 16px; border-left: 4px solid #1e40af; }
                        .formula-box { background: #1f2937; color: #f9fafb; padding: 16px; border-radius: 6px; font-family: monospace; margin: 12px 0; }
                    </style>
                </head>
                <body>
                    <h1>📘 Manufacturing ROI Calculator Guide</h1>
                    ${modalContent}
                </body>
                </html>
            `);
            newWindow.document.close();
        }
    }

    function showCalculatorHelp(element) {
        const popover = document.getElementById('calculatorPopover');
        if (popover) {
            popover.style.display = 'flex';
            setTimeout(() => {
                hideCalculatorHelp();
            }, 5000);
        } else {
            // Fallback alert if popover doesn't exist
            alert('ROI Calculator Help:\n\nAdjust the improvement sliders to see real-time NPV, IRR, and payback calculations. Based on industry-validated formulas and ECAM\'s operational data.');
        }
    }

    function hideCalculatorHelp() {
        const popover = document.getElementById('calculatorPopover');
        if (popover) {
            popover.style.display = 'none';
        }
    }

    function closeCalculatorModal() {
        const modal = document.getElementById('calculatorModal');
        if (modal) {
            modal.classList.remove('show');
            modal.setAttribute('aria-hidden', 'true');
            document.body.style.overflow = '';
        }
    }

    // Document Download Functionality
    const downloadProposalBtn = document.getElementById('download-proposal-btn');
    const downloadPdfBtn = document.getElementById('download-pdf-btn');

    if (downloadProposalBtn) {
        downloadProposalBtn.addEventListener('click', async () => {
            try {
                downloadProposalBtn.innerHTML = '⏳ Preparing Download...';
                downloadProposalBtn.disabled = true;
                
                // Create download link for the proposal document
                const link = document.createElement('a');
                link.href = "./assets/documents/Next_KTP_Proposal.docx";
                link.download = 'ECAM_KTP_Proposal_2026.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showNotification('📄 KTP Proposal document download started!', 'success');
                
            } catch (error) {
                console.error('Download failed:', error);
                showNotification('❌ Download failed. Please try again.', 'error');
            } finally {
                setTimeout(() => {
                    downloadProposalBtn.innerHTML = `
                        <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        Click Here for Detailed Proposal
                    `;
                    downloadProposalBtn.disabled = false;
                }, 2000);
            }
        });
    }

    // Enhanced PDF generation with proper cleanup
if (downloadPdfBtn) {
    downloadPdfBtn.addEventListener('click', async () => {
        try {
            downloadPdfBtn.innerHTML = '🖨️ Generating Professional PDF...';
            downloadPdfBtn.disabled = true;
            
            // Clear all notifications first
            const notifications = document.querySelectorAll('.notification');
            notifications.forEach(n => n.remove());
            
            showNotification('📄 Preparing professional PDF document...', 'info');
            
            // Store original states
            const originalTitle = document.title;
            const originalContent = document.body.cloneNode(true);
            
            // Set professional title
            document.title = 'ECAM Engineering - AI-Driven MES-IoT Platform Proposal';
            
            // Clean up the document for printing
            await preparePrintDocument();
            
            // Add print-specific elements
            addPrintElements();
            
            // Generate PDF
            setTimeout(() => {
                window.print();
                
                // Restore original state after print
                setTimeout(() => {
                    restoreOriginalDocument(originalTitle, originalContent);
                    showNotification('📄 PDF generation completed! Professional document ready for download.', 'success');
                }, 1000);
                
            }, 1500);
            
        } catch (error) {
            console.error('PDF generation failed:', error);
            showNotification('❌ PDF generation failed. Please try again.', 'error');
        } finally {
            setTimeout(() => {
                downloadPdfBtn.innerHTML = `
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                    </svg>
                    Download this Presentation as PDF
                `;
                downloadPdfBtn.disabled = false;
            }, 3000);
        }
    });
}

// Prepare document for professional printing
async function preparePrintDocument() {
    return new Promise((resolve) => {
        // Remove all notifications and interactive elements
        const elementsToRemove = [
            '.notification',
            '#api-config',
            '.api-config-section',
            '.professional-button:not(#download-pdf-btn)',
            '.tab-button',
            '.generate-email-btn',
            'button[onclick]',
            'input',
            'textarea',
            'select',
            '.loading-bar',
            '.loading-progress',
            '#particles-js',
            '.status-indicator',
            '.interactive-demo'
        ];
        
        elementsToRemove.forEach(selector => {
            const elements = document.querySelectorAll(selector);
            elements.forEach(el => {
                el.style.display = 'none';
                el.classList.add('print-hidden');
            });
        });
        
        // Hide the download section during printing
        const downloadSection = document.querySelector('section:last-child');
        if (downloadSection && downloadSection.innerHTML.includes('PROJECT DOCUMENTATION')) {
            downloadSection.style.display = 'none';
            downloadSection.classList.add('print-hidden');
        }
        
        // Ensure all images are loaded
        const images = document.querySelectorAll('img');
        let loadedImages = 0;
        
        if (images.length === 0) {
            resolve();
            return;
        }
        
        images.forEach(img => {
            if (img.complete) {
                loadedImages++;
                if (loadedImages === images.length) resolve();
            } else {
                img.onload = () => {
                    loadedImages++;
                    if (loadedImages === images.length) resolve();
                };
                img.onerror = () => {
                    // Hide broken images
                    img.style.display = 'none';
                    loadedImages++;
                    if (loadedImages === images.length) resolve();
                };
            }
        });
        
        // Timeout fallback
        setTimeout(resolve, 2000);
    });
}

// Add print-specific elements
function addPrintElements() {
    // Add print header
    const printHeader = document.createElement('div');
    printHeader.className = 'print-only';
    printHeader.innerHTML = `
        <div style="text-align: center; margin-bottom: 20px; border-bottom: 2px solid #1e40af; padding-bottom: 10px;">
            <h1 style="color: #1e40af; margin: 0; font-size: 24pt;">ECAM ENGINEERING LIMITED</h1>
            <h2 style="color: #666; margin: 5px 0 0 0; font-size: 16pt;">AI-Driven MES-IoT Platform Proposal</h2>
            <p style="color: #666; margin: 5px 0 0 0; font-size: 11pt;">36-Month Knowledge Transfer Partnership • £80,000 Investment</p>
        </div>
    `;
    document.body.insertBefore(printHeader, document.body.firstChild);
    
    // Add page breaks for better structure
    const sections = document.querySelectorAll('section:not(.print-hidden)');
    sections.forEach((section, index) => {
        if (index > 0 && index % 2 === 0) {
            section.classList.add('page-break-before');
        }
        
        // Add section numbers
        const heading = section.querySelector('h2');
        if (heading && !heading.textContent.includes('📅') && !heading.textContent.includes('📄')) {
            const sectionNumber = Math.floor(index / 2) + 1;
            heading.innerHTML = `${sectionNumber}. ${heading.innerHTML}`;
        }
    });
    
    // Optimize chart containers
    const chartContainers = document.querySelectorAll('.chart-container, .chart-image-container');
    chartContainers.forEach(container => {
        container.style.border = '1px solid #1e40af';
        container.style.padding = '10px';
        container.style.margin = '10px 0';
        container.style.backgroundColor = 'white';
    });
}

// Restore original document state
function restoreOriginalDocument(originalTitle, originalContent) {
    document.title = originalTitle;
    
    // Remove print-only elements
    const printElements = document.querySelectorAll('.print-only');
    printElements.forEach(el => el.remove());
    
    // Restore hidden elements
    const hiddenElements = document.querySelectorAll('.print-hidden');
    hiddenElements.forEach(el => {
        el.style.display = '';
        el.classList.remove('print-hidden');
    });
    
    // Remove page break classes
    const pageBreakElements = document.querySelectorAll('.page-break-before');
    pageBreakElements.forEach(el => el.classList.remove('page-break-before'));
    
    // Restore section headings
    const headings = document.querySelectorAll('h2');
    headings.forEach(heading => {
        if (/^\d+\.\s/.test(heading.textContent)) {
            heading.innerHTML = heading.innerHTML.replace(/^\d+\.\s/, '');
        }
    });
}

    // Fix: Add event listeners for modal functionality
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeCalculatorModal();
            hideCalculatorHelp();
        }
    });

    // Close modal on backdrop click
    const modal = document.getElementById('calculatorModal');
    if (modal) {
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                closeCalculatorModal();
            }
        });
    }

    // Smooth scroll for navbar ROI Calculator link
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

// Enhanced print event handlers
window.addEventListener('beforeprint', () => {
    console.log('📄 Generating professional PDF document...');
    
    // Add print-specific CSS class to body
    document.body.classList.add('printing');
    
    // Ensure proper styling
    const style = document.createElement('style');
    style.textContent = `
        .printing .notification { display: none !important; }
        .printing .professional-button { display: none !important; }
        .printing input, .printing textarea, .printing select { display: none !important; }
    `;
    document.head.appendChild(style);
    style.id = 'print-style';
});

window.addEventListener('afterprint', () => {
    console.log('📄 PDF document generation completed');
    
    // Remove print-specific styling
    document.body.classList.remove('printing');
    const printStyle = document.getElementById('print-style');
    if (printStyle) printStyle.remove();
    
    showNotification('📄 Professional PDF generated successfully! Check your downloads folder.', 'success');
});

// Prevent notification interference during PDF generation
const originalShowNotification = window.showNotification;
window.showNotification = function(message, type) {
    if (!document.body.classList.contains('printing')) {
        originalShowNotification(message, type);
    }
};
</script>

</body>
</html>